{"config":{"lang":["zh","en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u8fd0\u7ef4\u77e5\u8bc6\u5e93","text":"<p>\u6b22\u8fce\u6765\u5230\u8fd0\u7ef4\u77e5\u8bc6\u5e93\uff01\u8fd9\u662f\u4e00\u4e2a\u4e13\u4e1a\u7684\u8fd0\u7ef4\u64cd\u4f5c\u624b\u518c\u548c\u6545\u969c\u89e3\u51b3\u65b9\u6848\u96c6\u5408\uff0c\u65e8\u5728\u5e2e\u52a9\u8fd0\u7ef4\u5de5\u7a0b\u5e08\u5feb\u901f\u89e3\u51b3\u65e5\u5e38\u5de5\u4f5c\u4e2d\u9047\u5230\u7684\u5404\u79cd\u95ee\u9898\u3002</p>"},{"location":"#_2","title":"\u2728 \u7279\u6027","text":"<ul> <li>\ud83d\udcda \u7cfb\u7edf\u6027\u77e5\u8bc6\u4f53\u7cfb\uff1a\u8986\u76d6\u8fd0\u7ef4\u5de5\u4f5c\u7684\u5404\u4e2a\u65b9\u9762</li> <li>\ud83d\udd0d \u5feb\u901f\u68c0\u7d22\uff1a\u652f\u6301\u5168\u6587\u641c\u7d22\uff0c\u5feb\u901f\u5b9a\u4f4d\u89e3\u51b3\u65b9\u6848</li> <li>\ud83c\udf19 \u6df1\u8272\u6a21\u5f0f\uff1a\u652f\u6301\u6d45\u8272/\u6df1\u8272\u4e3b\u9898\u5207\u6362</li> <li>\ud83d\udcf1 \u54cd\u5e94\u5f0f\u8bbe\u8ba1\uff1a\u5b8c\u7f8e\u9002\u914d\u624b\u673a\u3001\u5e73\u677f\u3001\u684c\u9762\u8bbe\u5907</li> <li>\ud83d\ude80 \u6301\u7eed\u66f4\u65b0\uff1a\u57fa\u4e8e\u5b9e\u9645\u5de5\u4f5c\u7ecf\u9a8c\u4e0d\u65ad\u5b8c\u5584</li> </ul>"},{"location":"#_3","title":"\ud83d\udcd6 \u5185\u5bb9\u7ed3\u6784","text":""},{"location":"#_4","title":"\ud83c\udfd7\ufe0f \u57fa\u7840\u73af\u5883","text":"<ul> <li>\u7cfb\u7edf\u5b89\u88c5\u914d\u7f6e</li> <li>\u7f51\u7edc\u73af\u5883\u914d\u7f6e</li> <li>\u57fa\u7840\u8f6f\u4ef6\u5b89\u88c5</li> </ul>"},{"location":"#_5","title":"\ud83d\udc33 \u5bb9\u5668\u5316","text":"<ul> <li>Docker \u90e8\u7f72\u6307\u5357</li> <li>Docker Compose \u914d\u7f6e</li> <li>\u5bb9\u5668\u7f16\u6392\u5b9e\u8df5</li> </ul>"},{"location":"#_6","title":"\u2699\ufe0f \u5e94\u7528\u670d\u52a1","text":"<ul> <li>Web \u670d\u52a1\u914d\u7f6e</li> <li>\u5e94\u7528\u90e8\u7f72\u6d41\u7a0b</li> <li>\u670d\u52a1\u7ba1\u7406\u5b9e\u8df5</li> </ul>"},{"location":"#_7","title":"\ud83d\udcbe \u6570\u636e\u5b58\u50a8","text":"<ul> <li>\u6570\u636e\u5e93\u7ba1\u7406</li> <li>\u5907\u4efd\u6062\u590d\u7b56\u7565</li> <li>\u5b58\u50a8\u65b9\u6848\u9009\u62e9</li> </ul>"},{"location":"#_8","title":"\ud83d\udcca \u76d1\u63a7\u544a\u8b66","text":"<ul> <li>\u76d1\u63a7\u7cfb\u7edf\u642d\u5efa</li> <li>\u544a\u8b66\u7b56\u7565\u914d\u7f6e</li> <li>\u6027\u80fd\u5206\u6790\u65b9\u6cd5</li> </ul>"},{"location":"#_9","title":"\ud83d\udd12 \u5b89\u5168\u9632\u62a4","text":"<ul> <li>\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa</li> <li>\u7f51\u7edc\u5b89\u5168\u914d\u7f6e</li> <li>\u5b89\u5168\u4e8b\u4ef6\u5904\u7406</li> </ul>"},{"location":"#_10","title":"\ud83d\udea8 \u6545\u969c\u5904\u7406","text":"<ul> <li>\u5e38\u89c1\u95ee\u9898\u89e3\u51b3</li> <li>\u5e94\u6025\u5904\u7406\u6d41\u7a0b</li> <li>\u6545\u969c\u6392\u67e5\u65b9\u6cd5</li> </ul>"},{"location":"#_11","title":"\u2b50 \u6700\u4f73\u5b9e\u8df5","text":"<ul> <li>\u6027\u80fd\u4f18\u5316\u6307\u5357</li> <li>\u8fd0\u7ef4\u89c4\u8303\u5236\u5b9a</li> <li>\u56e2\u961f\u534f\u4f5c\u65b9\u6cd5</li> </ul>"},{"location":"#_12","title":"\ud83d\ude80 \u5feb\u901f\u5f00\u59cb","text":""},{"location":"#_13","title":"\u672c\u5730\u9884\u89c8","text":"Bash<pre><code># 1. \u514b\u9686\u4ed3\u5e93\ngit clone https://github.com/freemankevin/ops-knowledge-base.git\ncd ops-knowledge-base\n\n# 2. \u5b89\u88c5\u4f9d\u8d56\nbash scripts/deploy.sh --install\n\n# 3. \u542f\u52a8\u672c\u5730\u670d\u52a1\nbash scripts/deploy.sh --serve\n</code></pre> <p>\u8bbf\u95ee http://127.0.0.1:8000 \u9884\u89c8\u6548\u679c\u3002</p>"},{"location":"#_14","title":"\u90e8\u7f72\u811a\u672c\u4f7f\u7528","text":"Bash<pre><code># \u5b89\u88c5\u4f9d\u8d56\nbash scripts/deploy.sh --install\n\n# \u542f\u52a8\u5f00\u53d1\u670d\u52a1\u5668\nbash scripts/deploy.sh --serve\n\n# \u6784\u5efa\u9759\u6001\u7ad9\u70b9\nbash scripts/deploy.sh --build\n\n# \u90e8\u7f72\u5230 GitHub Pages\nbash scripts/deploy.sh --deploy\n\n# \u6e05\u7406\u6784\u5efa\u6587\u4ef6\nbash scripts/deploy.sh --clean\n\n# \u67e5\u770b\u5e2e\u52a9\nbash scripts/deploy.sh --help\n</code></pre>"},{"location":"changelog/","title":"\u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"quick-start/","title":"\u5feb\u901f\u5f00\u59cb","text":""},{"location":"tags/","title":"\u6807\u7b7e","text":""},{"location":"tags/#_2","title":"\u5e38\u7528\u6807\u7b7e","text":"<ul> <li>\u7cfb\u7edf\u5b89\u88c5</li> <li>Linux</li> <li>CentOS</li> <li>Ubuntu</li> <li>Debian</li> <li>\u8fd0\u7ef4</li> <li>\u77e5\u8bc6\u5e93</li> </ul>"},{"location":"tags/#_3","title":"\u6807\u7b7e\u4f7f\u7528\u8bf4\u660e","text":"<ol> <li>\u5728\u6587\u6863\u9876\u90e8\u6dfb\u52a0tags\u5143\u6570\u636e\u6765\u6807\u8bb0\u6587\u6863</li> <li>\u683c\u5f0f\u793a\u4f8b\uff1a YAML<pre><code>---\ntags:\n  - Linux\n  - \u7cfb\u7edf\u5b89\u88c5\n---\n</code></pre></li> <li>\u6807\u7b7e\u4f1a\u81ea\u52a8\u5728\u7f51\u7ad9\u4e0a\u751f\u6210\u5206\u7c7b\u9875\u9762</li> </ol>"},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/","title":"01-\u57fa\u7840\u73af\u5883","text":""},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/","title":"\u4f7f\u7528 Rufus \u521b\u5efa Linux \u542f\u52a8 U \u76d8","text":"<p>Rufus \u662f\u4e00\u4e2a\u514d\u8d39\u3001\u5f00\u6e90\u7684\u5de5\u5177\uff0c\u7528\u4e8e\u521b\u5efa\u542f\u52a8 U \u76d8\uff0c\u975e\u5e38\u9002\u5408\u5b89\u88c5\u64cd\u4f5c\u7cfb\u7edf\u3002</p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/#_1","title":"\u51c6\u5907\u5de5\u4f5c","text":"Warning <ul> <li>\u5728\u4f7f\u7528 U \u76d8\u4e4b\u524d\uff0c\u786e\u4fdd\u5907\u4efd U \u76d8\u4e0a\u7684\u6240\u6709\u91cd\u8981\u6570\u636e\u3002</li> </ul> <p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u51c6\u5907\u597d\u4ee5\u4e0b\u51e0\u6837\u4e1c\u897f\uff1a</p> <ul> <li>\u4e00\u4e2a 4 GB \u6216\u66f4\u5927\u5bb9\u91cf\u7684 U \u76d8\uff1a\u8bf7\u6ce8\u610f\uff0c\u6240\u6709\u73b0\u6709\u6570\u636e\u90fd\u5c06\u88ab\u6e05\u9664\u3002</li> <li>Linux ISO \u6587\u4ef6\uff1a\u4ece Linux \u53d1\u884c\u7248\u7684\u5b98\u7f51\u4e0b\u8f7d\u4f60\u9700\u8981\u5b89\u88c5\u7684 ISO \u6587\u4ef6\u3002</li> <li>\u4e0b\u8f7d Rufus\uff1a\u8bbf\u95ee Rufus \u5b98\u7f51 \u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684 Rufus\u3002</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/#rufus","title":"\u5b89\u88c5 Rufus","text":"<ol> <li>\u63d2\u5165 U \u76d8\u3002</li> <li>\u8fd0\u884c\u4f60\u4e0b\u8f7d\u7684 Rufus.exe \u6587\u4ef6\u3002</li> <li>\u5982\u679c\u7cfb\u7edf\u8bf7\u6c42\u6743\u9650\uff0c\u8bf7\u786e\u8ba4\u3002</li> </ol>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/#rufus_1","title":"\u914d\u7f6e Rufus","text":"<p>\u5728 Rufus \u7684\u754c\u9762\u4e2d\uff0c\u8fdb\u884c\u4ee5\u4e0b\u914d\u7f6e\uff1a</p> <ol> <li>\u8bbe\u5907\uff1a\u786e\u4fdd\u4f60\u7684 U \u76d8\u5728\u300c\u8bbe\u5907\u300d\u4e0b\u88ab\u6b63\u786e\u9009\u62e9\u3002</li> <li>\u542f\u52a8\u9009\u62e9\uff1a\u70b9\u51fb\u300c\u9009\u62e9\u300d\u6309\u94ae\uff0c\u6d4f\u89c8\u5e76\u9009\u62e9\u4f60\u7684 Linux ISO \u6587\u4ef6\u3002</li> <li>\u5206\u533a\u65b9\u6848\uff1a\u9009\u62e9\u9002\u5408\u4f60\u7cfb\u7edf\u7684\u5206\u533a\u65b9\u6848\u3002</li> <li>MBR\uff1a\u7528\u4e8e\u65e7\u7cfb\u7edf\u6216\u4f20\u7edf BIOS\u3002</li> <li>GPT\uff1a\u7528\u4e8e\u8f83\u65b0\u7cfb\u7edf\u6216 UEFI \u6a21\u5f0f\u3002</li> <li>\u76ee\u6807\u7cfb\u7edf\uff1a\u6839\u636e\u4f60\u9009\u62e9\u7684\u5206\u533a\u65b9\u6848\uff0c\u8fd9\u91cc\u4f1a\u81ea\u52a8\u586b\u5145\u300cBIOS\uff08\u6216 UEFI-CSM\uff09\u300d\u6216\u300cUEFI\uff08\u975e CSM\uff09\u300d\u3002</li> <li>\u6587\u4ef6\u7cfb\u7edf\uff1a\u4e00\u822c\u9009\u62e9\u300cFAT32\u300d\uff08\u5c24\u5176\u662f\u5bf9\u4e8e UEFI \u542f\u52a8\uff09\uff0c\u8fd9\u662f\u5927\u591a\u6570 Linux \u542f\u52a8 U \u76d8\u63a8\u8350\u7684\u683c\u5f0f\u3002</li> </ol> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/#_2","title":"\u542f\u52a8\u521b\u5efa\u8fc7\u7a0b","text":"Warning <ul> <li>\u786e\u4fdd\u5728\u521b\u5efa\u8fc7\u7a0b\u4e2d\u4e0d\u8981\u79fb\u9664 U \u76d8\u3002</li> <li>\u5982\u679c\u4f60\u7684\u7535\u8111\u5728\u542f\u52a8\u65f6\u6ca1\u6709\u63d0\u793a\u8fdb\u5165 BIOS/UEFI\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u67e5\u627e\u7279\u5b9a\u4e8e\u4f60\u7535\u8111\u578b\u53f7\u7684\u5feb\u6377\u952e\u3002</li> </ul> <ol> <li>\u786e\u8ba4\u6240\u6709\u8bbe\u7f6e\u6b63\u786e\u65e0\u8bef\u540e\uff0c\u70b9\u51fb\u300c\u5f00\u59cb\u300d\u6309\u94ae\u3002</li> <li>Rufus \u5c06\u63d0\u793a\u4f60\u6240\u6709\u6570\u636e\u5c06\u88ab\u6e05\u9664\u3002\u70b9\u51fb\u300c\u786e\u5b9a\u300d\u7ee7\u7eed\u3002</li> <li>\u7b49\u5f85 Rufus \u5b8c\u6210\u542f\u52a8 U \u76d8\u7684\u521b\u5efa\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\u65f6\u95f4\u3002</li> </ol>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8U%E7%9B%98/#u-linux","title":"\u4f7f\u7528\u542f\u52a8 U \u76d8\u5b89\u88c5 Linux","text":"<ol> <li>\u5b8c\u6210 U \u76d8\u521b\u5efa\u540e\uff0c\u5b89\u5168\u79fb\u9664 U \u76d8\u3002</li> <li>\u5c06 U \u76d8\u63d2\u5165\u4f60\u60f3\u8981\u5b89\u88c5 Linux \u7684\u7535\u8111\u6216\u8005\u786c\u4ef6\u670d\u52a1\u5668\u3002</li> <li>\u91cd\u542f\u7535\u8111\u6216\u8005\u670d\u52a1\u5668\uff0c\u5e76\u8fdb\u5165 BIOS/UEFI \u8bbe\u7f6e\u3002</li> <li>\u5728 BIOS/UEFI \u4e2d\u8bbe\u7f6e\u4ece U \u76d8\u542f\u52a8\u3002</li> <li>\u4fdd\u5b58\u8bbe\u7f6e\u5e76\u9000\u51fa BIOS/UEFI\u3002</li> <li>\u7535\u8111\u5c06\u4ece U \u76d8\u542f\u52a8\uff0c\u5e76\u5f00\u59cb Linux \u5b89\u88c5\u8fc7\u7a0b\u3002\u6309\u7167\u5c4f\u5e55\u4e0a\u7684\u6307\u793a\u5b8c\u6210 Linux \u7684\u5b89\u88c5\u3002</li> <li>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u79fb\u9664 U \u76d8\u5e76\u91cd\u542f\u7535\u8111\u3002</li> </ol>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/","title":"\u7cfb\u7edf\u521d\u59cb\u5316","text":"<p>\u672c\u6587\u6863\u63d0\u4f9b CentOS\u3001Ubuntu \u548c Debian \u4e09\u4e2a\u4e3b\u6d41 Linux \u53d1\u884c\u7248\u7684\u8be6\u7ec6\u521d\u59cb\u5316\u6307\u5357\u3002</p> <p>Tip</p> <p>\u5efa\u8bae\u5728\u865a\u62df\u673a\u4e2d\u5148\u884c\u6d4b\u8bd5\uff0c\u786e\u8ba4\u65e0\u8bef\u540e\u518d\u5728\u751f\u4ea7\u73af\u5883\u6267\u884c\u3002</p>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#ntp","title":"\u914d\u7f6e NTP","text":"Warning <p>\u5982\u679c\u662f\u5185\u7f51\u73af\u5883\uff0c\u5efa\u8bae\u914d\u7f6e\u5185\u7f51 NTP \u670d\u52a1\u5668\uff0c\u907f\u514d\u4f9d\u8d56\u5916\u7f51\u8fde\u63a5\u3002</p> <p>\u65f6\u95f4\u540c\u6b65\u5bf9\u4e8e\u5206\u5e03\u5f0f\u7cfb\u7edf\u548c\u65e5\u5fd7\u7ba1\u7406\u81f3\u5173\u91cd\u8981\uff0c\u63a8\u8350\u4f7f\u7528 chrony \u670d\u52a1\u3002</p> CentOS/RHELUbuntu/Debian Bash<pre><code># \u5b89\u88c5\u5e76\u542f\u52a8 chrony \u670d\u52a1\nsudo yum install -y chrony\nsudo systemctl enable chronyd --now\nsudo systemctl restart crond\n\n# \u914d\u7f6e NTP \u670d\u52a1\u5668\nsudo tee -a /etc/chrony.conf &lt;&lt; EOF\nserver ntp.aliyun.com iburst\nserver ntp1.aliyun.com iburst\nserver ntp2.aliyun.com iburst\nEOF\n\n# \u91cd\u542f\u670d\u52a1\u5e76\u9a8c\u8bc1\u72b6\u6001\nsudo systemctl restart chronyd\nchronyc tracking\nchronyc sources -v\n</code></pre> Bash<pre><code># \u5b89\u88c5\u5e76\u542f\u52a8 chrony \u670d\u52a1\nsudo apt update &amp;&amp; sudo apt install -y chrony\nsudo systemctl enable chronyd --now\n\n# \u914d\u7f6e NTP \u670d\u52a1\u5668\nsudo tee -a /etc/chrony/chrony.conf &lt;&lt; EOF\nserver ntp.aliyun.com iburst\nserver ntp1.aliyun.com iburst\nserver ntp2.aliyun.com iburst\nEOF\n\n# \u91cd\u542f\u670d\u52a1\u5e76\u9a8c\u8bc1\u72b6\u6001\nsudo systemctl restart chrony\nchronyc tracking\nchronyc sources -v\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#ip","title":"\u914d\u7f6e\u9759\u6001 IP","text":"CentOS/RHELUbuntu/Debian Bash<pre><code># \u67e5\u770b\u7f51\u7edc\u63a5\u53e3\u540d\u79f0\nip addr show\n\n# \u7f16\u8f91\u7f51\u7edc\u914d\u7f6e\u6587\u4ef6\uff08\u4ee5 ens32 \u4e3a\u4f8b\uff09\nsudo vim /etc/sysconfig/network-scripts/ifcfg-ens32\n\n# \u914d\u7f6e\u793a\u4f8b\uff1a\nTYPE=\"Ethernet\"\nBOOTPROTO=\"static\"\nDEFROUTE=\"yes\"\nIPV4_FAILURE_FATAL=\"no\"\nIPV6INIT=\"no\"\nNAME=\"ens32\"\nDEVICE=\"ens32\"\nONBOOT=\"yes\"\nIPADDR=\"192.168.1.100\"\nNETMASK=\"255.255.255.0\"\nGATEWAY=\"192.168.1.1\"\nDNS1=\"114.114.114.114\"\nDNS2=\"8.8.8.8\"\n\n# \u91cd\u542f\u7f51\u7edc\u670d\u52a1\nsudo systemctl restart NetworkManager\n# \u6216\u8005\nsudo systemctl restart network\n</code></pre> Bash<pre><code># Ubuntu 18.04+ \u4f7f\u7528 Netplan \u914d\u7f6e\u7f51\u7edc \n\n# \u67e5\u770b\u73b0\u6709\u914d\u7f6e\u6587\u4ef6\nls /etc/netplan/\n\n# \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\nsudo vim /etc/netplan/01-netcfg.yaml \n\n\n# \u914d\u7f6e\u793a\u4f8b\uff1a\nnetwork:\nversion: 2\nrenderer: networkd\nethernets:\n    enp0s3:\n    dhcp4: no\n    addresses:\n        - 192.168.1.100/24\n    gateway4: 192.168.1.1\n    nameservers:\n        addresses:\n        - 114.114.114.114\n        - 8.8.8.8\n\n\n# \u5e94\u7528\u914d\u7f6e\nsudo netplan apply\n\n# \u9a8c\u8bc1\u914d\u7f6e\nip addr show\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#_2","title":"\u5185\u6838\u5347\u7ea7","text":"Bash<pre><code># \u68c0\u67e5\u5f53\u524d\u5185\u6838\u7248\u672c\nuname -r\n\n# \u68c0\u67e5\u53ef\u7528\u5185\u6838\u7248\u672c\nrpm -qa | grep kernel  # CentOS/RHEL\ndpkg -l | grep linux-image  # Ubuntu/Debian\n</code></pre> <p>Danger</p> <p>\u5185\u6838\u5347\u7ea7\u6709\u4e00\u5b9a\u98ce\u9669\uff0c\u5efa\u8bae\uff1a</p> <ol> <li>\u5347\u7ea7\u524d\u521b\u5efa\u7cfb\u7edf\u5feb\u7167\u6216\u5907\u4efd</li> <li>\u4fdd\u7559\u539f\u6709\u5185\u6838\uff0c\u4ee5\u4fbf\u51fa\u73b0\u95ee\u9898\u65f6\u56de\u9000</li> <li>\u5728\u6d4b\u8bd5\u73af\u5883\u9a8c\u8bc1\u65e0\u8bef\u540e\u518d\u5728\u751f\u4ea7\u73af\u5883\u6267\u884c</li> </ol> CentOS/RHELUbuntu/Debian Bash<pre><code># \u5b89\u88c5 ELRepo \u4ed3\u5e93\uff08\u7528\u4e8e\u83b7\u53d6\u6700\u65b0\u5185\u6838\uff09\nsudo rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nsudo dnf install -y https://www.elrepo.org/elrepo-release-8.el8.elrepo.noarch.rpm\n\n# \u5b89\u88c5\u6700\u65b0\u7a33\u5b9a\u5185\u6838\nsudo dnf --enablerepo=elrepo-kernel install -y kernel-ml\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u542f\u52a8\u5185\u6838\nsudo grub2-set-default 0\nsudo grub2-mkconfig -o /boot/grub2/grub.cfg\n</code></pre> Bash<pre><code># \u66f4\u65b0\u5305\u5217\u8868\nsudo apt update\n\n# \u5b89\u88c5\u6700\u65b0\u5185\u6838\nsudo apt install -y linux-generic linux-headers-generic\n\n# \u66f4\u65b0 GRUB \u914d\u7f6e\nsudo update-grub\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#_3","title":"\u5b89\u5168\u914d\u7f6e","text":"","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#1","title":"1. \u5173\u95ed\u670d\u52a1","text":"Warning <ul> <li>\u5173\u95ed\u9632\u706b\u5899\uff1a\u5c06\u76f4\u63a5\u66b4\u9732\u6240\u6709\u670d\u52a1\u7aef\u53e3\u5230\u7f51\u7edc\u4e2d\uff0c\u6781\u5927\u589e\u52a0\u88ab\u653b\u51fb\u98ce\u9669</li> <li>\u5173\u95ed SELinux/AppArmor\uff1a\u79fb\u9664\u91cd\u8981\u7684\u5b89\u5168\u9632\u62a4\u5c42\uff0c\u964d\u4f4e\u7cfb\u7edf\u6297\u653b\u51fb\u80fd\u529b</li> <li>\u5173\u95ed\u7cfb\u7edf\u670d\u52a1\uff1a\u53ef\u80fd\u5f71\u54cd\u7cfb\u7edf\u529f\u80fd\uff0c\u8bf7\u786e\u8ba4\u8fd9\u4e9b\u670d\u52a1\u786e\u5b9e\u4e0d\u9700\u8981</li> </ul> Tip <ul> <li>\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u63a8\u8350\u5b8c\u5168\u5f00\u542f\u9632\u706b\u5899\uff0c\u914d\u7f6e\u597d\u7aef\u53e3\u767d\u540d\u5355</li> <li>SELinux/AppArmor \u5e94\u914d\u7f6e\u4e3a\u8bb8\u53ef\u6a21\u5f0f\u800c\u975e\u5b8c\u5168\u7981\u7528</li> <li>\u4ec5\u5728\u6d4b\u8bd5\u73af\u5883\u6216\u6709\u660e\u786e\u9700\u6c42\u65f6\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c</li> </ul> CentOS/RHELUbuntu/Debian Bash<pre><code># \u5173\u95ed\u9632\u706b\u5899\uff08\u6839\u636e\u5b89\u5168\u7b56\u7565\u51b3\u5b9a\uff09\nsudo systemctl stop firewalld  \nsudo systemctl disable firewalld\n\n# \u5173\u95ed SELinux\nsudo setenforce 0\nsudo sed -i 's/^SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n\n# \u5173\u95ed\u4e0d\u5fc5\u8981\u7684\u670d\u52a1\nsudo systemctl stop postfix rpcbind\nsudo systemctl disable postfix rpcbind\n</code></pre> Bash<pre><code># \u5173\u95ed\u9632\u706b\u5899\uff08\u6839\u636e\u5b89\u5168\u7b56\u7565\u51b3\u5b9a\uff09\nsudo systemctl stop ufw  \nsudo systemctl disable ufw\n\n# \u5173\u95ed AppArmor\nsudo systemctl stop apparmor\nsudo systemctl disable apparmor\n\n# \u5173\u95ed\u4e0d\u5fc5\u8981\u7684\u670d\u52a1\nsudo systemctl stop postfix rpcbind\nsudo systemctl disable postfix rpcbind\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#2-ssh","title":"2. SSH \u5b89\u5168","text":"Warning <ul> <li>\u4fee\u6539 SSH \u7aef\u53e3\uff1a\u5982\u679c\u5fd8\u8bb0\u65b0\u7aef\u53e3\u53f7\uff0c\u53ef\u80fd\u5bfc\u81f4\u65e0\u6cd5\u8fdc\u7a0b\u8fde\u63a5</li> <li>\u7981\u6b62 root \u767b\u5f55\uff1a\u786e\u4fdd\u5df2\u521b\u5efa\u5176\u4ed6\u7ba1\u7406\u5458\u7528\u6237\uff0c\u5426\u5219\u53ef\u80fd\u5931\u53bb\u7cfb\u7edf\u8bbf\u95ee\u6743\u9650</li> <li>\u7981\u7528\u5bc6\u7801\u8ba4\u8bc1\uff1a\u5fc5\u987b\u5148\u914d\u7f6e\u597d\u5bc6\u94a5\u8ba4\u8bc1\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u767b\u5f55</li> <li>\u914d\u7f6e\u9519\u8bef\uff1a\u53ef\u80fd\u5bfc\u81f4\u5b8c\u5168\u5931\u53bb SSH \u8bbf\u95ee\u6743\u9650\uff0c\u9700\u8981\u7269\u7406\u8bbf\u95ee\u670d\u52a1\u5668\u6062\u590d</li> </ul> Tip <ul> <li>\u4fdd\u6301\u73b0\u6709 SSH \u8fde\u63a5\u4f1a\u8bdd\uff0c\u5728\u65b0\u4f1a\u8bdd\u4e2d\u6d4b\u8bd5\u914d\u7f6e</li> <li>\u786e\u4fdd\u6709\u670d\u52a1\u5668\u7684\u7269\u7406\u8bbf\u95ee\u6743\u9650\u6216\u63a7\u5236\u53f0\u8bbf\u95ee</li> <li>\u5148\u521b\u5efa\u914d\u7f6e\u5907\u4efd</li> <li>\u9010\u9879\u6d4b\u8bd5\u914d\u7f6e\uff0c\u786e\u8ba4\u65e0\u8bef\u540e\u518d\u5e94\u7528\u4e0b\u4e00\u9879</li> </ul> Bash<pre><code># \u5907\u4efd\u539f\u914d\u7f6e\nsudo cp /etc/ssh/sshd_config{,.bak}\n\n# \u7f16\u8f91 SSH \u914d\u7f6e\nsudo vim /etc/ssh/sshd_config\n\n\n# \u63a8\u8350\u7684 SSH \u5b89\u5168\u914d\u7f6e\uff1a\n\n# \u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\uff08\u53ef\u9009\uff09\nPort 2222\n# \u7981\u6b62 root \u76f4\u63a5\u767b\u5f55\uff08\u63a8\u8350\uff09\nPermitRootLogin no\n# \u7981\u7528\u5bc6\u7801\u8ba4\u8bc1\uff0c\u4ec5\u4f7f\u7528\u5bc6\u94a5\u8ba4\u8bc1\uff08\u9ad8\u5b89\u5168\u8981\u6c42\uff09\nPasswordAuthentication yes\nPubkeyAuthentication yes\n# \u8bbe\u7f6e\u767b\u5f55\u8d85\u65f6\nClientAliveInterval 600\nClientAliveCountMax 0\n# \u9650\u5236\u767b\u5f55\u7528\u6237\nAllowUsers guodi\n# \u7981\u7528\u7a7a\u5bc6\u7801\nPermitEmptyPasswords no\n\n# \u91cd\u542f SSH \u670d\u52a1\nsudo systemctl restart sshd\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#_4","title":"\u6027\u80fd\u4f18\u5316","text":"","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#1_1","title":"1. \u5185\u6838\u53c2\u6570","text":"Bash<pre><code># \u5907\u4efd\u539f\u914d\u7f6e\nsudo cp /etc/sysctl.conf{,.bak}\n\n# \u521b\u5efa\u4f18\u5316\u914d\u7f6e\nsudo tee /etc/sysctl.conf &lt;&lt; EOF\n# \u6587\u4ef6\u7cfb\u7edf\u4f18\u5316\nfs.file-max = 1048576\nfs.aio-max-nr = 1048576\n\n# \u5185\u5b58\u7ba1\u7406\nvm.drop_caches = 3\nvm.max_map_count = 262144\nvm.swappiness = 10\n\n# \u5171\u4eab\u5185\u5b58\nkernel.shmall = 4294967296\nkernel.shmmax = 4294967295\nkernel.shmmni = 4096\n\n# \u7cfb\u7edf\u5b89\u5168\nkernel.sysrq = 0\nkernel.dmesg_restrict = 1\n\n# \u4fe1\u53f7\u91cf\nkernel.sem = 250 32000 100 128\n\n# \u7f51\u7edc\u4f18\u5316\nnet.ipv4.ip_forward = 1\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\n# TCP \u4f18\u5316\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_fin_timeout = 30\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_keepalive_time = 1200\nnet.ipv4.ip_local_port_range = 1024 65535\n\n# \u7f51\u7edc\u7f13\u51b2\u533a\nnet.core.rmem_default = 16777216\nnet.core.rmem_max = 16777216\nnet.core.wmem_default = 16777216\nnet.core.wmem_max = 16777216\nnet.core.netdev_max_backlog = 5000\nEOF\n\n# \u5e94\u7528\u914d\u7f6e\nsudo sysctl -p\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#2","title":"2. \u6587\u4ef6\u63cf\u8ff0\u7b26","text":"Bash<pre><code># \u8bbe\u7f6e\u7cfb\u7edf\u7ea7\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\nsudo tee -a /etc/security/limits.conf &lt;&lt; EOF\n* soft nofile 1048576\n* hard nofile 1048576\n* soft nproc 1048576\n* hard nproc 1048576\nEOF\n\n# \u8bbe\u7f6e systemd \u670d\u52a1\u9650\u5236\nsudo tee /etc/systemd/system.conf.d/limits.conf &lt;&lt; EOF\n[Manager]\nDefaultLimitNOFILE=1048576\nDefaultLimitNPROC=1048576\nEOF\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#3","title":"3. \u4e2d\u65ad\u8d1f\u8f7d\u5747\u8861","text":"CentOS/RHELUbuntu/Debian Bash<pre><code># \u5b89\u88c5\u5e76\u542f\u52a8 irqbalance\nsudo yum install -y irqbalance \n\nsudo systemctl enable irqbalance --now\n</code></pre> Bash<pre><code># \u5b89\u88c5\u5e76\u542f\u52a8 irqbalance\nsudo apt install -y irqbalance \n\nsudo systemctl enable irqbalance --now \n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#_5","title":"\u78c1\u76d8\u7ba1\u7406","text":"","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#1_2","title":"1. \u67e5\u770b\u78c1\u76d8","text":"Bash<pre><code># \u67e5\u770b\u78c1\u76d8\u5206\u533a\nlsblk\n\n# \u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\ndf -h\n\n# \u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\ndf -Th\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#2_1","title":"2. \u65b9\u6848\u9009\u62e9","text":"\u78c1\u76d8\u5927\u5c0f \u6570\u636e\u7c7b\u578b \u5206\u533a\u65b9\u6848 \u4f18\u52bf &lt; 2TB \u4efb\u610f LVM \u5206\u533a \u7075\u6d3b\u6269\u5bb9 \u2265 2TB \u4efb\u610f GPT \u5206\u533a \u652f\u6301\u5927\u5bb9\u91cf","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#3-lvm","title":"3. LVM \u5206\u533a\u7ba1\u7406","text":"","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#31-lvm","title":"3.1 \u521b\u5efa LVM \u5206\u533a","text":"Bash<pre><code># \u521b\u5efa\u7269\u7406\u5377\nsudo pvcreate /dev/sdb\n\n# \u521b\u5efa\u5377\u7ec4\nsudo vgcreate data_vg /dev/sdb\n\n# \u521b\u5efa\u903b\u8f91\u5377\uff08\u4f7f\u7528\u5168\u90e8\u7a7a\u95f4\uff09\nsudo lvcreate -l 100%FREE -n data_lv data_vg\n\n# \u683c\u5f0f\u5316\u4e3a ext4\nsudo mkfs.ext4 /dev/data_vg/data_lv\n\n# \u521b\u5efa\u6302\u8f7d\u70b9\u5e76\u6302\u8f7d\nsudo mkdir -p /data\nsudo mount /dev/data_vg/data_lv /data\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\necho '/dev/data_vg/data_lv /data ext4 defaults 0 2' | sudo tee -a /etc/fstab\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#32-lvm","title":"3.2 LVM \u6269\u5bb9","text":"Bash<pre><code># \u6dfb\u52a0\u65b0\u78c1\u76d8\u5230\u5377\u7ec4\nsudo pvcreate /dev/sdc\nsudo vgextend data_vg /dev/sdc\n\n# \u6269\u5c55\u903b\u8f91\u5377\nsudo lvextend -l +100%FREE /dev/data_vg/data_lv\n\n# \u6269\u5c55\u6587\u4ef6\u7cfb\u7edf\nsudo resize2fs /dev/data_vg/data_lv\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#33-lvm","title":"3.3 \u5220\u9664 LVM","text":"Bash<pre><code># \u5220\u9664\u903b\u8f91\u5377\nsudo lvremove /dev/data_vg/data_lv\n\n# \u5220\u9664\u5377\u7ec4\nsudo vgremove data_vg\n\n# \u5220\u9664\u7269\u7406\u5377\nsudo pvremove /dev/sdb /dev/sdc\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#4-gpt","title":"4. GPT \u5206\u533a\u7ba1\u7406","text":"","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#41-gpt","title":"4.1 \u521b\u5efa GPT \u5206\u533a","text":"Bash<pre><code># \u67e5\u770b\u78c1\u76d8\nlsblk\n\n# \u8f6c\u6362\u4e3a GPT \u5206\u533a\u8868\nsudo parted /dev/sdb mklabel gpt\n\n# \u521b\u5efa\u5206\u533a\nsudo parted /dev/sdb mkpart primary ext4 0% 100%\n\n# \u683c\u5f0f\u5316\u5206\u533a\nsudo mkfs.ext4 /dev/sdb1\n\n# \u521b\u5efa\u6302\u8f7d\u70b9\u5e76\u6302\u8f7d\nsudo mkdir -p /data\nsudo mount /dev/sdb1 /data\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\necho '/dev/sdb1 /data ext4 defaults 0 2' | sudo tee -a /etc/fstab\n\n# \u67e5\u770b\u6302\u8f7d\u4fe1\u606f\ndf -h /data\n\n# \u67e5\u770b\u5757\u8bbe\u5907\u4fe1\u606f\nlsblk\n\n# \u67e5\u770b GPT \u5206\u533a\u4fe1\u606f\nsudo parted /dev/sdb print\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#vim","title":"\u914d\u7f6e Vim","text":"<p>\u521b\u5efa\u5168\u5c40 vim \u914d\u7f6e\uff1a</p> Bash<pre><code>sudo tee /etc/vim/vimrc.local &lt;&lt; 'EOF'\n\" ===== \u57fa\u672c\u8bbe\u7f6e =====\nsyntax on\nfiletype plugin indent on\n\n\" ===== \u663e\u793a\u8bbe\u7f6e =====\nset number\nset relativenumber     \" \u663e\u793a\u76f8\u5bf9\u884c\u53f7\uff0c\u4fbf\u4e8e\u8df3\u8f6c\nset ruler\nset cursorline\nset cursorcolumn       \" \u663e\u793a\u5149\u6807\u5217\uff0c\u4fbf\u4e8e\u5bf9\u9f50\nset laststatus=2\nset showcmd\nset showmode\ncolorscheme desert\n\n\" ===== \u7f29\u8fdb\u548c\u5236\u8868\u7b26 =====\nset tabstop=4\nset shiftwidth=4\nset expandtab\nset autoindent\nset smartindent\nset smarttab           \" \u667a\u80fd\u5236\u8868\u7b26\n\n\" ===== \u7f16\u8f91\u8bbe\u7f6e =====\nset backspace=indent,eol,start\nset whichwrap+=&lt;,&gt;,h,l\nset mouse=a\nset selection=exclusive\nset selectmode=mouse,key\n\n\" ===== \u641c\u7d22\u8bbe\u7f6e =====\nset hlsearch\nset incsearch\nset ignorecase\nset smartcase\n\" \u6309 Esc \u53d6\u6d88\u641c\u7d22\u9ad8\u4eae\nnnoremap &lt;Esc&gt; :nohlsearch&lt;CR&gt;\n\n\" ===== \u7f16\u7801\u8bbe\u7f6e =====\nset encoding=utf-8\nset fileencodings=utf-8,gb18030,gbk,gb2312,latin1\nset fileencoding=utf-8\nset fileformat=unix\nset formatoptions+=mM\n\n\" ===== \u5907\u4efd\u548c\u4e34\u65f6\u6587\u4ef6 =====\nset nobackup           \" \u7981\u7528\u5907\u4efd\u6587\u4ef6\nset noswapfile         \" \u7981\u7528\u4ea4\u6362\u6587\u4ef6\nset nowritebackup      \" \u7981\u7528\u5199\u5165\u5907\u4efd\n\n\" ===== \u663e\u793a\u548c\u6362\u884c =====\nset wrap\nset linebreak\nset showbreak=\u21aa\\ \nset textwidth=0        \" \u7981\u7528\u81ea\u52a8\u786c\u6362\u884c\nset wrapmargin=0       \" \u7981\u7528\u57fa\u4e8e\u8fb9\u8ddd\u7684\u6362\u884c\n\n\" ===== \u7c98\u8d34\u6a21\u5f0f =====\nset pastetoggle=&lt;F2&gt;\n\n\" ===== \u989d\u5916\u7684\u4fbf\u5229\u8bbe\u7f6e =====\nset wildmenu\nset wildmode=longest:full,full  \" \u66f4\u597d\u7684\u547d\u4ee4\u884c\u8865\u5168\nset scrolloff=5        \" \u589e\u52a0\u52305\u884c\nset sidescrolloff=8    \" \u589e\u52a0\u52308\u5217\nset history=1000       \" \u589e\u52a0\u5386\u53f2\u8bb0\u5f55\nset undolevels=1000    \" \u589e\u52a0\u64a4\u9500\u5c42\u6570\n\n\" ===== \u526a\u8d34\u677f\u8bbe\u7f6e =====\n\" \u68c0\u67e5\u662f\u5426\u652f\u6301\u7cfb\u7edf\u526a\u8d34\u677f\nif has('clipboard')\n    set clipboard=unnamedplus\nendif\n\n\" ===== \u589e\u5f3a\u7684\u5feb\u6377\u952e\u6620\u5c04 =====\n\" \u590d\u5236\u7c98\u8d34\u76f8\u5173\nvnoremap &lt;C-c&gt; \"+y\nvnoremap &lt;C-x&gt; \"+x\nnnoremap &lt;C-v&gt; \"+p\ninoremap &lt;C-v&gt; &lt;C-r&gt;+\nvnoremap &lt;C-v&gt; \"+p\n\n\" \u5168\u9009\nnnoremap &lt;C-a&gt; ggVG\n\" \u4fdd\u5b58\nnnoremap &lt;C-s&gt; :w&lt;CR&gt;\ninoremap &lt;C-s&gt; &lt;Esc&gt;:w&lt;CR&gt;a\n\n\" \u884c\u64cd\u4f5c\nnnoremap &lt;C-d&gt; yyp      \" \u590d\u5236\u5f53\u524d\u884c\nnnoremap &lt;C-k&gt; dd       \" \u5220\u9664\u5f53\u524d\u884c\n\n\" \u79fb\u52a8\u589e\u5f3a\nnnoremap j gj\nnnoremap k gk\nvnoremap j gj\nvnoremap k gk\n\n\" \u7a97\u53e3\u64cd\u4f5c\nnnoremap &lt;C-h&gt; &lt;C-w&gt;h\nnnoremap &lt;C-j&gt; &lt;C-w&gt;j\nnnoremap &lt;C-k&gt; &lt;C-w&gt;k\nnnoremap &lt;C-l&gt; &lt;C-w&gt;l\n\n\" ===== \u8bed\u6cd5\u9ad8\u4eae\u589e\u5f3a =====\n\" \u542f\u7528\u66f4\u591a\u8bed\u6cd5\u9ad8\u4eae\nautocmd BufRead,BufNewFile *.md set filetype=markdown\nautocmd BufRead,BufNewFile *.json set filetype=json\nautocmd BufRead,BufNewFile *.yml,*.yaml set filetype=yaml\nautocmd BufRead,BufNewFile *.conf set filetype=conf\nautocmd BufRead,BufNewFile *.log set filetype=log\n\n\" \u9ad8\u4eae\u5f53\u524d\u8bcd\nset hlsearch\n\" \u641c\u7d22\u65f6\u5b9e\u65f6\u9ad8\u4eae\nset incsearch\n\n\" ===== \u72b6\u6001\u680f\u589e\u5f3a =====\nset statusline=%F%m%r%h%w\\ [%{&amp;ff}]\\ [%Y]\\ [ASCII=\\%03.3b]\\ [HEX=\\%02.2B]\\ [%04l,%04v][%p%%]\\ [LEN=%L]\n\n\" ===== \u81ea\u52a8\u547d\u4ee4 =====\n\" \u81ea\u52a8\u53bb\u9664\u884c\u5c3e\u7a7a\u683c\nautocmd BufWritePre * :%s/\\s\\+$//e\n\n\" \u8bb0\u4f4f\u5149\u6807\u4f4d\u7f6e\nautocmd BufReadPost * if line(\"'\\\"\") &gt; 1 &amp;&amp; line(\"'\\\"\") &lt;= line(\"$\") | exe \"normal! g'\\\"\" | endif\n\n\" ===== \u6298\u53e0\u8bbe\u7f6e =====\nset foldmethod=indent\nset foldlevel=99\n\" \u7a7a\u683c\u952e\u5207\u6362\u6298\u53e0\nnnoremap &lt;space&gt; za\n\n\" ===== \u63d2\u5165\u6a21\u5f0f\u589e\u5f3a =====\n\" \u63d2\u5165\u6a21\u5f0f\u4e0b\u7684\u5feb\u6377\u79fb\u52a8\ninoremap &lt;C-h&gt; &lt;Left&gt;\ninoremap &lt;C-j&gt; &lt;Down&gt;\ninoremap &lt;C-k&gt; &lt;Up&gt;\ninoremap &lt;C-l&gt; &lt;Right&gt;\ninoremap &lt;C-a&gt; &lt;Home&gt;\ninoremap &lt;C-e&gt; &lt;End&gt;\n\n\" ===== \u5176\u4ed6\u5b9e\u7528\u8bbe\u7f6e =====\nset title              \" \u663e\u793a\u6807\u9898\nset confirm            \" \u786e\u8ba4\u5bf9\u8bdd\u6846\nset autoread           \" \u81ea\u52a8\u8bfb\u53d6\u5916\u90e8\u66f4\u6539\nset hidden             \" \u5141\u8bb8\u5728\u672a\u4fdd\u5b58\u65f6\u5207\u6362\u7f13\u51b2\u533a\n\n\" \u7981\u7528\u70e6\u4eba\u7684\u54cd\u94c3\nset noerrorbells\nset novisualbell\nset t_vb=\n\n\" \u66f4\u597d\u7684\u5206\u5272\u7a97\u53e3\nset splitbelow\nset splitright\nEOF\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%88%9D%E5%A7%8B%E5%8C%96/#_6","title":"\u91cd\u542f\u673a\u5668","text":"Bash<pre><code># \u4fee\u6539\u914d\u7f6e\u540e\u6700\u597d\u91cd\u542f\u673a\u5668\nsync;reboot\n</code></pre>","tags":["\u7cfb\u7edf\u521d\u59cb\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/","title":"\u7cfb\u7edf\u5b89\u88c5","text":"<p>\u672c\u6587\u6863\u63d0\u4f9b CentOS\u3001Ubuntu \u548c Debian \u4e09\u4e2a\u4e3b\u6d41 Linux \u53d1\u884c\u7248\u7684\u8be6\u7ec6\u5b89\u88c5\u6307\u5357\u3002</p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_2","title":"\u51c6\u5907\u5de5\u4f5c","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_3","title":"\u7cfb\u7edf\u8981\u6c42","text":"<ul> <li>\u6700\u5c0f\u5185\u5b58\uff1a2GB RAM\uff08\u63a8\u8350 4GB \u6216\u66f4\u591a\uff09</li> <li>\u786c\u76d8\u7a7a\u95f4\uff1a20GB+ \u53ef\u7528\u7a7a\u95f4\uff08\u63a8\u8350 200GB \u6216\u66f4\u591a\uff09\uff0c\u5efa\u8bae\u5c06\u7cfb\u7edf\u5b89\u88c5\u5728\u72ec\u7acb\u7684\u78c1\u76d8\u4e0a\uff0c\u4e0d\u5efa\u8bae\u4e0e\u6570\u636e\u5b58\u50a8\u5728\u540c\u4e00\u4e2a\u78c1\u76d8\u4e0a</li> <li>\u5904\u7406\u5668\uff1a64\u4f4d\u5904\u7406\u5668</li> <li>\u7f51\u7edc\u8fde\u63a5\uff1a\u5efa\u8bae\u6709\u7a33\u5b9a\u7684\u7f51\u7edc\u8fde\u63a5</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_4","title":"\u5236\u4f5c\u5b89\u88c5\u4ecb\u8d28","text":"<ol> <li>\u4e0b\u8f7d\u5bf9\u5e94\u7cfb\u7edf\u7684 ISO \u955c\u50cf\u6587\u4ef6</li> <li>\u51c6\u5907 USB \u95ea\u5b58\u9a71\u52a8\u5668\uff088GB \u6216\u66f4\u5927\uff09</li> <li>\u4f7f\u7528\u5de5\u5177\u5236\u4f5c\u542f\u52a8\u76d8\uff1a</li> <li>Windows\uff1aRufus\u3001Etcher</li> </ol>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_5","title":"\u955c\u50cf\u4e0b\u8f7d\u5730\u5740","text":"<ul> <li>CentOS\uff1ahttps://www.centos.org/download/<ul> <li>\u56fd\u5185\u963f\u91cc\u4e91\uff1ahttps://mirrors.aliyun.com/centos/?spm=a2c6h.25603864.0.0.322766edd98tvG</li> </ul> </li> <li>Ubuntu\uff1ahttps://ubuntu.com/download<ul> <li>\u56fd\u5185\u963f\u91cc\u4e91\uff1ahttps://mirrors.aliyun.com/ubuntu-releases/?spm=a2c6h.25603864.0.0.71344ddaMOFkII</li> </ul> </li> <li>Debian\uff1ahttps://www.debian.org/distrib/</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#centos","title":"CentOS \u7cfb\u7edf\u5b89\u88c5","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#centos_1","title":"\u83b7\u53d6 CentOS","text":"<p>CentOS Stream \u662f\u5f53\u524d\u7684\u4e3b\u8981\u7248\u672c\uff0c\u60a8\u4e5f\u53ef\u4ee5\u9009\u62e9 AlmaLinux \u6216 Rocky Linux \u4f5c\u4e3a RHEL \u517c\u5bb9\u7684\u5f00\u6e90\u514d\u8d39\u66ff\u4ee3\u65b9\u6848\u3002</p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_6","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#1","title":"1. \u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f","text":"<ul> <li>\u4ece USB \u542f\u52a8\u76d8\u5f15\u5bfc\u7cfb\u7edf</li> <li>\u9009\u62e9 \"Install CentOS Stream\" \u6216\u5bf9\u5e94\u7248\u672c</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#2","title":"2. \u8bed\u8a00\u548c\u952e\u76d8\u8bbe\u7f6e","text":"<ul> <li>\u9009\u62e9\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684\u8bed\u8a00</li> <li>\u914d\u7f6e\u952e\u76d8\u5e03\u5c40\uff08\u901a\u5e38\u9009\u62e9 US \u6216\u5bf9\u5e94\u5730\u533a\u5e03\u5c40\uff09</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#3","title":"3. \u5b89\u88c5\u6458\u8981\u914d\u7f6e","text":"<p>\u65e5\u671f\u548c\u65f6\u95f4</p> <ul> <li>\u9009\u62e9\u6b63\u786e\u7684\u65f6\u533a</li> </ul> <p></p> <p></p> <p>\u8f6f\u4ef6\u9009\u62e9</p> <ul> <li> <p>\u6700\u5c0f\u5b89\u88c5\uff1a\u57fa\u7840\u7cfb\u7edf\uff0c\u9002\u5408\u670d\u52a1\u5668\uff08\u65e0\u56fe\u5f62\u754c\u9762\uff09,\u4e00\u822c\u7528\u4e8e\u751f\u4ea7\u73af\u5883</p> </li> <li> <p>\u670d\u52a1\u5668\uff1a\u5305\u542b\u670d\u52a1\u5668\u5e38\u7528\u8f6f\u4ef6\uff0c\u5982 NGINX\u3001VIM\u3001JAVA \u7b49</p> </li> <li> <p>\u5de5\u4f5c\u7ad9\uff1a\u4e00\u822c\u7528\u4e8e\u684c\u9762\u73af\u5883\uff0c\u5982\u529e\u516c\u8f6f\u4ef6\u3001\u5f00\u53d1\u5de5\u5177\u7b49</p> </li> <li> <p>\u81ea\u5b9a\u4e49\uff1a\u6839\u636e\u9700\u8981\u9009\u62e9\u8f6f\u4ef6\u5305\u7ec4</p> </li> </ul> <p></p> <p>\u5b89\u88c5\u76ee\u7684\u5730</p> <p>Tip</p> <p>\u78c1\u76d8\u5206\u533a\u5efa\u8bae</p> <ul> <li>/boot     : 1GB   (ext4)</li> <li>/boot/efi : 512MB (FAT32) - UEFI \u7cfb\u7edf\u9700\u8981</li> <li>swap      : \u865a\u62df\u5185\u5b58\uff0c\u4e00\u822c\u5efa\u8bae\u8bbe\u7f6e\u4e3a\u7269\u7406\u5185\u5b58\u76841-2\u500d,\u59828GB\u5185\u5b58,\u5219\u8bbe\u7f6e\u4e3a16GB</li> <li>/         : 20GB+ (xfs/ext4)</li> <li>/data     : 100GB+ (xfs/ext4)\uff0c\u5efa\u8bae\u4f7f\u7528\u72ec\u7acb\u7684\u78c1\u76d8\uff0c\u7528\u4e8e\u5b58\u50a8\u6570\u636e\uff0c\u5982\u6570\u636e\u5e93\u3001\u4e1a\u52a1\u6570\u636e\u7b49\uff0c\u4e0d\u5efa\u8bae\u4e0e\u7cfb\u7edf\u5b89\u88c5\u5728\u540c\u4e00\u4e2a\u78c1\u76d8\u4e0a</li> </ul> <p>\u70b9\u51fb \"\u5b89\u88c5\u76ee\u6807\u4f4d\u7f6e\"\uff08INSTALLATION DESTINATION\uff09\u3002</p> <p>\u70b9\u51fb\u7cfb\u7edf\u76d8\u78c1\u76d8\uff0c\u70b9\u51fb \"\u6211\u4f1a\u914d\u7f6e\u5206\u533a\" \uff08I will configure partitioning\uff09\u3002</p> <p></p> <p>\u9009\u62e9\u6807\u51c6\u5206\u533a\uff08Standard Partition\uff09\u3002</p> <p>\u9009\u62e9 \"/boot\" \u5206\u533a\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6302\u8f7d\u70b9\"\uff08Add Mount Point\uff09\uff0c\u8f93\u5165 \"/boot\"\uff0c\u5206\u914d1G \u7a7a\u95f4\u3002</p> <p>\u9009\u62e9 \"/boot/efi\" \u5206\u533a\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6302\u8f7d\u70b9\"\uff08Add Mount Point\uff09\uff0c\u8f93\u5165 \"/boot/efi\"\uff0c\u5206\u914d512MB \u7a7a\u95f4\u3002\uff08\u53ef\u9009\uff0cUEFI \u7cfb\u7edf\u9700\u8981\uff09</p> <p></p> <p>\u9009\u62e9 \"/swap\" \u5206\u533a\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6302\u8f7d\u70b9\"\uff08Add Mount Point\uff09\uff0c\u8f93\u5165 \"/swap\"\uff0c\u5206\u914d4GB \u7a7a\u95f4\u3002\uff08\u53ef\u9009\uff0c\u6839\u636e\u5185\u5b58\u5927\u5c0f\u8c03\u6574\uff09</p> <p></p> <p>\u9009\u62e9 \"/\" \u5206\u533a\uff0c\u70b9\u51fb \"\u6dfb\u52a0\u6302\u8f7d\u70b9\"\uff08Add Mount Point\uff09\uff0c\u8f93\u5165 \"/\"\uff0c\u5c06\u5269\u4f59\u7a7a\u95f4\u5206\u914d\u7ed9\u6839\u5206\u533a\u3002</p> <p></p> <p>\u70b9\u51fb \"\u5b8c\u6210\"\uff08Done\uff09</p> <p></p> <p>\u70b9\u51fb \"\u63a5\u53d7\u66f4\u6539\"\uff08Accept Changes\uff09</p> <p></p> <p>\u7f51\u7edc\u548c\u4e3b\u673a\u540d - \u542f\u7528\u7f51\u7edc\u63a5\u53e3 - \u8bbe\u7f6e\u4e3b\u673a\u540d\uff08\u5982\uff1acentos-server\uff09 - \u914d\u7f6e IP \u5730\u5740\uff08\u9759\u6001\u6216 DHCP\uff09\uff08\u53ef\u9009\uff0c\u751f\u4ea7\u73af\u5883\u5efa\u8bae\u4f7f\u7528\u9759\u6001 IP\uff09</p> <p> </p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#4","title":"4. \u7528\u6237\u8bbe\u7f6e","text":"Warning <p>\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5efa\u8bae\u4f7f\u7528 12 \u4f4d\u4ee5\u4e0a\u9ad8\u590d\u6742\u5ea6\u5bc6\u7801\uff0c\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u7279\u6b8a\u5b57\u7b26\uff0c\u6bd4\u5982 <code>7$,eKX3&gt;7Y8}**pY</code></p> <p>\u975e\u5fc5\u8981\u60c5\u51b5\u4e0b\uff0c\u4e0d\u5efa\u8bae\u6388\u4e88\u666e\u901a\u7528\u6237\u7ba1\u7406\u5458\u6743\u9650\uff08sudo\uff09</p> <ul> <li>\u8bbe\u7f6e root \u5bc6\u7801</li> <li>\u521b\u5efa\u666e\u901a\u7528\u6237\u8d26\u6237\uff0c\u6bd4\u5982 <code>guodi</code>\uff0c\u5e76\u8bbe\u7f6e\u5bc6\u7801</li> </ul> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#5","title":"5. \u5f00\u59cb\u5b89\u88c5","text":"<ul> <li>\u70b9\u51fb \"\u5b8c\u6210\u914d\u7f6e\" \uff08Finish Configuration\uff09</li> <li>\u7b49\u5f85\u5b89\u88c5\u5b8c\u6210\uff08\u901a\u5e38 1-5 \u5206\u949f\uff0c\u6839\u636e\u7f51\u7edc\u901f\u5ea6\u548c\u78c1\u76d8\u6027\u80fd\u800c\u6709\u6240\u5dee\u5f02\uff09</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#6","title":"6. \u5b8c\u6210\u5b89\u88c5","text":"<ul> <li>\u79fb\u9664\u5b89\u88c5\u4ecb\u8d28</li> <li>\u91cd\u542f\u7cfb\u7edf</li> <li>\u767b\u5f55\u7cfb\u7edf</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#ubuntu","title":"Ubuntu \u7cfb\u7edf\u5b89\u88c5","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#ubuntu_1","title":"\u83b7\u53d6 Ubuntu \u955c\u50cf","text":"Info <p>\u63a8\u8350\u4e0b\u8f7d Ubuntu LTS\uff08\u957f\u671f\u652f\u6301\uff09\u7248\u672c\uff0c\u5982 Ubuntu 22.04 LTS\u3002</p> <p>\u5f00\u53d1\u8005\u672c\u5730\u4f7f\u7528\u63a8\u8350\u5b89\u88c5 Desktop \u7248\u672c\uff0c\u5982 Ubuntu 22.04 LTS Desktop\u3002</p> <p>\u670d\u52a1\u5668\u73af\u5883\u63a8\u8350\u4f7f\u7528 Server \u7248\u672c\uff0c\u5982 Ubuntu 22.04 LTS Server\u3002</p> <ul> <li> <p>\u8bbf\u95ee Ubuntu\u955c\u50cf\u7ad9</p> </li> <li> <p>\u8bbf\u95ee \u963f\u91cc\u4e91\u955c\u50cf\u7ad9</p> </li> </ul> <p>Ubuntu \u7248\u672c\u7ef4\u62a4\u671f \u4e3a\u4e94\u5e74\uff08\u975e\u8ba2\u9605\u7528\u6237\uff09\uff0c\u6ca1\u6709\u7279\u6b8a\u60c5\u51b5\uff0c\u5efa\u8bae\u4f7f\u7528\u5f53\u524d\u6700\u7a33\u5b9a\u7684\u7248\u672c\uff0c\u65b9\u4fbf\u7cfb\u7edf\u9700\u8981\u5b89\u5168\u66f4\u65b0\u65f6\u80fd\u6709\u5b98\u65b9\u8865\u4e01\u3002</p> <p></p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_7","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#1_1","title":"1. \u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f","text":"<ul> <li>\u4ece USB \u542f\u52a8\u76d8\u5f15\u5bfc</li> <li>\u9009\u62e9 \"Try or Install Ubuntu\"</li> <li>\u9009\u62e9 \"Install Ubuntu\"</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#2_1","title":"2. \u66f4\u65b0\u8f6f\u4ef6","text":"<ul> <li>\u9009\u62e9 \"\u4e0d\u66f4\u65b0\"\uff08Continue without updating\uff09 \u9009\u9879</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#3_1","title":"3. \u952e\u76d8\u5e03\u5c40","text":"<ul> <li>\u9009\u62e9 \"English (US)\" \u6216 \"English (US, intl.)\" \u9009\u9879</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#4_1","title":"4. \u5b89\u88c5\u7c7b\u578b","text":"Warning <p>\u4e0d\u63a8\u8350\u9009\u62e9 \"Ubuntu Server (minimized)\" \uff0c\u6700\u5c0f\u5316\u5b89\u88c5\u8fc7\u4e8e\u7cbe\u7b80\uff0c\u5b9e\u9645\u4f7f\u7528\u975e\u5e38\u4e0d\u4fbf</p> <p>\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef</p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#5_1","title":"5. \u7f51\u7edc\u8bbe\u7f6e","text":"<ul> <li>\u7cfb\u7edf\u4f1a\u81ea\u52a8\u68c0\u6d4b\u7f51\u7edc\u63a5\u53e3</li> <li>\u9009\u62e9\u81ea\u52a8\u83b7\u53d6 IP \u5730\u5740\uff08DHCP\uff09\u6216\u624b\u52a8\u914d\u7f6e IP \u5730\u5740</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#6_1","title":"6. \u4ee3\u7406\u8bbe\u7f6e","text":"<p>\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u914d\u7f6e</p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#7","title":"7. \u8f6f\u4ef6\u6e90\u8bbe\u7f6e","text":"<p>Info</p> <p>\u5982\u679c\u5b89\u88c5\u65f6\u80fd\u8fde\u4e92\u8054\u7f51\uff0c\u4f1a\u81ea\u52a8\u83b7\u53d6\u5f53\u524d\u53ef\u7528\u7684\u6e90\uff1b</p> <p>\u5982\u679c\u5b89\u88c5\u65f6\u4e0d\u80fd\u8fde\u4e92\u8054\u7f51\uff0c\u9700\u8981\u7cfb\u7edf\u5b89\u88c5\u6210\u529f\u540e\uff0c\u624b\u52a8\u914d\u7f6e\u8f6f\u4ef6\u6e90</p> <p>\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef</p> <p></p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#8","title":"8. \u78c1\u76d8\u5206\u533a","text":"<p>Info</p> <p>\u6ca1\u6709\u7279\u6b8a\u9700\u8981\uff0c\u4e0d\u5bf9\u78c1\u76d8\u8fdb\u884c\u52a0\u5bc6\u3002</p> <p>\u4fdd\u5b58\u9ed8\u8ba4\u5373\u53ef\uff0c\u9ed8\u8ba4\u5373\u4e3aLVM \u65b9\u5f0f\u5206\u533a\uff0c\u65b9\u4fbf\u540e\u671f\u62d3\u5c55\u78c1\u76d8\u3002</p> <p> </p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#9","title":"9. \u6dfb\u52a0\u7528\u6237","text":"<p>Info</p> <p>\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5efa\u8bae\u4f7f\u7528 12 \u4f4d\u4ee5\u4e0a\u9ad8\u590d\u6742\u5ea6\u5bc6\u7801\uff0c\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u7279\u6b8a\u5b57\u7b26\uff0c\u6bd4\u5982 <code>7$,eKX3&gt;7Y8}**pY</code></p> <ul> <li>\u8f93\u5165\u59d3\u540d</li> <li>\u8bbe\u7f6e\u8ba1\u7b97\u673a\u540d\u79f0</li> <li>\u521b\u5efa\u7528\u6237\u540d</li> <li>\u8bbe\u7f6e\u5bc6\u7801</li> </ul> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#10","title":"10. \u5347\u7ea7\u8ba2\u9605","text":"<p>\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef, \u901a\u5e38\u4e0d\u9700\u8981\u8ba2\u9605</p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#11-ssh","title":"11. SSH \u5b89\u88c5","text":"Warning <p>\u52fe\u9009 \"Install OpenSSH server\"\uff0c\u5426\u5219\u540e\u9762\u65e0\u6cd5\u8fdc\u7a0b\u767b\u5f55</p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#12","title":"12. \u8f6f\u4ef6\u5b89\u88c5","text":"<p>\u4fdd\u6301\u9ed8\u8ba4\u5373\u53ef\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u5b89\u88c5\u4efb\u4f55\u989d\u5916\u7684\u8f6f\u4ef6</p> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#13","title":"13. \u7cfb\u7edf\u5b89\u88c5","text":"<ul> <li>\u7b49\u5f85\u5b89\u88c5\u8fc7\u7a0b\u5b8c\u6210</li> <li>\u91cd\u542f\u7cfb\u7edf</li> <li>\u79fb\u9664\u5b89\u88c5\u4ecb\u8d28</li> <li>\u767b\u5f55\u7cfb\u7edf</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#debian","title":"Debian \u7cfb\u7edf\u5b89\u88c5","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#debian_1","title":"\u83b7\u53d6 Debian","text":"<p>\u63a8\u8350\u4e0b\u8f7d Debian Stable \u7248\u672c\uff0c\u63d0\u4f9b\u6700\u4f73\u7684\u7a33\u5b9a\u6027\u3002</p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_8","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#1_2","title":"1. \u542f\u52a8\u5b89\u88c5\u7a0b\u5e8f","text":"<ul> <li>\u4ece USB \u542f\u52a8\u76d8\u5f15\u5bfc</li> <li>\u9009\u62e9 \"Graphical install\" \u6216 \"Install\"</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#2_2","title":"2. \u57fa\u672c\u914d\u7f6e","text":"<p>\u8bed\u8a00\u9009\u62e9</p> <ul> <li>\u9009\u62e9\u5b89\u88c5\u8bed\u8a00</li> </ul> <p></p> <p>\u5730\u533a\u8bbe\u7f6e</p> <ul> <li>\u9009\u62e9\u56fd\u5bb6\u6216\u5730\u533a</li> </ul> <p></p> <p>\u952e\u76d8\u914d\u7f6e</p> <ul> <li>\u9009\u62e9\u952e\u76d8\u5e03\u5c40</li> </ul> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#3_2","title":"3. \u7f51\u7edc\u914d\u7f6e","text":"<ul> <li>\u7cfb\u7edf\u4f1a\u81ea\u52a8\u68c0\u6d4b\u7f51\u7edc\u63a5\u53e3</li> <li>\u8bbe\u7f6e\u4e3b\u673a\u540d</li> <li>\u8bbe\u7f6e\u57df\u540d\uff08\u53ef\u9009\uff09</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#4_2","title":"4. \u7528\u6237\u548c\u5bc6\u7801","text":"<ul> <li>\u8bbe\u7f6e root \u5bc6\u7801</li> <li>\u521b\u5efa\u666e\u901a\u7528\u6237\u8d26\u6237</li> <li>\u8bbe\u7f6e\u7528\u6237\u5bc6\u7801</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#5_2","title":"5. \u78c1\u76d8\u5206\u533a","text":"<p>\u5f15\u5bfc\u5f0f\u5206\u533a</p> <ul> <li>\u4f7f\u7528\u6574\u4e2a\u78c1\u76d8</li> <li>\u4f7f\u7528\u6574\u4e2a\u78c1\u76d8\u5e76\u8bbe\u7f6e LVM</li> </ul> <p> </p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#6_2","title":"6. \u8f6f\u4ef6\u6e90\u914d\u7f6e","text":"<ul> <li>\u9009\u62e9 Debian \u8f6f\u4ef6\u6e90\u955c\u50cf</li> <li>\u914d\u7f6e\u4ee3\u7406\uff08\u5982\u9700\u8981\uff09</li> <li>\u9009\u62e9\u662f\u5426\u53c2\u4e0e\u8f6f\u4ef6\u5305\u6d41\u884c\u5ea6\u8c03\u67e5</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#7_1","title":"7. \u8f6f\u4ef6\u9009\u62e9","text":"<p>Info</p> <p>\u9009\u62e9\u5b89\u88c5 SSH \u670d\u52a1\u5668\u548c\u6807\u51c6\u7cfb\u7edf\u5de5\u5177\u5373\u53ef\uff0c\u6ca1\u6709\u7279\u6b8a\u9700\u8981\u4e0d\u5b89\u88c5\u989d\u5916\u8f6f\u4ef6\u3002</p> <ul> <li>SSH \u670d\u52a1\u5668\uff1a\u8fdc\u7a0b\u7ba1\u7406</li> <li>\u6807\u51c6\u7cfb\u7edf\u5de5\u5177\uff1a\u57fa\u7840\u5de5\u5177</li> </ul> <p></p>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#8-grub","title":"8. \u5b89\u88c5 GRUB \u5f15\u5bfc\u7a0b\u5e8f","text":"<ul> <li>\u9009\u62e9\u5b89\u88c5 GRUB \u5230\u4e3b\u5f15\u5bfc\u5206\u533a</li> <li>\u9009\u62e9\u8bbe\u5907\uff08\u901a\u5e38\u662f /dev/sda\uff09</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#9_1","title":"9. \u5b8c\u6210\u5b89\u88c5","text":"<ul> <li>\u79fb\u9664\u5b89\u88c5\u4ecb\u8d28</li> <li>\u91cd\u542f\u7cfb\u7edf</li> <li>\u767b\u5f55\u7cfb\u7edf</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_9","title":"\u5b89\u88c5\u540e\u914d\u7f6e","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_10","title":"\u901a\u7528\u914d\u7f6e","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#1_3","title":"1. \u7cfb\u7edf\u66f4\u65b0","text":"Bash<pre><code># CentOS/RHEL\nsudo dnf update -y\n\n# Ubuntu\nsudo apt update &amp;&amp; sudo apt upgrade -y\n\n# Debian\nsudo apt update &amp;&amp; sudo apt upgrade -y\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#2_3","title":"2. \u5b89\u88c5\u5e38\u7528\u8f6f\u4ef6","text":"Bash<pre><code># \u5f00\u53d1\u5de5\u5177\n# Ubuntu/Debian\nsudo apt install git vim wget curl net-tools htop tree zip unzip\n# Centos\nsudo yum install git vim wget curl net-tools htop tree zip unzip\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#3_3","title":"3. \u914d\u7f6e\u9632\u706b\u5899","text":"Bash<pre><code># CentOS (firewalld)\nsudo systemctl enable --now firewalld\nsudo firewall-cmd --permanent --add-service=ssh\nsudo firewall-cmd --reload\n\n# Ubuntu/Debian (ufw)\nsudo ufw enable\nsudo ufw allow ssh\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#4-ssh","title":"4. \u914d\u7f6e SSH","text":"Bash<pre><code># \u542f\u7528 SSH \u670d\u52a1\nsudo systemctl enable --now ssh\n\n# \u7f16\u8f91 SSH \u914d\u7f6e\uff08\u53ef\u9009\uff09\nsudo vim /etc/ssh/sshd_config\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#_11","title":"\u5e38\u89c1\u95ee\u9898","text":"","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#1_4","title":"1. \u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7f51\u7edc\u8fde\u63a5\u5931\u8d25\u600e\u4e48\u529e\uff1f","text":"<ul> <li>\u68c0\u67e5\u7f51\u7ebf\u8fde\u63a5</li> <li>\u5c1d\u8bd5\u4f7f\u7528\u6709\u7ebf\u8fde\u63a5\u800c\u975e\u65e0\u7ebf</li> <li>\u8df3\u8fc7\u7f51\u7edc\u914d\u7f6e\uff0c\u5b89\u88c5\u540e\u518d\u914d\u7f6e</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#2_4","title":"2. \u5206\u533a\u65f6\u5982\u4f55\u9009\u62e9\u6587\u4ef6\u7cfb\u7edf\uff1f","text":"<ul> <li>ext4\uff1a\u901a\u7528\u9009\u62e9\uff0c\u517c\u5bb9\u6027\u597d</li> <li>xfs\uff1a\u5927\u6587\u4ef6\u6027\u80fd\u4f18\u79c0\uff08CentOS \u9ed8\u8ba4\uff09</li> <li>btrfs\uff1a\u652f\u6301\u5feb\u7167\u548c\u538b\u7f29\uff08\u5b9e\u9a8c\u6027\uff09</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#3-root","title":"3. \u5fd8\u8bb0 root \u5bc6\u7801\u600e\u4e48\u529e\uff1f","text":"<ol> <li>\u91cd\u542f\u7cfb\u7edf\u8fdb\u5165 GRUB \u83dc\u5355</li> <li>\u7f16\u8f91\u542f\u52a8\u53c2\u6570\uff0c\u6dfb\u52a0 <code>init=/bin/bash</code></li> <li>\u91cd\u65b0\u6302\u8f7d\u6839\u6587\u4ef6\u7cfb\u7edf\uff1a<code>mount -o remount,rw /</code></li> <li>\u4fee\u6539\u5bc6\u7801\uff1a<code>passwd root</code></li> <li>\u91cd\u542f\u7cfb\u7edf</li> </ol>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#4_3","title":"4. \u5982\u4f55\u5728\u865a\u62df\u673a\u4e2d\u5b89\u88c5\uff1f","text":"<ul> <li>\u63a8\u8350\u4f7f\u7528 VMware Workstation \u6216 VirtualBox </li> <li>\u5206\u914d\u81f3\u5c11 2GB \u5185\u5b58</li> <li>\u521b\u5efa 20GB+ \u865a\u62df\u786c\u76d8</li> <li>\u542f\u7528\u865a\u62df\u5316\u6280\u672f\u652f\u6301</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"01-%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83/%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85/#5_3","title":"5. \u5982\u4f55\u9009\u62e9\u5408\u9002\u7684\u53d1\u884c\u7248\uff1f","text":"<ul> <li>CentOS/RHEL\uff1a\u4f01\u4e1a\u670d\u52a1\u5668\u73af\u5883\uff0c\u7a33\u5b9a\u6027\u597d\uff0c\u4f01\u4e1a\u7ea7\u652f\u6301\uff1b</li> <li>Ubuntu\uff1a\u9700\u8981LINUX\u684c\u9762\u73af\u5883\uff0c\u5bf9\u65b0\u624b\u53cb\u597d\uff1b\u5f00\u53d1\u4eba\u5458\u5e38\u7528</li> <li>Debian\uff1a\u7a33\u5b9a\u6027\u8981\u6c42\u9ad8\u7684\u73af\u5883\uff0c\u5982\u670d\u52a1\u5668\u73af\u5883\uff1b\u5bf9\u7cfb\u7edf\u7ba1\u7406\u5458\u53cb\u597d</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u88c5","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/","title":"02-\u5bb9\u5668\u5316","text":""},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/","title":"Docker Compose \u90e8\u7f72","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_1","title":"\u5b89\u88c5\u524d\u51c6\u5907","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_2","title":"\u7cfb\u7edf\u8981\u6c42","text":"<ul> <li>\u5df2\u5b89\u88c5Docker Engine</li> <li>Linux 64\u4f4d\u7cfb\u7edf</li> <li>\u5177\u6709sudo\u6743\u9650\u7684\u7528\u6237\u8d26\u6237</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#docker","title":"\u68c0\u67e5Docker\u662f\u5426\u5df2\u5b89\u88c5","text":"Bash<pre><code>docker --version\n</code></pre> <p>\u5982\u679cDocker\u672a\u5b89\u88c5\uff0c\u8bf7\u5148\u53c2\u8003Docker\u90e8\u7f72\u6587\u6863\u8fdb\u884c\u5b89\u88c5\u3002</p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_3","title":"\u65b9\u5f0f\u4e00\uff1a\u4e8c\u8fdb\u5236\u5b89\u88c5","text":"<p>\u8fd9\u662f\u6700\u5e38\u7528\u548c\u63a8\u8350\u7684\u5b89\u88c5\u65b9\u5f0f\uff0c\u9002\u7528\u4e8e\u6240\u6709Linux\u53d1\u884c\u7248\u3002</p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#centosred-hat","title":"CentOS/Red Hat \u7cfb\u7edf","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1-docker-compose","title":"1. \u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684Docker Compose","text":"Bash<pre><code># \u83b7\u53d6\u6700\u65b0\u7248\u672c\u53f7\uff08\u53ef\u9009\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u7248\u672c\uff09\nDOCKER_COMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d\\\" -f4)\n\n# \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u6587\u4ef6\nsudo curl -L \"https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n# \u6216\u8005\u76f4\u63a5\u6307\u5b9a\u7248\u672c\uff08\u63a8\u8350\uff0c\u66f4\u7a33\u5b9a\uff09\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.24.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2","title":"2. \u8bbe\u7f6e\u6267\u884c\u6743\u9650","text":"Bash<pre><code>sudo chmod +x /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3","title":"3. \u521b\u5efa\u8f6f\u94fe\u63a5\uff08\u53ef\u9009\uff0c\u4e3a\u4e86\u517c\u5bb9\u6027\uff09","text":"Bash<pre><code>sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#ubuntudebian","title":"Ubuntu/Debian \u7cfb\u7edf","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1","title":"1. \u66f4\u65b0\u5305\u7d22\u5f15","text":"Bash<pre><code>sudo apt-get update\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2-curl","title":"2. \u5b89\u88c5curl\uff08\u5982\u679c\u672a\u5b89\u88c5\uff09","text":"Bash<pre><code>sudo apt-get install -y curl\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3-docker-compose","title":"3. \u4e0b\u8f7dDocker Compose\u4e8c\u8fdb\u5236\u6587\u4ef6","text":"Bash<pre><code># \u83b7\u53d6\u6700\u65b0\u7248\u672c\u53f7\uff08\u53ef\u9009\uff09\nDOCKER_COMPOSE_VERSION=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | grep 'tag_name' | cut -d\\\" -f4)\n\n# \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u6587\u4ef6\nsudo curl -L \"https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n# \u6216\u8005\u76f4\u63a5\u6307\u5b9a\u7248\u672c\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.24.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#4","title":"4. \u8bbe\u7f6e\u6267\u884c\u6743\u9650","text":"Bash<pre><code>sudo chmod +x /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#5","title":"5. \u521b\u5efa\u8f6f\u94fe\u63a5\uff08\u53ef\u9009\uff09","text":"Bash<pre><code>sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#python-pip","title":"\u65b9\u5f0f\u4e8c\uff1aPython pip \u5b89\u88c5","text":"<p>\u5982\u679c\u7cfb\u7edf\u5df2\u5b89\u88c5Python\u548cpip\uff0c\u53ef\u4ee5\u901a\u8fc7pip\u5b89\u88c5Docker Compose\u3002</p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#centosred-hat_1","title":"CentOS/Red Hat \u7cfb\u7edf","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1-pythonpip","title":"1. \u5b89\u88c5Python\u548cpip","text":"Bash<pre><code># CentOS/RHEL 7\nsudo yum install -y python3 python3-pip\n\n# CentOS/RHEL 8/9\nsudo dnf install -y python3 python3-pip\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2-pip","title":"2. \u5347\u7ea7pip","text":"Bash<pre><code>pip3 install --upgrade pip\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3-docker-compose_1","title":"3. \u5b89\u88c5Docker Compose","text":"Bash<pre><code># \u7528\u6237\u7ea7\u5b89\u88c5\npip3 install --user docker-compose\n\n# \u6216\u7cfb\u7edf\u7ea7\u5b89\u88c5\uff08\u9700\u8981sudo\uff09\nsudo pip3 install docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#ubuntudebian_1","title":"Ubuntu/Debian \u7cfb\u7edf","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1-pythonpip_1","title":"1. \u5b89\u88c5Python\u548cpip","text":"Bash<pre><code>sudo apt-get update\nsudo apt-get install -y python3 python3-pip\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2-pip_1","title":"2. \u5347\u7ea7pip","text":"Bash<pre><code>pip3 install --upgrade pip\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3-docker-compose_2","title":"3. \u5b89\u88c5Docker Compose","text":"Bash<pre><code># \u7528\u6237\u7ea7\u5b89\u88c5\npip3 install --user docker-compose\n\n# \u6216\u7cfb\u7edf\u7ea7\u5b89\u88c5\nsudo pip3 install docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#4-path","title":"4. \u6dfb\u52a0\u5230PATH\uff08\u5982\u679c\u4f7f\u7528\u7528\u6237\u7ea7\u5b89\u88c5\uff09","text":"Bash<pre><code>echo 'export PATH=\"$HOME/.local/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_4","title":"\u65b9\u5f0f\u4e09\uff1a\u5305\u7ba1\u7406\u5668\u5b89\u88c5","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#ubuntudebian_2","title":"Ubuntu/Debian \u7cfb\u7edf","text":"Bash<pre><code># \u66f4\u65b0\u5305\u7d22\u5f15\nsudo apt-get update\n\n# \u5b89\u88c5docker-compose\nsudo apt-get install -y docker-compose\n</code></pre> <p>\u6ce8\u610f\uff1a\u901a\u8fc7\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u7684\u7248\u672c\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u7684\u3002</p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#centosrhel","title":"CentOS/RHEL \u7cfb\u7edf","text":"Bash<pre><code># \u542f\u7528EPEL\u4ed3\u5e93\nsudo yum install -y epel-release\n\n# \u5b89\u88c5docker-compose\nsudo yum install -y docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_5","title":"\u9a8c\u8bc1\u5b89\u88c5","text":"<p>\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u9a8c\u8bc1Docker Compose\u662f\u5426\u6b63\u786e\u5b89\u88c5\uff1a</p> Bash<pre><code># \u67e5\u770b\u7248\u672c\ndocker-compose --version\n\n# \u67e5\u770b\u5e2e\u52a9\u4fe1\u606f\ndocker-compose --help\n</code></pre> <p>\u671f\u671b\u8f93\u51fa\u7c7b\u4f3c\u4e8e\uff1a Text Only<pre><code>docker-compose version 2.24.1, build 4c9c828\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_6","title":"\u57fa\u672c\u4f7f\u7528","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#docker-composeyml","title":"\u521b\u5efa\u793a\u4f8bdocker-compose.yml\u6587\u4ef6","text":"Bash<pre><code>mkdir ~/docker-compose-test\ncd ~/docker-compose-test\n</code></pre> <p>\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684<code>docker-compose.yml</code>\u6587\u4ef6\uff1a</p> YAML<pre><code>version: '3.8'\n\nservices:\n  web:\n    image: nginx:latest\n    ports:\n      - \"8080:80\"\n    volumes:\n      - ./html:/usr/share/nginx/html\n    restart: unless-stopped\n\n  redis:\n    image: redis:alpine\n    restart: unless-stopped\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_7","title":"\u57fa\u672c\u547d\u4ee4","text":"Bash<pre><code># \u542f\u52a8\u670d\u52a1\ndocker-compose up -d\n\n# \u67e5\u770b\u8fd0\u884c\u72b6\u6001\ndocker-compose ps\n\n# \u67e5\u770b\u65e5\u5fd7\ndocker-compose logs\n\n# \u505c\u6b62\u670d\u52a1\ndocker-compose down\n\n# \u91cd\u65b0\u6784\u5efa\u5e76\u542f\u52a8\ndocker-compose up --build -d\n\n# \u6269\u5c55\u670d\u52a1\ndocker-compose up --scale web=3 -d\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#docker-compose_1","title":"\u5347\u7ea7Docker Compose","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_8","title":"\u4e8c\u8fdb\u5236\u5b89\u88c5\u65b9\u5f0f\u5347\u7ea7","text":"Bash<pre><code># \u67e5\u770b\u5f53\u524d\u7248\u672c\ndocker-compose --version\n\n# \u4e0b\u8f7d\u65b0\u7248\u672c\uff08\u66ff\u6362\u4e3a\u6700\u65b0\u7248\u672c\u53f7\uff09\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.24.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n\n# \u8bbe\u7f6e\u6267\u884c\u6743\u9650\nsudo chmod +x /usr/local/bin/docker-compose\n\n# \u9a8c\u8bc1\u5347\u7ea7\ndocker-compose --version\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#pip","title":"pip\u5b89\u88c5\u65b9\u5f0f\u5347\u7ea7","text":"Bash<pre><code># \u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\npip3 install --upgrade docker-compose\n\n# \u6216\u7cfb\u7edf\u7ea7\u5347\u7ea7\nsudo pip3 install --upgrade docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#docker-compose_2","title":"\u5378\u8f7dDocker Compose","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_9","title":"\u4e8c\u8fdb\u5236\u5b89\u88c5\u65b9\u5f0f\u5378\u8f7d","text":"Bash<pre><code># \u5220\u9664\u4e8c\u8fdb\u5236\u6587\u4ef6\nsudo rm /usr/local/bin/docker-compose\n\n# \u5220\u9664\u8f6f\u94fe\u63a5\uff08\u5982\u679c\u521b\u5efa\u4e86\uff09\nsudo rm /usr/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#pip_1","title":"pip\u5b89\u88c5\u65b9\u5f0f\u5378\u8f7d","text":"Bash<pre><code># \u7528\u6237\u7ea7\u5378\u8f7d\npip3 uninstall docker-compose\n\n# \u7cfb\u7edf\u7ea7\u5378\u8f7d\nsudo pip3 uninstall docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_10","title":"\u5305\u7ba1\u7406\u5668\u5b89\u88c5\u65b9\u5f0f\u5378\u8f7d","text":"Bash<pre><code># Ubuntu/Debian\nsudo apt-get remove docker-compose\n\n# CentOS/RHEL\nsudo yum remove docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_11","title":"\u6545\u969c\u6392\u9664","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1_1","title":"1. \u6743\u9650\u95ee\u9898","text":"Bash<pre><code># \u786e\u4fdddocker-compose\u6709\u6267\u884c\u6743\u9650\nls -l /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2_1","title":"2. \u547d\u4ee4\u672a\u627e\u5230","text":"Bash<pre><code># \u68c0\u67e5PATH\necho $PATH\n\n# \u521b\u5efa\u8f6f\u94fe\u63a5\nsudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose\n\n# \u6216\u6dfb\u52a0\u5230PATH\necho 'export PATH=\"/usr/local/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3_1","title":"3. \u4e0b\u8f7d\u5931\u8d25","text":"Bash<pre><code># \u4f7f\u7528\u4ee3\u7406\u6216\u955c\u50cf\u6e90\n# \u4e2d\u56fd\u7528\u6237\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u955c\u50cf\u6e90\nsudo curl -L \"https://get.daocloud.io/docker/compose/releases/download/v2.24.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#4-docker","title":"4. Docker\u8fde\u63a5\u95ee\u9898","text":"Bash<pre><code># \u68c0\u67e5Docker\u670d\u52a1\u72b6\u6001\nsudo systemctl status docker\n\n# \u68c0\u67e5\u7528\u6237\u662f\u5426\u5728docker\u7ec4\u4e2d\ngroups $USER\n\n# \u6dfb\u52a0\u7528\u6237\u5230docker\u7ec4\nsudo usermod -aG docker $USER\nnewgrp docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#5_1","title":"5. \u7248\u672c\u51b2\u7a81\u95ee\u9898","text":"Bash<pre><code># \u67e5\u770b\u6240\u6709docker-compose\u5b9e\u4f8b\nwhich -a docker-compose\n\n# \u5220\u9664\u51b2\u7a81\u7684\u7248\u672c\nsudo rm /usr/bin/docker-compose\npip3 uninstall docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_12","title":"\u6700\u4f73\u5b9e\u8df5","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#1_2","title":"1. \u9009\u62e9\u5408\u9002\u7684\u5b89\u88c5\u65b9\u5f0f","text":"<ul> <li>\u751f\u4ea7\u73af\u5883\uff1a\u63a8\u8350\u4f7f\u7528\u4e8c\u8fdb\u5236\u5b89\u88c5\u65b9\u5f0f\uff0c\u7248\u672c\u7a33\u5b9a\u53ef\u63a7</li> <li>\u5f00\u53d1\u73af\u5883\uff1a\u53ef\u4ee5\u4f7f\u7528pip\u5b89\u88c5\uff0c\u4fbf\u4e8e\u5347\u7ea7\u548c\u7ba1\u7406</li> <li>\u5feb\u901f\u6d4b\u8bd5\uff1a\u53ef\u4ee5\u4f7f\u7528\u5305\u7ba1\u7406\u5668\u5b89\u88c5</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#2_2","title":"2. \u7248\u672c\u7ba1\u7406","text":"Bash<pre><code># \u56fa\u5b9a\u7248\u672c\u53f7\uff0c\u907f\u514d\u610f\u5916\u5347\u7ea7\nCOMPOSE_VERSION=\"v2.24.1\"\nsudo curl -L \"https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#3_2","title":"3. \u81ea\u52a8\u8865\u5168\uff08\u53ef\u9009\uff09","text":"Bash<pre><code># \u4e0b\u8f7d\u8865\u5168\u811a\u672c\nsudo curl -L https://raw.githubusercontent.com/docker/compose/master/contrib/completion/bash/docker-compose -o /etc/bash_completion.d/docker-compose\n\n# \u91cd\u65b0\u52a0\u8f7dbash\u8865\u5168\nsource /etc/bash_completion.d/docker-compose\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/compose%E9%83%A8%E7%BD%B2/#_13","title":"\u76f8\u5173\u94fe\u63a5","text":"<ul> <li>Docker Compose \u5b98\u65b9\u6587\u6863</li> <li>Docker Compose GitHub\u4ed3\u5e93</li> <li>Docker Compose \u6587\u4ef6\u53c2\u8003</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/","title":"Docker\u90e8\u7f72","text":"<p>\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u5728\u4e0d\u540cLinux\u53d1\u884c\u7248\u4e0a\u8fdb\u884cDocker\u7684\u5728\u7ebf\u5b89\u88c5\u90e8\u7f72\u3002</p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#centosred-hat","title":"CentOS/Red Hat \u73af\u5883","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_1","title":"\u7cfb\u7edf\u8981\u6c42","text":"<ul> <li>CentOS 7+ \u6216 Red Hat Enterprise Linux 7+</li> <li>64\u4f4d\u7cfb\u7edf</li> <li>\u5185\u6838\u7248\u672c 3.10 \u6216\u66f4\u9ad8</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_2","title":"\u5378\u8f7d\u65e7\u7248\u672c\uff08\u5982\u679c\u5b58\u5728\uff09","text":"Bash<pre><code>yum remove docker \\\n                docker-client \\\n                docker-client-latest \\\n                docker-common \\\n                docker-latest \\\n                docker-latest-logrotate \\\n                docker-logrotate \\\n                docker-engine\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_3","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#1","title":"1. \u5b89\u88c5\u4f9d\u8d56\u5305","text":"Bash<pre><code>yum install -y yum-utils device-mapper-persistent-data lvm2\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#2-docker","title":"2. \u6dfb\u52a0Docker\u5b98\u65b9\u4ed3\u5e93","text":"Bash<pre><code>yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#3-docker-ce","title":"3. \u5b89\u88c5Docker CE","text":"Bash<pre><code># \u5b89\u88c5\u6700\u65b0\u7248\u672c\nyum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# \u6216\u5b89\u88c5\u6307\u5b9a\u7248\u672c\uff08\u53ef\u9009\uff09\n# yum list docker-ce --showduplicates | sort -r\n# yum install -y docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#4-docker","title":"4. \u542f\u52a8Docker\u670d\u52a1","text":"Bash<pre><code># \u542f\u52a8Docker\nsystemctl start docker\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsystemctl enable docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#5","title":"5. \u914d\u7f6e\u7528\u6237\u6743\u9650\uff08\u53ef\u9009\uff09","text":"Bash<pre><code># \u5c06\u5f53\u524d\u7528\u6237\u6dfb\u52a0\u5230docker\u7ec4\nusermod -aG docker $USER\n\n# \u91cd\u65b0\u767b\u5f55\u6216\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f7f\u6743\u9650\u751f\u6548\nnewgrp docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#ubuntudebian","title":"Ubuntu/Debian \u73af\u5883","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_4","title":"\u7cfb\u7edf\u8981\u6c42","text":"<ul> <li>Ubuntu 20.04 LTS+ \u6216 Debian 10+</li> <li>64\u4f4d\u7cfb\u7edf</li> <li>\u5185\u6838\u7248\u672c 3.10 \u6216\u66f4\u9ad8</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_5","title":"\u5378\u8f7d\u65e7\u7248\u672c\uff08\u5982\u679c\u5b58\u5728\uff09","text":"Bash<pre><code>apt-get remove docker docker-engine docker.io containerd runc\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_6","title":"\u5b89\u88c5\u6b65\u9aa4","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#1_1","title":"1. \u66f4\u65b0\u5305\u7d22\u5f15","text":"Bash<pre><code>apt-get update\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#2","title":"2. \u5b89\u88c5\u4f9d\u8d56\u5305","text":"Bash<pre><code>apt-get install -y \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#3-dockergpg","title":"3. \u6dfb\u52a0Docker\u5b98\u65b9GPG\u5bc6\u94a5","text":"Bash<pre><code># \u521b\u5efa\u5bc6\u94a5\u76ee\u5f55\nmkdir -m 0755 -p /etc/apt/keyrings\n\n# \u4e0b\u8f7d\u5e76\u6dfb\u52a0GPG\u5bc6\u94a5\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#4-docker_1","title":"4. \u6dfb\u52a0Docker\u4ed3\u5e93","text":"Bash<pre><code># Ubuntu\u7cfb\u7edf\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  $(lsb_release -cs) stable\" | tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\n# Debian\u7cfb\u7edf\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \\\n  $(lsb_release -cs) stable\" | tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#5_1","title":"5. \u66f4\u65b0\u5305\u7d22\u5f15","text":"Bash<pre><code>apt-get update\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#6-docker-ce","title":"6. \u5b89\u88c5Docker CE","text":"Bash<pre><code># \u5b89\u88c5\u6700\u65b0\u7248\u672c\napt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# \u6216\u5b89\u88c5\u6307\u5b9a\u7248\u672c\uff08\u53ef\u9009\uff09\n# apt-cache madison docker-ce\n# apt-get install -y docker-ce=&lt;VERSION_STRING&gt; docker-ce-cli=&lt;VERSION_STRING&gt; containerd.io\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#7-docker","title":"7. \u542f\u52a8Docker\u670d\u52a1","text":"Bash<pre><code># Docker\u901a\u5e38\u4f1a\u81ea\u52a8\u542f\u52a8\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u624b\u52a8\u542f\u52a8\nsystemctl start docker\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsystemctl enable docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#8","title":"8. \u914d\u7f6e\u7528\u6237\u6743\u9650\uff08\u53ef\u9009\uff09","text":"Bash<pre><code># \u5c06\u5f53\u524d\u7528\u6237\u6dfb\u52a0\u5230docker\u7ec4\nusermod -aG docker $USER\n\n# \u91cd\u65b0\u767b\u5f55\u6216\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f7f\u6743\u9650\u751f\u6548\nnewgrp docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_7","title":"\u9a8c\u8bc1\u5b89\u88c5","text":"<p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u9a8c\u8bc1Docker\u662f\u5426\u6b63\u786e\u5b89\u88c5\uff1a</p> Bash<pre><code># \u67e5\u770bDocker\u7248\u672c\ndocker --version\n\n# \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\ndocker info\n\n# \u8fd0\u884cHello World\u6d4b\u8bd5\u5bb9\u5668\ndocker run hello-world\n</code></pre> <p>\u5982\u679c\u770b\u5230\u7c7b\u4f3c\u4ee5\u4e0b\u8f93\u51fa\uff0c\u8bf4\u660e\u5b89\u88c5\u6210\u529f\uff1a Text Only<pre><code>Hello from Docker!\nThis message shows that your installation appears to be working correctly.\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_8","title":"\u5e38\u7528\u914d\u7f6e","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_9","title":"\u914d\u7f6e\u955c\u50cf\u52a0\u901f\u5668\uff08\u63a8\u8350\uff09","text":"<p>\u521b\u5efa\u6216\u7f16\u8f91Docker\u914d\u7f6e\u6587\u4ef6\uff1a Bash<pre><code>mkdir -p /etc/docker\ntee /etc/docker/daemon.json &lt;&lt;-'EOF'\n{\n  \"registry-mirrors\": [\n    \"https://docker.m.daocloud.io\",\n    \"http://docker.1panel.live\",\n    \"https://docker.agsv.top\",\n    \"https://docker.agsvpt.work\",\n    \"https://dockerpull.com\",\n    \"https://dockerproxy.cn\"\n  ],\n  \"debug\": false,\n  \"insecure-registries\": [\n    \"0.0.0.0/0\"\n  ],\n  \"ip-forward\": true,\n  \"ipv6\": false,\n  \"live-restore\": true,\n  \"log-driver\": \"json-file\",\n  \"log-level\": \"warn\",\n  \"log-opts\": {\n    \"max-size\": \"100m\",\n    \"max-file\": \"2\"\n  },\n  \"selinux-enabled\": false,\n  \"experimental\": true,\n  \"storage-driver\": \"overlay2\",\n  \"data-root\": \"/data/docker_dir\",\n  \"default-ulimits\": {\n    \"nofile\": {\n      \"Name\": \"nofile\",\n      \"Hard\": 65536,\n      \"Soft\": 65536\n    }\n  },\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"]\n}\nEOF\n</code></pre></p> <p>\u91cd\u542fDocker\u670d\u52a1\uff1a Bash<pre><code>systemctl daemon-reload\nsystemctl restart docker\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#docker_1","title":"\u914d\u7f6eDocker\u5f00\u673a\u81ea\u542f","text":"Bash<pre><code>systemctl enable docker\n</code></pre>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_10","title":"\u6545\u969c\u6392\u9664","text":"","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#1_2","title":"1. \u6743\u9650\u95ee\u9898","text":"<p>\u5982\u679c\u51fa\u73b0\u6743\u9650\u9519\u8bef\uff0c\u786e\u4fdd\u7528\u6237\u5df2\u6dfb\u52a0\u5230docker\u7ec4\uff1a Bash<pre><code>usermod -aG docker $USER\n# \u7136\u540e\u91cd\u65b0\u767b\u5f55\u6216\u6267\u884c newgrp docker\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#2_1","title":"2. \u670d\u52a1\u542f\u52a8\u5931\u8d25","text":"<p>\u68c0\u67e5Docker\u670d\u52a1\u72b6\u6001\uff1a Bash<pre><code>systemctl status docker\njournalctl -u docker.service\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#3","title":"3. \u7f51\u7edc\u95ee\u9898","text":"<p>\u5982\u679c\u65e0\u6cd5\u62c9\u53d6\u955c\u50cf\uff0c\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\u548c\u9632\u706b\u5899\u8bbe\u7f6e\uff1a Bash<pre><code># \u6d4b\u8bd5\u7f51\u7edc\u8fde\u63a5\ncurl -I https://index.docker.io/\n\n# \u68c0\u67e5\u9632\u706b\u5899\u72b6\u6001\nsystemctl status firewalld  # CentOS/RHEL\nufw status                  # Ubuntu/Debian\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#4","title":"4. \u5b58\u50a8\u9a71\u52a8\u95ee\u9898","text":"<p>\u67e5\u770b\u5f53\u524d\u4f7f\u7528\u7684\u5b58\u50a8\u9a71\u52a8\uff1a Bash<pre><code>docker info | grep \"Storage Driver\"\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#5_2","title":"5. \u6e05\u7406\u7cfb\u7edf\u8d44\u6e90","text":"<p>\u5982\u679c\u9700\u8981\u6e05\u7406\u672a\u4f7f\u7528\u7684\u8d44\u6e90\uff1a Bash<pre><code># \u6e05\u7406\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u3001\u7f51\u7edc\u3001\u955c\u50cf\ndocker system prune\n\n# \u6e05\u7406\u6240\u6709\u672a\u4f7f\u7528\u7684\u8d44\u6e90\uff08\u5305\u62ec\u672a\u4f7f\u7528\u7684\u955c\u50cf\uff09\ndocker system prune -af\n</code></pre></p>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"02-%E5%AE%B9%E5%99%A8%E5%8C%96/docker%E9%83%A8%E7%BD%B2/#_11","title":"\u76f8\u5173\u94fe\u63a5","text":"<ul> <li>Docker\u5b98\u65b9\u6587\u6863</li> <li>Docker Hub</li> <li>Docker Compose\u6587\u6863</li> </ul>","tags":["\u5bb9\u5668\u5316","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/","title":"03-\u5e94\u7528\u670d\u52a1","text":""},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/JAVA%E5%90%8E%E7%AB%AF/","title":"JAVA\u540e\u7aef","text":"","tags":["JAVA\u540e\u7aef","\u540e\u7aef","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/JAVA%E5%90%8E%E7%AB%AF/#dockerfile","title":"Dockerfile \u6a21\u677f","text":"Docker<pre><code>ARG HARBOR_HOST\nARG BASE_IMAGE_TAG\n\nFROM ${HARBOR_HOST}/library/java-local:${BASE_IMAGE_TAG}\n\nWORKDIR /app\n\n# \u6784\u5efa\u53c2\u6570\nARG SERVICE_NAME\nARG PROJECT_ROOT_DIR=demo-sys\n\n# \u590d\u5236\u5bf9\u5e94\u670d\u52a1\u7684 JAR \u6587\u4ef6\uff08\u652f\u6301\u4e0d\u540c\u7684\u9879\u76ee\u6839\u76ee\u5f55\uff09\nCOPY ${PROJECT_ROOT_DIR}/${SERVICE_NAME}/target/${SERVICE_NAME}-*.jar app.jar\n\n# \u73af\u5883\u53d8\u91cf\nENV SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR=localhost:8848 \\\n    SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR=localhost:8848 \\\n    SPRING_CLOUD_NACOS_DISCOVERY_NAMESPACE=public \\\n    SPRING_CLOUD_NACOS_CONFIG_NAMESPACE=public \\\n    SPRING_CLOUD_NACOS_DISCOVERY_IP=localhost \\\n    SPRING_CLOUD_NACOS_USERNAME=nacos \\\n    SPRING_CLOUD_NACOS_PASSWORD=nacos \\\n    JAVA_OPTS=\"-Xms512m -Xmx1024m -Duser.timezone=Asia/Shanghai\"\n\n\nARG APP_PORT=8080\nENV APP_PORT=${APP_PORT}\n\n# \u542f\u52a8\u547d\u4ee4\nENTRYPOINT [\"sh\", \"-c\", \"exec java ${JAVA_OPTS} -jar app.jar --server.port=${APP_PORT}\"]\n</code></pre>","tags":["JAVA\u540e\u7aef","\u540e\u7aef","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/JAVA%E5%90%8E%E7%AB%AF/#compose","title":"Compose \u6a21\u677f","text":"YAML<pre><code>x-common-config: &amp;common-config\n  extra_hosts:\n    - \"localhost.localdomain:127.0.0.1\"\n  volumes:\n    - \"/etc/localtime:/etc/localtime:ro\"\n  restart: always\n  networks:\n    - apps\n\nservices:\n  sys-gateway:\n    &lt;&lt;: *common-config\n    image: \"demo/prod/sys-gateway:latest\"\n    container_name: sys-gateway\n    ports:\n      - \"38099:8099\"\n    environment:\n      SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_NAMESPACE: public\n      SPRING_CLOUD_NACOS_CONFIG_NAMESPACE: public\n      SPRING_CLOUD_NACOS_DISCOVERY_IP: 127.0.0.1\n      SPRING_CLOUD_NACOS_USERNAME: nacos\n      SPRING_CLOUD_NACOS_PASSWORD: 8dS3^aZ.\n      SPRING_CLOUD_NACOS_DISCOVERY_GRPC_PORT: 9848\n      SPRING_CLOUD_NACOS_DISCOVERY_PORT: 38099\n\n  sys-system:\n    &lt;&lt;: *common-config\n    image: \"demo/prod/sys-system:latest\"\n    container_name: sys-system\n    ports:\n      - \"38189:8189\"\n    environment:\n      SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_NAMESPACE: public\n      SPRING_CLOUD_NACOS_CONFIG_NAMESPACE: public\n      SPRING_CLOUD_NACOS_DISCOVERY_IP: 127.0.0.1\n      SPRING_CLOUD_NACOS_USERNAME: nacos\n      SPRING_CLOUD_NACOS_PASSWORD: 8dS3^aZ.\n      SPRING_CLOUD_NACOS_DISCOVERY_GRPC_PORT: 9848\n      SPRING_CLOUD_NACOS_DISCOVERY_PORT: 38189\n\n  sys-auth:\n    &lt;&lt;: *common-config\n    image: \"demo/prod/sys-auth:latest\"\n    container_name: sys-auth\n    ports:\n      - \"38102:8102\"\n    environment:\n      SPRING_CLOUD_NACOS_CONFIG_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_SERVER_ADDR: 127.0.0.1:8848\n      SPRING_CLOUD_NACOS_DISCOVERY_NAMESPACE: public\n      SPRING_CLOUD_NACOS_CONFIG_NAMESPACE: public\n      SPRING_CLOUD_NACOS_DISCOVERY_IP: 127.0.0.1\n      SPRING_CLOUD_NACOS_USERNAME: nacos\n      SPRING_CLOUD_NACOS_PASSWORD: 8dS3^aZ.\n      SPRING_CLOUD_NACOS_DISCOVERY_GRPC_PORT: 9848\n      SPRING_CLOUD_NACOS_DISCOVERY_PORT: 38102\n\nnetworks:\n  apps:\n    driver: bridge\n</code></pre>","tags":["JAVA\u540e\u7aef","\u540e\u7aef","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/","title":"\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93\u90e8\u7f72","text":"<p>\u672c\u6587\u6863\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 Docker Compose \u90e8\u7f72\u5e38\u7528\u7684\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93\uff0c\u5305\u62ec\u670d\u52a1\u6ce8\u518c\u53d1\u73b0\u3001\u6d88\u606f\u961f\u5217\u3001\u6570\u636e\u5e93\u3001\u641c\u7d22\u5f15\u64ce\u7b49\u6838\u5fc3\u7ec4\u4ef6\u3002\u6240\u6709\u670d\u52a1\u90fd\u91c7\u7528\u5f00\u6e90\u955c\u50cf\uff0c\u4fbf\u4e8e\u5feb\u901f\u642d\u5efa\u5f00\u53d1\u548c\u6d4b\u8bd5\u73af\u5883\u3002</p>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#nginx","title":"Nginx","text":"<p>Nginx \u4f5c\u4e3a\u9ad8\u6027\u80fd\u7684 Web \u670d\u52a1\u5668\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u662f\u5fae\u670d\u52a1\u67b6\u6784\u4e2d\u7684\u91cd\u8981\u7ec4\u4ef6\u3002</p> YAML<pre><code>services:\n  nginx:\n   image: nginx:1.28.0-alpine\n   container_name: nginx\n   ports:\n     - \"80:80\"\n    #  - \"443:443\"\n   environment:\n     - TZ=Asia/Shanghai\n   healthcheck:\n     test: [\"CMD\", \"nginx\", \"-t\"]\n     interval: 30s\n     timeout: 10s\n     retries: 3\n   volumes:\n      - ./conf/mime.types:/etc/nginx/mime.types:ro\n      - ./conf/nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./conf/web.conf:/etc/nginx/conf.d/default.conf:ro\n     - ./data/nginx/certs:/etc/ssl/private:ro\n     - ./data/nginx/html:/usr/share/nginx/html\n     - ./data/nginx/logs:/var/log/nginx:rw\n   restart: always\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_2","title":"\u914d\u7f6e\u6587\u4ef6","text":"\u914d\u7f6e\u6587\u4ef6 \u8bf4\u660e \u4e0b\u8f7d\u94fe\u63a5 mime.types Nginx \u914d\u7f6e\u6587\u4ef6\uff0c\u5b9a\u4e49 MIME \u7c7b\u578b  \u4e0b\u8f7d nginx.conf Nginx \u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u5b9a\u4e49\u670d\u52a1\u5668\u548c\u53cd\u5411\u4ee3\u7406  \u4e0b\u8f7d web.conf Nginx \u4e1a\u52a1\u914d\u7f6e\u6587\u4ef6\uff0c\u5b9a\u4e49\u7f51\u7ad9\u7684\u53cd\u5411\u4ee3\u7406  \u4e0b\u8f7d","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_3","title":"\u5176\u4ed6\u914d\u7f6e","text":"<p>Portainer\u4ee3\u7406\u914d\u7f6e</p> Nginx Configuration File<pre><code>        # Portainer\u4ee3\u7406\u914d\u7f6e\n        location /portainer {\n            # \u91cd\u5b9a\u5411\u5230\u4e0d\u5e26\u5c3e\u90e8\u659c\u6760\u7684\u8def\u5f84\n            return 301 http://$host:$server_port/portainer/;\n        }\n\n        location /portainer/ {\n            # \u79fb\u9664\u8def\u5f84\u524d\u7f00\uff0c\u76f4\u63a5\u4ee3\u7406\u5230\u6839\u8def\u5f84\n            rewrite ^/portainer/(.*)$ /$1 break;\n            proxy_pass http://127.0.0.1:9000/;\n            proxy_http_version 1.1;\n\n            # \u4fee\u590dCSRF\u95ee\u9898\u7684\u4ee3\u7406\u5934\u914d\u7f6e\n            proxy_set_header Host 127.0.0.1:9000;  # \u8bbe\u7f6e\u4e3a\u540e\u7aef\u5b9e\u9645\u5730\u5740\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $host:$server_port;  # \u5305\u542b\u7aef\u53e3\u4fe1\u606f\n            proxy_set_header X-Forwarded-Port $server_port;\n            proxy_set_header Origin http://127.0.0.1:9000;    # \u8bbe\u7f6e\u6b63\u786e\u7684Origin\n            proxy_set_header Referer http://127.0.0.1:9000/;  # \u8bbe\u7f6e\u6b63\u786e\u7684Referer\n\n            # WebSocket\u652f\u6301\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n\n            # \u7f13\u51b2\u8bbe\u7f6e\n            proxy_buffering off;\n            proxy_cache off;\n\n            # \u8d85\u65f6\u8bbe\u7f6e\n            proxy_connect_timeout 1800s;\n            proxy_send_timeout 1800s;\n            proxy_read_timeout 1800s;\n\n            # \u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236\n            client_max_body_size 50000M;\n\n            # \u5904\u7406\u91cd\u5b9a\u5411 - \u5c06\u540e\u7aef\u7684\u91cd\u5b9a\u5411URL\u4fee\u6539\u4e3a\u5305\u542b\u524d\u7f00\u7684URL\n            proxy_redirect ~^/(.*)$ /portainer/$1;\n            proxy_redirect / /portainer/;\n        }\n</code></pre> <p>pgAdmin\u4ee3\u7406\u914d\u7f6e</p> Nginx Configuration File<pre><code>        # pgAdmin\u4ee3\u7406\u914d\u7f6e\n        location /pgadmin/ {\n            proxy_pass http://127.0.0.1:8080/;\n            proxy_http_version 1.1;\n\n            # \u57fa\u672c\u4ee3\u7406\u5934\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $host;\n            proxy_set_header X-Forwarded-Port $server_port;\n            proxy_set_header X-Script-Name /pgadmin;\n\n            # WebSocket\u652f\u6301\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n\n            # \u7f13\u51b2\u8bbe\u7f6e\n            proxy_buffering off;\n            proxy_cache off;\n\n            # \u8d85\u65f6\u8bbe\u7f6e\n            proxy_connect_timeout 1800s;\n            proxy_send_timeout 1800s;\n            proxy_read_timeout 1800s;\n\n            # \u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236\n            client_max_body_size 2000M;\n\n            # \u5904\u7406\u91cd\u5b9a\u5411\n            proxy_redirect off;\n        }\n\n\n        # pgAdmin\u9759\u6001\u6587\u4ef6\u5904\u7406\n        location ~* ^/pgadmin/.*\\.(js|css|png|jpg|jpeg|gif|ico|svg)$ {\n            proxy_pass http://127.0.0.1:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Script-Name /pgadmin;\n            expires 1M;\n            add_header Cache-Control \"public, immutable\";\n        }\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_4","title":"\u8bc1\u4e66\u751f\u6210","text":"<p>\u5982\u679c\u6709\u57df\u540d\uff0c\u53ef\u4ee5\u4f7f\u7528 Let's Encrypt \u751f\u6210\u514d\u8d39\u7684 SSL \u8bc1\u4e66\u3002</p> <p>Bash<pre><code>certbot certonly --standalone -d example.com --email your-email@example.com --agree-tos\n# \u5c06\u751f\u6210\u7684\u8bc1\u4e66\u548c\u79c1\u94a5\u590d\u5236\u5230 Nginx \u914d\u7f6e\u76ee\u5f55\u4e2d\u3002\ncp /etc/letsencrypt/live/example.com/fullchain.pem ./data/nginx/certs/\ncp /etc/letsencrypt/live/example.com/privkey.pem ./data/nginx/certs/\n</code></pre> \u5982\u679c\u6ca1\u6709\u57df\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7openssl \u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002 Bash<pre><code>openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout ./data/nginx/certs/selfsigned.key -out ./data/nginx/certs/selfsigned.crt\n</code></pre></p>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#nacos","title":"Nacos","text":"<p>Nacos \u662f\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u7684\u670d\u52a1\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u548c\u670d\u52a1\u7ba1\u7406\u5e73\u53f0\u3002</p> YAML<pre><code>services:\n  nacos:\n    image: nacos-server:v3.0.1\n    container_name: nacos\n    ports:\n      - \"8848:8848\"  # Server API port  #(1)!\n      - \"9848:9848\"  # gRPC port\n      - \"9849:9849\"  # gRPC config port\n      - \"7848:7848\"  # Raft port\n      - \"8080:8080\"  # Console port (v3 only, safe to expose for v2) #(2)!\n    env_file:\n      - ./conf/nacos-standlone.env\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - ./conf/nacos-application.properties:/home/nacos/conf/application.properties\n      - ./data/nacos/data/:/home/nacos/data\n      - ./data/nacos/logs/:/home/nacos/logs\n    healthcheck:\n      test: [\"CMD-SHELL\", \"curl -f http://localhost:8080/nacos/ || curl -f http://localhost:8848/nacos/\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 60s\n    restart: always\n</code></pre> <ol> <li> <p>8848 \u7aef\u53e3\u4e3a Nacos V2 \u670d\u52a1\u7aef API \u7aef\u53e3\uff0c\u7528\u4e8e\u5ba2\u6237\u7aef\u8c03\u7528\u3002</p> </li> <li> <p>8080 \u7aef\u53e3\u4e3a Nacos V3 \u63a7\u5236\u53f0\u7aef\u53e3\uff0c\u7528\u4e8e\u7ba1\u7406\u914d\u7f6e\u548c\u670d\u52a1\u3002</p> </li> </ol>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_5","title":"\u914d\u7f6e\u6587\u4ef6","text":"\u914d\u7f6e\u6587\u4ef6 \u8bf4\u660e \u4e0b\u8f7d\u94fe\u63a5 nacos-standlone.env Nacos \u914d\u7f6e\u6587\u4ef6\uff0c\u5b9a\u4e49\u73af\u5883\u53d8\u91cf  \u4e0b\u8f7d nacos-application.properties Nacos \u914d\u7f6e\u6587\u4ef6\uff0c\u5b9a\u4e49\u5e94\u7528\u5c5e\u6027  \u4e0b\u8f7d","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#minio","title":"MinIO","text":"<p>MinIO \u662f\u9ad8\u6027\u80fd\u7684\u5206\u5e03\u5f0f\u5bf9\u8c61\u5b58\u50a8\u7cfb\u7edf\uff0c\u517c\u5bb9 Amazon S3 API\u3002</p>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#http","title":"HTTP \u6a21\u5f0f","text":"YAML<pre><code>services:\n  minio: \n    image: minio:RELEASE.2025-07-23T15-54-02Z\n    container_name: minio\n    ports:\n      - \"9000:9000\"\n      - \"9001:9001\"\n    command: server /data --console-address \":9001\"\n    environment:\n      MINIO_ROOT_USER: 'admin'\n      MINIO_ROOT_PASSWORD: 'm3VeRe8a'\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:9000/minio/health/live\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 30s\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - ./data/minio/data:/data\n    restart: always\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#https","title":"HTTPS \u6a21\u5f0f","text":"Warning <p>\u8bc1\u4e66\u547d\u540d\u9700\u8981\u4e3a private.key \u548c public.crt \uff0c\u5426\u5219\u53ef\u80fd\u65e0\u6cd5\u6b63\u5e38\u751f\u6548</p> YAML<pre><code>services:\n  minio: \n    image: minio:RELEASE.2025-07-23T15-54-02Z\n    container_name: minio\n    ports:\n      - \"9000:9000\"  # HTTPS API\n      - \"9001:9001\"  # HTTPS Console\n    command: server /data --console-address \":9001\" --certs-dir /certs\n    environment:\n      MINIO_ROOT_USER: 'admin'\n      MINIO_ROOT_PASSWORD: 'm3VeRe8a'\n      MINIO_SERVER_URL: \"https://&lt;ipaddr&gt;:9000\" \n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - ./data/minio/data:/data\n      - ./certs:/certs  # \u6302\u8f7d\u8bc1\u4e66\u76ee\u5f55\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-k\", \"-f\", \"https://localhost:9000/minio/health/live\"]  \n      interval: 30s\n      timeout: 10s\n      retries: 3\n    restart: always\n</code></pre> <p>\u901a\u8fc7\u4e0b\u9762\u547d\u4ee4\u751f\u6210\u81ea\u5b9a\u4e49 SSL \u8bc1\u4e66\u3002</p> Bash<pre><code># \u521b\u5efa\u8bc1\u4e66\u76ee\u5f55\nmkdir -p ./certs  &amp;&amp; cd ./certs\n\n# \u751f\u6210\u79c1\u94a5 (\u5fc5\u987b\u547d\u540d\u4e3a private.key)\nopenssl genrsa -out private.key 2048\n\n# \u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66 (\u5fc5\u987b\u547d\u540d\u4e3a public.crt)\nopenssl req -new -x509 -key private.key -sha256 -days 365 -out public.crt \\\n  -subj \"/C=CN/ST=Beijing/L=Beijing/O=YourOrg/CN=183.237.186.226\" \\\n  -addext \"subjectAltName=IP:&lt;ipaddr&gt;,IP:127.0.0.1,DNS:localhost,DNS:&lt;domain&gt;\"   #(1)!\n\n# \u8bbe\u7f6e\u6743\u9650\nchmod 600 private.key\nchmod 644 public.crt\n\n# \u9a8c\u8bc1\u8bc1\u4e66\nopenssl x509 -in public.crt -text -noout | grep -A 5 \"Subject Alternative Name\"\n</code></pre> <ol> <li>\u8981\u5c06\u8fd9\u91cc\u7684 <code>&lt;ipaddr&gt;</code> / <code>&lt;domain&gt;</code> \u66ff\u6362\u4e3a\u81ea\u5df1\u5b9e\u9645\u7684 IP \u5730\u5740\u548c\u57df\u540d\u3002</li> </ol>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_6","title":"\u540c\u6b65\u590d\u5236","text":"<p>MinIO \u652f\u6301\u6570\u636e\u540c\u6b65\u590d\u5236\uff0c\u786e\u4fdd\u6570\u636e\u7684\u9ad8\u53ef\u7528\u6027\u548c\u5197\u4f59\u6027\u3002</p> Warning <p>\u540c\u6b65\u590d\u5236\u9700\u8981Minio \u5907\u4efd\u8282\u70b9\u5e94\u4e3a\u7a7a\u767d\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u5b8c\u6210\u6570\u636e\u540c\u6b65\u3002</p> <p>\u53e6\u5916\uff0c \u53ea\u6709Minio \u7248\u672c &lt; <code>v2025.05.xx</code> \u624d\u9ed8\u8ba4\u652f\u6301\uff0c\u540e\u9762\u7248\u672c\u529f\u80fd\u5df2\u88ab\u5b8c\u5168\u9609\u5272\u3002</p> YAML<pre><code>services:\n  minio-mc:\n    image: minio/mc:latest\n    container_name: minio-mc\n    environment:\n      SITE1_URL: http://&lt;SITE1_IP&gt;:9000\n      SITE2_URL: http://&lt;SITE2_IP&gt;:9000\n      MINIO_ACCESS_KEY: \"${MINIO_ROOT_USER}\"\n      MINIO_SECRET_KEY: \"${MINIO_ROOT_PASSWORD}\"\n    volumes:\n      - ./scripts/site-replication.sh:/site-replication.sh\n    entrypoint: [\"/bin/bash\", \"/site-replication.sh\"]\n    restart: on-failure\n</code></pre> \u811a\u672c\u6587\u4ef6 \u8bf4\u660e \u4e0b\u8f7d\u94fe\u63a5 site-replication.sh \u540c\u6b65\u590d\u5236\u811a\u672c  \u4e0b\u8f7d","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#redis","title":"Redis","text":"<p>Redis \u662f\u9ad8\u6027\u80fd\u7684\u5185\u5b58\u6570\u636e\u7ed3\u6784\u5b58\u50a8\uff0c\u7528\u4f5c\u7f13\u5b58\u3001\u6d88\u606f\u4ee3\u7406\u548c\u6570\u636e\u5e93\u3002</p> YAML<pre><code>services:\n  redis:\n   image: redis:8.0.3\n   container_name: redis\n   ports:\n     - \"6379:6379\"\n   command: [ \"redis-server\", \"/usr/local/etc/redis/redis.conf\"]\n   volumes:\n     - /etc/localtime:/etc/localtime:ro\n     - ./conf/redis.conf:/usr/local/etc/redis/redis.conf\n     - ./data/redis/data:/data\n   privileged: true\n   healthcheck:\n     test: [\"CMD-SHELL\", \"redis-cli ping\"]\n     interval: 10s\n     timeout: 5s\n     retries: 3\n   restart: always\n</code></pre> \u914d\u7f6e\u6587\u4ef6 \u8bf4\u660e \u4e0b\u8f7d\u94fe\u63a5 redis.conf Redis \u914d\u7f6e\u6587\u4ef6  \u4e0b\u8f7d","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#rabbitmq","title":"RabbitMQ","text":"<p>RabbitMQ \u662f\u529f\u80fd\u5f3a\u5927\u7684\u6d88\u606f\u4ee3\u7406\uff0c\u652f\u6301\u591a\u79cd\u6d88\u606f\u4f20\u9012\u534f\u8bae\u3002</p> YAML<pre><code>services:\n  rabbitmq:\n   image: rabbitmq:4.1.2-management-alpine\n   container_name: rabbitmq\n   hostname: rabbitmq\n   ports:\n     - 5672:5672\n     - 15672:15672\n   environment:\n     TZ: Asia/Shanghai\n     RABBITMQ_DEFAULT_USER: \"admin\"\n     RABBITMQ_DEFAULT_PASS: \"feNop7N3\"\n   healthcheck:\n     test: [ \"CMD\", \"rabbitmqctl\", \"status\"]\n     interval: 5s\n     timeout: 20s\n     retries: 10\n   volumes:\n     - /etc/localtime:/etc/localtime:ro\n     - ./data/rabbitmq/data/:/var/lib/rabbitmq/\n   restart: always\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#postgresql","title":"PostgreSQL","text":"<p>PostgreSQL \u662f\u529f\u80fd\u5f3a\u5927\u7684\u5f00\u6e90\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff0c\u652f\u6301 PostGIS \u5730\u7406\u4fe1\u606f\u6269\u5c55\u3002</p> YAML<pre><code>services:\n  postgres:\n    image: freelabspace/postgresql-postgis:12.22\n    container_name: postgres-postgis\n    environment:\n      - TZ=Asia/Shanghai\n      - POSTGRES_DB=gis\n      - POSTGRES_USER=postgres\n      - POSTGRES_PASSWORD=5iQub9fo\n    ports:\n      - \"5433:5432\"\n    volumes:\n      - ./data/postgres/pgdata:/var/lib/postgresql/data\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"postgres\"]\n      interval: 30s\n      timeout: 30s\n      retries: 3\n      start_period: 5s\n    restart: unless-stopped\n    networks:\n      - pg\n\n  pg-backup:\n    image: freelabspace/postgresql-backup:latest\n    container_name: pg-backup\n    environment:\n      TZ: Asia/Shanghai\n      PG_HOST: postgres\n      PG_PORT: 5432\n      PG_USER: postgres\n      PG_PASSWORD: 5iQub9fo\n      PG_DATABASE: gis  # \u4f7f\u7528\u9017\u53f7\u5206\u9694\u591a\u4e2a\u6570\u636e\u5e93\n      BACKUP_RETENTION_DAYS: 7 # \u4fdd\u75597\u5929\n      BACKUP_TIME: \"03:00\"  # \u6bcf\u5929\u51cc\u66683\u70b9\u6267\u884c\uff0c24\u5c0f\u65f6\u5236\n      BACKUP_INTERVAL: daily  # \u5907\u4efd\u95f4\u9694\uff1adaily\uff08\u6bcf\u5929\uff09\u3001hourly\uff08\u6bcf\u5c0f\u65f6\uff09\u6216\u6570\u5b57\uff08\u6bcf\u9694\u591a\u5c11\u5206\u949f\uff09\n      ENABLE_COMPRESSION: \"true\" # \u542f\u7528\u538b\u7f29\n      BACKUP_FORMAT: \"both\"  # \u5907\u4efd\u683c\u5f0f: both\uff08\u540c\u65f6\u751f\u6210dump\u548csql\uff09\u3001dump\uff08\u4ec5dump\u683c\u5f0f\uff09\u3001sql\uff08\u4ec5sql\u683c\u5f0f\uff09\n      BACKUP_DIR: /backups\n    volumes:\n      - ./data/postgres/backups:/backups\n    depends_on:\n      postgres:\n        condition: service_healthy\n    restart: unless-stopped\n    networks:\n      - pg\n\nnetworks:\n  pg:\n    driver: bridge\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#elasticsearch","title":"Elasticsearch","text":"<p>Elasticsearch \u662f\u5206\u5e03\u5f0f\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce\uff0c\u9002\u7528\u4e8e\u5168\u6587\u641c\u7d22\u548c\u6570\u636e\u5206\u6790\u3002</p> YAML<pre><code>services:\n  elastic:\n   image: elasticsearch:9.0.4\n   container_name: elastic\n   environment:\n     TZ: Asia/Shanghai\n     ELASTIC_PASSWORD: p0y4REbA  \n     ES_JAVA_OPTS: \"-Xms2g -Xmx4g\" \n   ports:\n     - \"9200:9200\"\n   volumes:\n     - /etc/localtime:/etc/localtime:ro\n     - ./data/elastic/data:/usr/share/elasticsearch/data\n     - ./data/elastic/logs:/usr/share/elasticsearch/logs\n     - ./data/elastic/plugins:/usr/share/elasticsearch/plugins\n     - ./conf/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml\n   ulimits:\n     memlock:\n       soft: -1\n       hard: -1\n   restart: always\n</code></pre> \u914d\u7f6e\u6587\u4ef6 \u8bf4\u660e \u4e0b\u8f7d\u94fe\u63a5 elasticsearch.yml Elasticsearch \u914d\u7f6e\u6587\u4ef6  \u4e0b\u8f7d","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#geoserver","title":"GeoServer","text":"<p>GeoServer \u662f\u5f00\u6e90\u7684\u5730\u7406\u4fe1\u606f\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u53d1\u5e03\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002</p> YAML<pre><code>services:\n  geoserver:\n  image: kartoza/geoserver:2.27.1\n  container_name: geoserver\n  ports:\n    - \"8080:8080\"\n  environment:\n    TIMEZONE: 'Asia/Shanghai'\n    GEOSERVER_DATA_DIR: /opt/geoserver/data\n    GEOSERVER_ADMIN_USER: \"admin\"\n    GEOSERVER_ADMIN_PASSWORD: \"yoRiK02a\"\n  volumes:\n   - ./data/geoserver/data:/opt/geoserver/data\n  restart: always\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#_7","title":"\u90e8\u7f72\u8bf4\u660e","text":"","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#1","title":"1. \u73af\u5883\u51c6\u5907","text":"Bash<pre><code># \u521b\u5efa\u5fc5\u8981\u7684\u76ee\u5f55\u7ed3\u6784\nmkdir -p ./data/elastic/{data,logs,snapshots}\n\n# \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650\nchmod -R 775 ./data/elastic/plugins/\nmkdir -p     ./data/elastic/{data,logs,snapshots}\nchmod -R 775 ./data/elastic/\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#2","title":"2. \u542f\u52a8\u670d\u52a1","text":"Bash<pre><code># \u542f\u52a8\u6240\u6709\u670d\u52a1\ndocker-compose up -d\n\n# \u542f\u52a8\u6307\u5b9a\u670d\u52a1\ndocker-compose up -d nginx redis \n\n# \u67e5\u770b\u670d\u52a1\u72b6\u6001\ndocker-compose ps\n\n# \u67e5\u770b\u670d\u52a1\u65e5\u5fd7\ndocker-compose logs -f nacos\n</code></pre>","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"03-%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1/%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%BA%93/#3","title":"3. \u670d\u52a1\u8bbf\u95ee\u5730\u5740","text":"\u670d\u52a1 \u8bbf\u95ee\u5730\u5740 \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801 Nginx http://localhost - Nacos http://localhost:8848/nacos nacos/nacos MinIO http://localhost:9001 admin/lId5p4to RabbitMQ http://localhost:15672 admin/feNop7N3 Elasticsearch http://localhost:9200 elastic/p0y4REbA GeoServer http://localhost:8080/geoserver admin/yoRiK02a","tags":["\u4e2d\u95f4\u4ef6\u6570\u636e\u5e93","Linux","CentOS","Ubuntu","Debian","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"04-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/","title":"04-\u6570\u636e\u5b58\u50a8","text":""},{"location":"05-%E7%9B%91%E6%8E%A7%E5%91%8A%E8%AD%A6/","title":"05-\u76d1\u63a7\u544a\u8b66","text":""},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/","title":"\u5b89\u5168\u9632\u62a4\u4f53\u7cfb","text":"<p>\u73b0\u4ee3\u4f01\u4e1a\u7ea7IT\u57fa\u7840\u8bbe\u65bd\u9762\u4e34\u7740\u65e5\u76ca\u590d\u6742\u7684\u5b89\u5168\u5a01\u80c1\uff0c\u6784\u5efa\u591a\u5c42\u6b21\u3001\u5168\u65b9\u4f4d\u7684\u5b89\u5168\u9632\u62a4\u4f53\u7cfb\u5df2\u6210\u4e3a\u8fd0\u7ef4\u5de5\u4f5c\u7684\u91cd\u4e2d\u4e4b\u91cd\u3002\u672c\u7ae0\u8282\u5c06\u4e3a\u4f60\u63d0\u4f9b\u7cfb\u7edf\u5316\u7684\u5b89\u5168\u9632\u62a4\u7b56\u7565\u548c\u5b9e\u8df5\u6307\u5357\uff0c\u5e2e\u52a9\u4f60\u5efa\u7acb\u5b8c\u6574\u53ef\u9760\u7684\u4f01\u4e1a\u5b89\u5168\u9632\u62a4\u4f53\u7cfb\u3002</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_2","title":"\ud83d\udee1\ufe0f \u5b89\u5168\u9632\u62a4\u67b6\u6784","text":"<p>\u6211\u4eec\u7684\u5b89\u5168\u9632\u62a4\u4f53\u7cfb\u91c7\u7528 \u7eb5\u6df1\u9632\u5fa1 \u7b56\u7565\uff0c\u4ece\u591a\u4e2a\u7ef4\u5ea6\u6784\u5efa\u5b89\u5168\u9632\u62a4\uff1a</p> <pre><code>graph TB\n    A[\u5916\u90e8\u5a01\u80c1] --&gt; B[\u8fb9\u754c\u9632\u62a4]\n    B --&gt; C[\u7f51\u7edc\u5b89\u5168]\n    C --&gt; D[\u7cfb\u7edf\u52a0\u56fa]\n    D --&gt; E[\u5e94\u7528\u5b89\u5168]\n    E --&gt; F[\u6570\u636e\u5b89\u5168]\n\n    B --&gt; B1[\u9632\u706b\u5899\u89c4\u5219]\n    B --&gt; B2[\u5165\u4fb5\u68c0\u6d4b]\n\n    C --&gt; C1[\u7f51\u7edc\u5206\u6bb5]\n    C --&gt; C2[\u8bbf\u95ee\u63a7\u5236]\n\n    D --&gt; D1[SSH\u5b89\u5168]\n    D --&gt; D2[\u7cfb\u7edf\u52a0\u56fa]\n\n    E --&gt; E1[\u5bb9\u5668\u5b89\u5168]\n    E --&gt; E2[\u5e94\u7528\u9632\u62a4]\n\n    F --&gt; F1[\u6570\u636e\u52a0\u5bc6]\n    F --&gt; F2[\u5907\u4efd\u6062\u590d]</code></pre>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_3","title":"\ud83d\udcda \u6838\u5fc3\u5b89\u5168\u6a21\u5757","text":"","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_4","title":"\ud83d\udd10 \u7cfb\u7edf\u52a0\u56fa","text":"<p>\u57fa\u7840\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b89\u5168\u914d\u7f6e\u548c\u52a0\u56fa\u63aa\u65bd\uff0c\u662f\u6574\u4e2a\u5b89\u5168\u9632\u62a4\u7684\u57fa\u77f3\u3002</p> <p>\u4e3b\u8981\u5185\u5bb9\uff1a - \u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u57fa\u7ebf\u914d\u7f6e - \u7528\u6237\u6743\u9650\u7ba1\u7406\u548c\u8bbf\u95ee\u63a7\u5236 - \u7cfb\u7edf\u670d\u52a1\u5b89\u5168\u914d\u7f6e - \u5185\u6838\u53c2\u6570\u4f18\u5316 - \u5b89\u5168\u5ba1\u8ba1\u548c\u65e5\u5fd7\u914d\u7f6e</p> <p>\u5173\u952e\u6307\u6807\uff1a - \ud83c\udfaf \u51cf\u5c1195%\u4ee5\u4e0a\u4e0d\u5fc5\u8981\u7684\u7cfb\u7edf\u670d\u52a1 - \ud83c\udfaf \u5b9e\u73b0\u7ec6\u7c92\u5ea6\u7684\u7528\u6237\u6743\u9650\u63a7\u5236 - \ud83c\udfaf \u5efa\u7acb\u5b8c\u6574\u7684\u5b89\u5168\u5ba1\u8ba1\u8ffd\u8e2a</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#ssh","title":"\ud83d\udd11 SSH\u5b89\u5168","text":"<p>\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7b2c\u4e00\u9053\u9632\u7ebf\uff0c\u786e\u4fdd\u8fdc\u7a0b\u7ba1\u7406\u7684\u5b89\u5168\u6027\u3002</p> <p>\u4e3b\u8981\u5185\u5bb9\uff1a - SSH\u5bc6\u94a5\u8ba4\u8bc1\u914d\u7f6e - \u8bbf\u95ee\u63a7\u5236\u548c\u9650\u5236\u7b56\u7565 - SSH\u96a7\u9053\u548c\u7aef\u53e3\u8f6c\u53d1\u5b89\u5168 - \u591a\u56e0\u7d20\u8ba4\u8bc1(MFA)\u914d\u7f6e - SSH\u4f1a\u8bdd\u76d1\u63a7\u548c\u5ba1\u8ba1</p> <p>\u5b89\u5168\u8981\u6c42\uff1a - \u2705 \u7981\u7528\u5bc6\u7801\u767b\u5f55\uff0c\u5f3a\u5236\u5bc6\u94a5\u8ba4\u8bc1 - \u2705 \u9650\u5236\u767b\u5f55IP\u767d\u540d\u5355 - \u2705 \u5b9e\u65bd\u4f1a\u8bdd\u8d85\u65f6\u548c\u5e76\u53d1\u9650\u5236</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_5","title":"\ud83d\udd25 \u9632\u706b\u5899","text":"<p>\u7f51\u7edc\u8fb9\u754c\u9632\u62a4\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u63a7\u5236\u7f51\u7edc\u6d41\u91cf\u7684\u8fdb\u51fa\u3002</p> <p>\u4e3b\u8981\u5185\u5bb9\uff1a - iptables/netfilter\u89c4\u5219\u914d\u7f6e - UFW/firewalld\u7ba1\u7406 - \u7f51\u7edc\u5206\u6bb5\u548c\u9694\u79bb\u7b56\u7565 - \u5165\u4fb5\u68c0\u6d4b\u548c\u9632\u62a4(IDS/IPS) - DDoS\u9632\u62a4\u7b56\u7565</p> <p>\u9632\u62a4\u80fd\u529b\uff1a - \ud83d\udeab \u963b\u65ad99%\u4ee5\u4e0a\u7684\u6076\u610f\u7f51\u7edc\u8bf7\u6c42 - \ud83d\udd0d \u5b9e\u65f6\u76d1\u63a7\u7f51\u7edc\u5f02\u5e38\u884c\u4e3a - \u26a1 \u6beb\u79d2\u7ea7\u54cd\u5e94\u65f6\u95f4</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_6","title":"\ud83c\udf10 \u7f51\u7edc\u5b89\u5168","text":"<p>\u5168\u9762\u7684\u7f51\u7edc\u5c42\u5b89\u5168\u9632\u62a4\u7b56\u7565\uff0c\u4fdd\u969c\u7f51\u7edc\u901a\u4fe1\u5b89\u5168\u3002</p> <p>\u4e3b\u8981\u5185\u5bb9\uff1a - \u7f51\u7edc\u67b6\u6784\u5b89\u5168\u8bbe\u8ba1 - VLAN\u5206\u6bb5\u548cACL\u63a7\u5236 - VPN\u548c\u52a0\u5bc6\u901a\u4fe1 - DNS\u5b89\u5168\u548c\u9632\u52ab\u6301 - \u7f51\u7edc\u6d41\u91cf\u5206\u6790\u548c\u76d1\u63a7</p> <p>\u5b89\u5168\u76ee\u6807\uff1a - \ud83d\udd10 \u7aef\u5230\u7aef\u52a0\u5bc6\u901a\u4fe1 - \ud83c\udfaf \u7f51\u7edc\u96f6\u4fe1\u4efb\u67b6\u6784\u5b9e\u65bd - \ud83d\udcca \u5168\u6d41\u91cf\u53ef\u89c6\u5316\u76d1\u63a7</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_7","title":"\ud83d\udce6 \u5bb9\u5668\u5b89\u5168","text":"<p>\u73b0\u4ee3\u5bb9\u5668\u5316\u73af\u5883\u7684\u5b89\u5168\u9632\u62a4\uff0c\u9002\u5e94\u4e91\u539f\u751f\u67b6\u6784\u9700\u6c42\u3002</p> <p>\u4e3b\u8981\u5185\u5bb9\uff1a - Docker\u5bb9\u5668\u5b89\u5168\u914d\u7f6e - Kubernetes\u96c6\u7fa4\u5b89\u5168 - \u955c\u50cf\u5b89\u5168\u626b\u63cf\u548c\u7ba1\u7406 - \u5bb9\u5668\u8fd0\u884c\u65f6\u5b89\u5168\u76d1\u63a7 - \u5fae\u670d\u52a1\u5b89\u5168\u901a\u4fe1</p> <p>\u6838\u5fc3\u80fd\u529b\uff1a - \ud83d\udd12 \u5bb9\u5668\u955c\u50cf\u5b89\u5168\u57fa\u7ebf100%\u5408\u89c4 - \ud83d\udee1\ufe0f \u8fd0\u884c\u65f6\u5a01\u80c1\u5b9e\u65f6\u68c0\u6d4b - \ud83d\ude80 \u96f6\u505c\u673a\u5b89\u5168\u66f4\u65b0</p>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_8","title":"\ud83c\udfaf \u5b89\u5168\u9632\u62a4\u7b49\u7ea7","text":"<p>\u6839\u636e\u4e1a\u52a1\u91cd\u8981\u6027\u548c\u98ce\u9669\u7b49\u7ea7\uff0c\u6211\u4eec\u5c06\u5b89\u5168\u9632\u62a4\u5206\u4e3a\u4e09\u4e2a\u7b49\u7ea7\uff1a</p> \u7b49\u7ea7 \u9002\u7528\u573a\u666f \u9632\u62a4\u63aa\u65bd \u76d1\u63a7\u9891\u7387 \ud83d\udd34 \u5173\u952e\u7ea7 \u6838\u5fc3\u4e1a\u52a1\u7cfb\u7edf\u3001\u6570\u636e\u5e93 \u5168\u90e8\u5b89\u5168\u63aa\u65bd + \u989d\u5916\u52a0\u56fa \u5b9e\u65f6\u76d1\u63a7 \ud83d\udfe1 \u91cd\u8981\u7ea7 \u4e00\u822c\u4e1a\u52a1\u7cfb\u7edf\u3001\u5e94\u7528\u670d\u52a1 \u6807\u51c6\u5b89\u5168\u914d\u7f6e 5\u5206\u949f\u68c0\u67e5 \ud83d\udfe2 \u666e\u901a\u7ea7 \u5f00\u53d1\u6d4b\u8bd5\u73af\u5883 \u57fa\u7840\u5b89\u5168\u63aa\u65bd \u5c0f\u65f6\u7ea7\u76d1\u63a7","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_9","title":"\ud83d\udd27 \u5feb\u901f\u5b89\u5168\u68c0\u67e5","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5feb\u901f\u8bc4\u4f30\u7cfb\u7edf\u5b89\u5168\u72b6\u6001\uff1a</p> Bash<pre><code>#!/bin/bash\n# \u5feb\u901f\u5b89\u5168\u68c0\u67e5\u811a\u672c\n\necho \"=== \u7cfb\u7edf\u5b89\u5168\u5feb\u901f\u68c0\u67e5 ===\"\n\n# \u68c0\u67e5SSH\u914d\u7f6e\necho \"\ud83d\udd11 SSH\u5b89\u5168\u68c0\u67e5...\"\nif grep -q \"PasswordAuthentication no\" /etc/ssh/sshd_config; then\n    echo \"\u2705 SSH\u5bc6\u7801\u767b\u5f55\u5df2\u7981\u7528\"\nelse\n    echo \"\u274c SSH\u5bc6\u7801\u767b\u5f55\u672a\u7981\u7528\"\nfi\n\n# \u68c0\u67e5\u9632\u706b\u5899\u72b6\u6001\necho \"\ud83d\udd25 \u9632\u706b\u5899\u72b6\u6001\u68c0\u67e5...\"\nif systemctl is-active --quiet ufw || systemctl is-active --quiet firewalld; then\n    echo \"\u2705 \u9632\u706b\u5899\u5df2\u542f\u7528\"\nelse\n    echo \"\u274c \u9632\u706b\u5899\u672a\u542f\u7528\"\nfi\n\n# \u68c0\u67e5\u7cfb\u7edf\u66f4\u65b0\necho \"\ud83d\udce6 \u7cfb\u7edf\u66f4\u65b0\u68c0\u67e5...\"\nif [ -x \"$(command -v apt)\" ]; then\n    UPDATES=$(apt list --upgradable 2&gt;/dev/null | wc -l)\n    echo \"\ud83d\udcca \u53ef\u7528\u66f4\u65b0: $((UPDATES-1)) \u4e2a\"\nelif [ -x \"$(command -v yum)\" ]; then\n    UPDATES=$(yum check-update --quiet | wc -l)\n    echo \"\ud83d\udcca \u53ef\u7528\u66f4\u65b0: $UPDATES \u4e2a\"\nfi\n\necho \"=== \u68c0\u67e5\u5b8c\u6210 ===\"\n</code></pre>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_10","title":"\ud83d\udcc8 \u5b89\u5168\u76d1\u63a7\u6307\u6807","text":"","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#kpi","title":"\u5173\u952e\u5b89\u5168KPI","text":"<ul> <li>\u5165\u4fb5\u68c0\u6d4b\u547d\u4e2d\u7387: &gt; 99%</li> <li>\u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u65f6\u95f4: &lt; 5\u5206\u949f</li> <li>\u7cfb\u7edf\u6f0f\u6d1e\u4fee\u590d\u65f6\u95f4: &lt; 24\u5c0f\u65f6</li> <li>\u5b89\u5168\u5408\u89c4\u8fbe\u6210\u7387: &gt; 95%</li> </ul>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_11","title":"\u5b9e\u65f6\u76d1\u63a7\u9762\u677f","text":"Bash<pre><code># \u5b89\u5168\u72b6\u6001\u76d1\u63a7\u547d\u4ee4\nwatch -n 5 '\necho \"\ud83d\udd0d \u5b9e\u65f6\u5b89\u5168\u76d1\u63a7 - $(date)\"\necho \"\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\"\necho \"\ud83d\udd10 SSH\u8fde\u63a5: $(who | wc -l) \u4e2a\u6d3b\u8dc3\u4f1a\u8bdd\"\necho \"\ud83d\udd25 \u9632\u706b\u5899: $(iptables -L INPUT | grep -c DROP) \u6761\u62d2\u7edd\u89c4\u5219\"\necho \"\ud83d\udcbb CPU\u8d1f\u8f7d: $(uptime | awk -F\"load average:\" \"{print $2}\")\"\necho \"\ud83d\udcbe \u5185\u5b58\u4f7f\u7528: $(free | grep Mem | awk \"{printf \\\"%.1f%%\\\", $3/$2 * 100.0}\")\"\necho \"\ud83c\udf10 \u7f51\u7edc\u8fde\u63a5: $(netstat -an | grep ESTABLISHED | wc -l) \u4e2a\u6d3b\u8dc3\u8fde\u63a5\"\n'\n</code></pre>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_12","title":"\ud83d\ude80 \u5feb\u901f\u5165\u95e8","text":"<ol> <li>\u5f00\u59cb\u7cfb\u7edf\u52a0\u56fa \u2192 \u7cfb\u7edf\u52a0\u56fa\u6307\u5357</li> <li>\u914d\u7f6eSSH\u5b89\u5168 \u2192 SSH\u5b89\u5168\u914d\u7f6e </li> <li>\u8bbe\u7f6e\u9632\u706b\u5899 \u2192 \u9632\u706b\u5899\u914d\u7f6e\u6307\u5357</li> <li>\u52a0\u5f3a\u7f51\u7edc\u5b89\u5168 \u2192 \u7f51\u7edc\u5b89\u5168\u7b56\u7565</li> <li>\u4fdd\u62a4\u5bb9\u5668\u73af\u5883 \u2192 \u5bb9\u5668\u5b89\u5168\u5b9e\u8df5</li> </ol>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/#_13","title":"\ud83d\udcde \u5b89\u5168\u5e94\u6025\u8054\u7cfb","text":"<p>Warning</p> <p>\u5b89\u5168\u9632\u62a4\u662f\u4e00\u4e2a\u6301\u7eed\u7684\u8fc7\u7a0b\uff0c\u9700\u8981\u5b9a\u671f\u8bc4\u4f30\u3001\u66f4\u65b0\u548c\u4f18\u5316\u3002\u5efa\u8bae\u6bcf\u6708\u8fdb\u884c\u4e00\u6b21\u5168\u9762\u7684\u5b89\u5168\u68c0\u67e5\u548c\u914d\u7f6e\u5ba1\u6838\u3002</p> <p>\u9047\u5230\u5b89\u5168\u4e8b\u4ef6\u65f6\uff0c\u8bf7\u6309\u4ee5\u4e0b\u4f18\u5148\u7ea7\u5904\u7406\uff1a</p> <ol> <li>\ud83d\udea8 \u7d27\u6025\u5b89\u5168\u4e8b\u4ef6: \u7acb\u5373\u9694\u79bbaffected\u7cfb\u7edf\uff0c\u901a\u77e5\u5b89\u5168\u56e2\u961f</li> <li>\u26a0\ufe0f \u5b89\u5168\u6f0f\u6d1e\u53d1\u73b0: 24\u5c0f\u65f6\u5185\u8bc4\u4f30\u5f71\u54cd\uff0c\u5236\u5b9a\u4fee\u590d\u8ba1\u5212  </li> <li>\ud83d\udd0d \u5f02\u5e38\u884c\u4e3a\u68c0\u6d4b: 48\u5c0f\u65f6\u5185\u5b8c\u6210\u8c03\u67e5\u5206\u6790</li> </ol>","tags":["\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168","\u7f51\u7edc\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/","title":"SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#1-ssh","title":"1. SSH\u57fa\u7840\u5b89\u5168\u914d\u7f6e","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#11","title":"1.1 \u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3","text":"Bash<pre><code># \u5907\u4efd\u539f\u914d\u7f6e\u6587\u4ef6\ncp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup\n\n# \u4fee\u6539SSH\u7aef\u53e3\uff08\u907f\u514d\u4f7f\u752822\uff09\nvim /etc/ssh/sshd_config\n# \u4fee\u6539\u4ee5\u4e0b\u884c\uff1a\nPort 2222\n\n# \u5982\u679c\u542f\u7528\u4e86SELinux\uff0c\u9700\u8981\u6dfb\u52a0\u7aef\u53e3\u5230\u7b56\u7565\nsemanage port -a -t ssh_port_t -p tcp 2222\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n\n# \u9a8c\u8bc1\u65b0\u7aef\u53e3\u662f\u5426\u76d1\u542c\nss -tulnp | grep 2222\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#12","title":"1.2 \u7981\u7528\u4e0d\u5b89\u5168\u7684\u529f\u80fd","text":"Bash<pre><code># \u7f16\u8f91SSH\u914d\u7f6e\u6587\u4ef6\nvim /etc/ssh/sshd_config\n\n# \u6dfb\u52a0\u6216\u4fee\u6539\u4ee5\u4e0b\u914d\u7f6e\uff1a\n# \u7981\u7528root\u76f4\u63a5\u767b\u5f55\nPermitRootLogin no\n\n# \u7981\u7528\u7a7a\u5bc6\u7801\u767b\u5f55\nPermitEmptyPasswords no\n\n# \u7981\u7528\u5bc6\u7801\u8ba4\u8bc1\uff08\u63a8\u8350\u4f7f\u7528\u5bc6\u94a5\u8ba4\u8bc1\uff09\nPasswordAuthentication no\n\n# \u7981\u7528\u8d28\u8be2\u54cd\u5e94\u8ba4\u8bc1\nChallengeResponseAuthentication no\n\n# \u7981\u7528Kerberos\u8ba4\u8bc1\nKerberosAuthentication no\n\n# \u7981\u7528GSSAPI\u8ba4\u8bc1\nGSSAPIAuthentication no\n\n# \u7981\u7528\u4e3b\u673a\u8ba4\u8bc1\nHostbasedAuthentication no\n\n# \u7981\u7528\u7528\u6237\u73af\u5883\u5904\u7406\nPermitUserEnvironment no\n\n# \u7981\u7528X11\u8f6c\u53d1\uff08\u5982\u4e0d\u9700\u8981\uff09\nX11Forwarding no\n\n# \u7981\u7528Agent\u8f6c\u53d1\nAllowAgentForwarding no\n\n# \u7981\u7528TCP\u8f6c\u53d1\nAllowTcpForwarding no\n\n# \u9650\u5236\u5e76\u53d1\u4f1a\u8bdd\u6570\nMaxSessions 2\n\n# \u8bbe\u7f6e\u6700\u5927\u8ba4\u8bc1\u5c1d\u8bd5\u6b21\u6570\nMaxAuthTries 3\n\n# \u8bbe\u7f6e\u767b\u5f55\u5bbd\u9650\u65f6\u95f4\uff08\u79d2\uff09\nLoginGraceTime 30\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#2-ssh","title":"2. SSH\u5bc6\u94a5\u8ba4\u8bc1\u914d\u7f6e","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#21-ssh","title":"2.1 \u751f\u6210\u548c\u90e8\u7f72SSH\u5bc6\u94a5","text":"Bash<pre><code># \u5728\u5ba2\u6237\u7aef\u751f\u6210SSH\u5bc6\u94a5\u5bf9\nssh-keygen -t rsa -b 4096 -C \"admin@yourdomain.com\"\n# \u6216\u4f7f\u7528\u66f4\u5b89\u5168\u7684ed25519\u7b97\u6cd5\nssh-keygen -t ed25519 -C \"admin@yourdomain.com\"\n\n# \u8bbe\u7f6e\u5bc6\u94a5\u6587\u4ef6\u6743\u9650\nchmod 700 ~/.ssh\nchmod 600 ~/.ssh/id_rsa\nchmod 644 ~/.ssh/id_rsa.pub\n\n# \u5c06\u516c\u94a5\u590d\u5236\u5230\u670d\u52a1\u5668\nssh-copy-id -i ~/.ssh/id_rsa.pub -p 2222 username@server_ip\n\n# \u6216\u624b\u52a8\u590d\u5236\ncat ~/.ssh/id_rsa.pub | ssh -p 2222 username@server_ip \"mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys\"\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#22","title":"2.2 \u670d\u52a1\u5668\u7aef\u5bc6\u94a5\u7ba1\u7406","text":"Bash<pre><code># \u5728\u670d\u52a1\u5668\u4e0a\u8bbe\u7f6eauthorized_keys\u6743\u9650\nchmod 700 ~/.ssh\nchmod 600 ~/.ssh/authorized_keys\n\n# \u9650\u5236\u5bc6\u94a5\u529f\u80fd\uff08\u5728authorized_keys\u6587\u4ef6\u4e2d\u7684\u5bc6\u94a5\u524d\u6dfb\u52a0\u9009\u9879\uff09\nvim ~/.ssh/authorized_keys\n# \u793a\u4f8b\uff1a\nno-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty ssh-rsa AAAAB3NzaC1yc2E...\n\n# \u521b\u5efa\u5bc6\u94a5\u7ba1\u7406\u811a\u672c\ncat &gt; /usr/local/bin/manage-ssh-keys.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nKEYS_DIR=\"/etc/ssh/authorized_keys\"\nUSER_HOME=\"/home\"\n\ncase \"$1\" in\n    add)\n        if [ -z \"$2\" ] || [ -z \"$3\" ]; then\n            echo \"Usage: $0 add &lt;username&gt; &lt;public_key_file&gt;\"\n            exit 1\n        fi\n\n        USERNAME=\"$2\"\n        KEY_FILE=\"$3\"\n\n        if [ ! -f \"$KEY_FILE\" ]; then\n            echo \"Key file not found: $KEY_FILE\"\n            exit 1\n        fi\n\n        # \u521b\u5efa\u7528\u6237\u5bc6\u94a5\u76ee\u5f55\n        USER_SSH_DIR=\"$USER_HOME/$USERNAME/.ssh\"\n        sudo mkdir -p \"$USER_SSH_DIR\"\n        sudo chmod 700 \"$USER_SSH_DIR\"\n\n        # \u6dfb\u52a0\u5bc6\u94a5\n        sudo cat \"$KEY_FILE\" &gt;&gt; \"$USER_SSH_DIR/authorized_keys\"\n        sudo chmod 600 \"$USER_SSH_DIR/authorized_keys\"\n        sudo chown -R \"$USERNAME:$USERNAME\" \"$USER_SSH_DIR\"\n\n        echo \"SSH key added for user $USERNAME\"\n        ;;\n\n    remove)\n        if [ -z \"$2\" ] || [ -z \"$3\" ]; then\n            echo \"Usage: $0 remove &lt;username&gt; &lt;key_fingerprint&gt;\"\n            exit 1\n        fi\n\n        USERNAME=\"$2\"\n        FINGERPRINT=\"$3\"\n\n        USER_SSH_DIR=\"$USER_HOME/$USERNAME/.ssh\"\n        AUTHORIZED_KEYS=\"$USER_SSH_DIR/authorized_keys\"\n\n        if [ -f \"$AUTHORIZED_KEYS\" ]; then\n            # \u521b\u5efa\u5907\u4efd\n            sudo cp \"$AUTHORIZED_KEYS\" \"$AUTHORIZED_KEYS.backup.$(date +%Y%m%d_%H%M%S)\"\n\n            # \u5220\u9664\u5339\u914d\u7684\u5bc6\u94a5\n            sudo grep -v \"$FINGERPRINT\" \"$AUTHORIZED_KEYS\" &gt; /tmp/authorized_keys_temp\n            sudo mv /tmp/authorized_keys_temp \"$AUTHORIZED_KEYS\"\n            sudo chmod 600 \"$AUTHORIZED_KEYS\"\n            sudo chown \"$USERNAME:$USERNAME\" \"$AUTHORIZED_KEYS\"\n\n            echo \"SSH key removed for user $USERNAME\"\n        else\n            echo \"No authorized_keys file found for user $USERNAME\"\n        fi\n        ;;\n\n    list)\n        if [ -z \"$2\" ]; then\n            echo \"Usage: $0 list &lt;username&gt;\"\n            exit 1\n        fi\n\n        USERNAME=\"$2\"\n        AUTHORIZED_KEYS=\"$USER_HOME/$USERNAME/.ssh/authorized_keys\"\n\n        if [ -f \"$AUTHORIZED_KEYS\" ]; then\n            echo \"SSH keys for user $USERNAME:\"\n            sudo ssh-keygen -l -f \"$AUTHORIZED_KEYS\"\n        else\n            echo \"No authorized_keys file found for user $USERNAME\"\n        fi\n        ;;\n\n    *)\n        echo \"Usage: $0 {add|remove|list}\"\n        echo \"  add &lt;username&gt; &lt;public_key_file&gt;\"\n        echo \"  remove &lt;username&gt; &lt;key_fingerprint&gt;\"\n        echo \"  list &lt;username&gt;\"\n        ;;\nesac\nEOF\n\nchmod +x /usr/local/bin/manage-ssh-keys.sh\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#3","title":"3. \u8bbf\u95ee\u63a7\u5236\u548c\u767d\u540d\u5355","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#31","title":"3.1 \u57fa\u4e8e\u7528\u6237\u7684\u8bbf\u95ee\u63a7\u5236","text":"Bash<pre><code># \u5728sshd_config\u4e2d\u9650\u5236\u7528\u6237\nvim /etc/ssh/sshd_config\n\n# \u53ea\u5141\u8bb8\u7279\u5b9a\u7528\u6237\u767b\u5f55\nAllowUsers admin user1 user2\n\n# \u6216\u8005\u53ea\u5141\u8bb8\u7279\u5b9a\u7ec4\u7684\u7528\u6237\nAllowGroups sshusers admins\n\n# \u62d2\u7edd\u7279\u5b9a\u7528\u6237\nDenyUsers guest nobody\n\n# \u62d2\u7edd\u7279\u5b9a\u7ec4\nDenyGroups noremote\n\n# \u521b\u5efaSSH\u7528\u6237\u7ec4\ngroupadd sshusers\nusermod -aG sshusers admin\nusermod -aG sshusers user1\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#32-ip","title":"3.2 \u57fa\u4e8eIP\u7684\u8bbf\u95ee\u63a7\u5236","text":"Bash<pre><code># \u4f7f\u7528TCP Wrappers\u9650\u5236\u8bbf\u95ee\nvim /etc/hosts.allow\n# \u6dfb\u52a0\u5141\u8bb8\u7684IP\u6216\u7f51\u6bb5\nsshd: 192.168.1.0/24\nsshd: 10.0.0.5\nsshd: example.com\n\nvim /etc/hosts.deny\n# \u62d2\u7edd\u6240\u6709\u5176\u4ed6\u8fde\u63a5\nsshd: ALL\n\n# \u6216\u8005\u5728sshd_config\u4e2d\u4f7f\u7528Match\u6307\u4ee4\nvim /etc/ssh/sshd_config\n# \u6dfb\u52a0\u6761\u4ef6\u8bbf\u95ee\u63a7\u5236\nMatch Address 192.168.1.0/24\n    PasswordAuthentication yes\n\nMatch Address !192.168.1.0/24\n    PasswordAuthentication no\n    PubkeyAuthentication yes\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#4-ssh","title":"4. SSH\u8fde\u63a5\u76d1\u63a7\u548c\u65e5\u5fd7","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#41-ssh","title":"4.1 \u589e\u5f3aSSH\u65e5\u5fd7","text":"Bash<pre><code># \u5728sshd_config\u4e2d\u542f\u7528\u8be6\u7ec6\u65e5\u5fd7\nvim /etc/ssh/sshd_config\nLogLevel VERBOSE\n\n# \u914d\u7f6ersyslog\u5206\u79bbSSH\u65e5\u5fd7\nvim /etc/rsyslog.d/ssh.conf\n# \u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\n# SSH\u65e5\u5fd7\u5206\u79bb\n:programname, isequal, \"sshd\" /var/log/ssh.log\n&amp; stop\n\n# \u91cd\u542f\u670d\u52a1\nsystemctl restart rsyslog sshd\n\n# \u521b\u5efaSSH\u65e5\u5fd7\u5206\u6790\u811a\u672c\ncat &gt; /usr/local/bin/ssh-log-analyzer.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/ssh.log\"\nREPORT_FILE=\"/var/log/ssh-report.txt\"\nDATE=$(date '+%Y-%m-%d')\n\necho \"SSH\u65e5\u5fd7\u5206\u6790\u62a5\u544a - $DATE\" &gt; $REPORT_FILE\necho \"=================================\" &gt;&gt; $REPORT_FILE\n\n# \u7edf\u8ba1\u767b\u5f55\u6210\u529f\u7684\u8bb0\u5f55\necho \"\u6210\u529f\u767b\u5f55\u7edf\u8ba1:\" &gt;&gt; $REPORT_FILE\ngrep \"Accepted\" $LOG_FILE | awk '{print $1, $2, $3, $9, $11}' | sort | uniq -c | sort -nr &gt;&gt; $REPORT_FILE\necho \"\" &gt;&gt; $REPORT_FILE\n\n# \u7edf\u8ba1\u767b\u5f55\u5931\u8d25\u7684\u8bb0\u5f55\necho \"\u767b\u5f55\u5931\u8d25\u7edf\u8ba1:\" &gt;&gt; $REPORT_FILE\ngrep \"Failed password\" $LOG_FILE | awk '{print $1, $2, $3, $9, $11}' | sort | uniq -c | sort -nr | head -20 &gt;&gt; $REPORT_FILE\necho \"\" &gt;&gt; $REPORT_FILE\n\n# \u7edf\u8ba1\u653b\u51fbIP\necho \"\u653b\u51fbIP TOP 10:\" &gt;&gt; $REPORT_FILE\ngrep \"Failed password\" $LOG_FILE | awk '{print $11}' | sort | uniq -c | sort -nr | head -10 &gt;&gt; $REPORT_FILE\necho \"\" &gt;&gt; $REPORT_FILE\n\n# \u68c0\u67e5\u5f02\u5e38\u767b\u5f55\necho \"\u5f02\u5e38\u65f6\u95f4\u767b\u5f55 (\u975e\u5de5\u4f5c\u65f6\u95f4 18:00-08:00):\" &gt;&gt; $REPORT_FILE\ngrep \"Accepted\" $LOG_FILE | awk '$3 ~ /^(1[8-9]|2[0-3]|0[0-7]):/ {print}' &gt;&gt; $REPORT_FILE\necho \"\" &gt;&gt; $REPORT_FILE\n\n# \u53d1\u9001\u62a5\u544a\u90ae\u4ef6\uff08\u9700\u8981\u914d\u7f6e\u90ae\u4ef6\u670d\u52a1\uff09\n# mail -s \"SSH\u65e5\u5fd7\u5206\u6790\u62a5\u544a - $(hostname)\" admin@yourdomain.com &lt; $REPORT_FILE\nEOF\n\nchmod +x /usr/local/bin/ssh-log-analyzer.sh\n\n# \u6dfb\u52a0\u5230\u6bcf\u65e5\u4efb\u52a1\necho \"0 7 * * * /usr/local/bin/ssh-log-analyzer.sh\" | crontab -\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#42-ssh","title":"4.2 \u5b9e\u65f6SSH\u76d1\u63a7","text":"Bash<pre><code># \u521b\u5efaSSH\u5b9e\u65f6\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/ssh-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nALERT_EMAIL=\"admin@yourdomain.com\"\nFAIL_THRESHOLD=5\nLOG_FILE=\"/var/log/ssh.log\"\nTEMP_FILE=\"/tmp/ssh_failures.tmp\"\n\n# \u76d1\u63a7SSH\u5931\u8d25\u767b\u5f55\ntail -F $LOG_FILE | while read line; do\n    if echo \"$line\" | grep -q \"Failed password\"; then\n        IP=$(echo \"$line\" | awk '{print $11}')\n        TIMESTAMP=$(echo \"$line\" | awk '{print $1, $2, $3}')\n\n        # \u8bb0\u5f55\u5931\u8d25\u5c1d\u8bd5\n        echo \"$TIMESTAMP $IP\" &gt;&gt; $TEMP_FILE\n\n        # \u7edf\u8ba1\u6700\u8fd15\u5206\u949f\u5185\u7684\u5931\u8d25\u6b21\u6570\n        RECENT_FAILS=$(grep \"$IP\" $TEMP_FILE | wc -l)\n\n        if [ $RECENT_FAILS -ge $FAIL_THRESHOLD ]; then\n            # \u53d1\u9001\u8b66\u62a5\n            echo \"SSH\u66b4\u529b\u653b\u51fb\u68c0\u6d4b\u5230\uff01IP: $IP, \u5931\u8d25\u6b21\u6570: $RECENT_FAILS, \u65f6\u95f4: $TIMESTAMP\" | \\\n                logger -t ssh-monitor\n\n            # \u81ea\u52a8\u5c01\u7981IP\uff08\u53ef\u9009\uff09\n            iptables -I INPUT -s $IP -j DROP\n            echo \"IP $IP has been blocked due to SSH brute force attack\" | \\\n                logger -t ssh-monitor\n\n            # \u6e05\u7406\u4e34\u65f6\u8bb0\u5f55\n            grep -v \"$IP\" $TEMP_FILE &gt; $TEMP_FILE.tmp\n            mv $TEMP_FILE.tmp $TEMP_FILE\n        fi\n    fi\n\n    # \u6e05\u74065\u5206\u949f\u524d\u7684\u8bb0\u5f55\n    find $TEMP_FILE -mmin +5 -delete 2&gt;/dev/null\ndone &amp;\nEOF\n\nchmod +x /usr/local/bin/ssh-monitor.sh\n\n# \u521b\u5efasystemd\u670d\u52a1\ncat &gt; /etc/systemd/system/ssh-monitor.service &lt;&lt; 'EOF'\n[Unit]\nDescription=SSH Monitor Service\nAfter=network.target\n\n[Service]\nType=simple\nUser=root\nExecStart=/usr/local/bin/ssh-monitor.sh\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsystemctl daemon-reload\nsystemctl enable ssh-monitor\nsystemctl start ssh-monitor\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#5-ssh","title":"5. SSH\u9ad8\u7ea7\u5b89\u5168\u529f\u80fd","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#51-ssh-certificate-authority","title":"5.1 \u914d\u7f6eSSH Certificate Authority","text":"Bash<pre><code># \u521b\u5efaCA\u5bc6\u94a5\nssh-keygen -t rsa -b 4096 -f /etc/ssh/ca_key -C \"SSH CA\"\n\n# \u914d\u7f6esshd\u4f7f\u7528CA\nvim /etc/ssh/sshd_config\n# \u6dfb\u52a0\uff1a\nTrustedUserCAKeys /etc/ssh/ca_key.pub\n\n# \u4e3a\u7528\u6237\u521b\u5efa\u8bc1\u4e66\nssh-keygen -s /etc/ssh/ca_key -I \"user_cert\" -n admin,root -V +1w ~/.ssh/id_rsa.pub\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#52-ssh","title":"5.2 SSH\u4f1a\u8bdd\u8bb0\u5f55","text":"Bash<pre><code># \u5b89\u88c5ttyrec\u6216script\u5de5\u5177\u8bb0\u5f55\u4f1a\u8bdd\nyum install ttyrec -y  # CentOS/RHEL\napt install ttyrec -y  # Ubuntu/Debian\n\n# \u521b\u5efa\u4f1a\u8bdd\u8bb0\u5f55\u811a\u672c\ncat &gt; /etc/profile.d/session-record.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u53ea\u5bf9SSH\u4f1a\u8bdd\u542f\u7528\u5f55\u5236\nif [ -n \"$SSH_CLIENT\" ] || [ -n \"$SSH_TTY\" ]; then\n    SESSION_LOG_DIR=\"/var/log/sessions\"\n    SESSION_LOG=\"$SESSION_LOG_DIR/$(whoami)_$(date +%Y%m%d_%H%M%S)_$\"\n\n    # \u521b\u5efa\u65e5\u5fd7\u76ee\u5f55\n    sudo mkdir -p $SESSION_LOG_DIR\n    sudo chmod 755 $SESSION_LOG_DIR\n\n    # \u8bb0\u5f55\u4f1a\u8bdd\u5f00\u59cb\n    echo \"Session started: $(date) by $(whoami) from ${SSH_CLIENT%% *}\" | sudo tee -a \"$SESSION_LOG.info\"\n\n    # \u542f\u52a8\u8bb0\u5f55\n    exec script -q -f -c \"$SHELL\" \"$SESSION_LOG\"\nfi\nEOF\n\nchmod +x /etc/profile.d/session-record.sh\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#53-ssh-mfa","title":"5.3 SSH\u591a\u56e0\u7d20\u8ba4\u8bc1 (MFA)","text":"Bash<pre><code># \u5b89\u88c5Google Authenticator PAM\u6a21\u5757\nyum install epel-release -y\nyum install google-authenticator-libpam -y  # CentOS/RHEL\napt install libpam-google-authenticator -y  # Ubuntu/Debian\n\n# \u4e3a\u7528\u6237\u8bbe\u7f6eGoogle Authenticator\nsu - admin\ngoogle-authenticator\n# \u6309\u7167\u63d0\u793a\u5b8c\u6210\u8bbe\u7f6e\uff0c\u4fdd\u5b58\u5bc6\u94a5\u548c\u5907\u4efd\u7801\n\n# \u914d\u7f6ePAM\nvim /etc/pam.d/sshd\n# \u5728\u6587\u4ef6\u5f00\u5934\u6dfb\u52a0\uff1a\nauth required pam_google_authenticator.so\n\n# \u914d\u7f6eSSH\u652f\u6301\u952e\u76d8\u4ea4\u4e92\u8ba4\u8bc1\nvim /etc/ssh/sshd_config\n# \u4fee\u6539\u6216\u6dfb\u52a0\uff1a\nChallengeResponseAuthentication yes\nAuthenticationMethods publickey,keyboard-interactive\n\n# \u91cd\u542fSSH\u670d\u52a1\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#6-ssh","title":"6. SSH\u96a7\u9053\u548c\u7aef\u53e3\u8f6c\u53d1\u5b89\u5168","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#61","title":"6.1 \u9650\u5236\u96a7\u9053\u529f\u80fd","text":"Bash<pre><code># \u5728sshd_config\u4e2d\u9650\u5236\u96a7\u9053\u529f\u80fd\nvim /etc/ssh/sshd_config\n\n# \u7981\u7528\u6240\u6709\u96a7\u9053\u529f\u80fd\nAllowTcpForwarding no\nAllowStreamLocalForwarding no\nGatewayPorts no\n\n# \u6216\u8005\u6709\u9009\u62e9\u6027\u5730\u542f\u7528\nAllowTcpForwarding local  # \u53ea\u5141\u8bb8\u672c\u5730\u8f6c\u53d1\nGatewayPorts clientspecified  # \u9650\u5236\u7f51\u5173\u7aef\u53e3\n\n# \u5bf9\u7279\u5b9a\u7528\u6237\u7981\u7528\u96a7\u9053\nMatch User restricteduser\n    AllowTcpForwarding no\n    X11Forwarding no\n    PermitTunnel no\n\nsystemctl restart sshd\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#62-ssh","title":"6.2 \u76d1\u63a7SSH\u96a7\u9053\u6d3b\u52a8","text":"Bash<pre><code># \u521b\u5efa\u96a7\u9053\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/ssh-tunnel-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOGFILE=\"/var/log/ssh-tunnels.log\"\n\n# \u68c0\u67e5\u5f53\u524dSSH\u8fde\u63a5\nnetstat -tnp | grep sshd | while read line; do\n    PID=$(echo \"$line\" | awk '{print $7}' | cut -d'/' -f1)\n    if [ -n \"$PID\" ]; then\n        # \u68c0\u67e5\u8fdb\u7a0b\u7684\u7aef\u53e3\u8f6c\u53d1\n        FORWARDS=$(lsof -p $PID 2&gt;/dev/null | grep LISTEN)\n        if [ -n \"$FORWARDS\" ]; then\n            TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n            echo \"[$TIMESTAMP] SSH Tunnel detected - PID: $PID\" &gt;&gt; $LOGFILE\n            echo \"$FORWARDS\" &gt;&gt; $LOGFILE\n            echo \"---\" &gt;&gt; $LOGFILE\n        fi\n    fi\ndone\nEOF\n\nchmod +x /usr/local/bin/ssh-tunnel-monitor.sh\n\n# \u6bcf5\u5206\u949f\u68c0\u67e5\u4e00\u6b21\necho \"*/5 * * * * /usr/local/bin/ssh-tunnel-monitor.sh\" | crontab -\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#7-ssh","title":"7. SSH\u5b89\u5168\u81ea\u52a8\u5316\u811a\u672c","text":"","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#71-ssh","title":"7.1 SSH\u5b89\u5168\u914d\u7f6e\u68c0\u67e5\u811a\u672c","text":"Bash<pre><code>cat &gt; /usr/local/bin/ssh-security-check.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m' # No Color\n\nSSHD_CONFIG=\"/etc/ssh/sshd_config\"\nREPORT_FILE=\"/var/log/ssh-security-check.log\"\n\necho \"SSH Security Check Report - $(date)\" &gt; $REPORT_FILE\necho \"==========================================\" &gt;&gt; $REPORT_FILE\n\n# \u68c0\u67e5SSH\u914d\u7f6e\u9879\ncheck_config() {\n    local setting=\"$1\"\n    local expected=\"$2\"\n    local description=\"$3\"\n\n    actual=$(grep \"^$setting\" $SSHD_CONFIG | awk '{print $2}')\n\n    if [ \"$actual\" = \"$expected\" ]; then\n        echo -e \"${GREEN}[PASS]${NC} $description: $actual\" | tee -a $REPORT_FILE\n    else\n        echo -e \"${RED}[FAIL]${NC} $description: Expected '$expected', Found '$actual'\" | tee -a $REPORT_FILE\n    fi\n}\n\n# \u6267\u884c\u5b89\u5168\u68c0\u67e5\necho \"SSH Security Configuration Check:\"\ncheck_config \"Port\" \"2222\" \"SSH Port\"\ncheck_config \"PermitRootLogin\" \"no\" \"Root Login\"\ncheck_config \"PasswordAuthentication\" \"no\" \"Password Authentication\"\ncheck_config \"PermitEmptyPasswords\" \"no\" \"Empty Passwords\"\ncheck_config \"X11Forwarding\" \"no\" \"X11 Forwarding\"\ncheck_config \"AllowTcpForwarding\" \"no\" \"TCP Forwarding\"\ncheck_config \"MaxAuthTries\" \"3\" \"Max Auth Tries\"\ncheck_config \"LoginGraceTime\" \"30\" \"Login Grace Time\"\n\n# \u68c0\u67e5SSH\u5bc6\u94a5\u6743\u9650\necho -e \"\\n${YELLOW}Checking SSH Key Permissions:${NC}\" | tee -a $REPORT_FILE\nfind /home -name \"authorized_keys\" -exec ls -la {} \\; | while read perm links owner group size date time file; do\n    if [[ $perm != \"-rw-------\" ]]; then\n        echo -e \"${RED}[FAIL]${NC} Wrong permissions on $file: $perm\" | tee -a $REPORT_FILE\n    else\n        echo -e \"${GREEN}[PASS]${NC} Correct permissions on $file: $perm\" | tee -a $REPORT_FILE\n    fi\ndone\n\n# \u68c0\u67e5\u6700\u8fd1\u7684SSH\u653b\u51fb\necho -e \"\\n${YELLOW}Recent SSH Attack Attempts:${NC}\" | tee -a $REPORT_FILE\ngrep \"Failed password\" /var/log/secure 2&gt;/dev/null | tail -10 | tee -a $REPORT_FILE\n\n# \u68c0\u67e5\u5f53\u524dSSH\u8fde\u63a5\necho -e \"\\n${YELLOW}Current SSH Connections:${NC}\" | tee -a $REPORT_FILE\nss -tnp | grep sshd | tee -a $REPORT_FILE\n\necho -e \"\\nReport saved to: $REPORT_FILE\"\nEOF\n\nchmod +x /usr/local/bin/ssh-security-check.sh\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#72-ssh-fail2ban","title":"7.2 SSH\u81ea\u52a8\u5c01\u7981\u811a\u672c (Fail2Ban\u66ff\u4ee3)","text":"Bash<pre><code>cat &gt; /usr/local/bin/ssh-autoban.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOGFILE=\"/var/log/secure\"\nBANLIST=\"/var/log/ssh-banned-ips.log\"\nWHITELIST=\"/etc/ssh/whitelist-ips.conf\"\nBAN_TIME=3600  # \u5c01\u7981\u65f6\u95f4\uff08\u79d2\uff09\nMAX_ATTEMPTS=5  # \u6700\u5927\u5c1d\u8bd5\u6b21\u6570\nTIME_WINDOW=600  # \u65f6\u95f4\u7a97\u53e3\uff08\u79d2\uff09\n\n# \u521b\u5efa\u767d\u540d\u5355\u6587\u4ef6\uff08\u5982\u679c\u4e0d\u5b58\u5728\uff09\nif [ ! -f \"$WHITELIST\" ]; then\n    cat &gt; $WHITELIST &lt;&lt; 'EOFWHITE'\n127.0.0.1\n192.168.1.0/24\n10.0.0.0/8\nEOFWHITE\nfi\n\n# \u68c0\u67e5IP\u662f\u5426\u5728\u767d\u540d\u5355\u4e2d\nis_whitelisted() {\n    local ip=\"$1\"\n    while read -r whitelist_entry; do\n        # \u8df3\u8fc7\u6ce8\u91ca\u548c\u7a7a\u884c\n        [[ $whitelist_entry =~ ^#.*$ ]] &amp;&amp; continue\n        [[ -z \"$whitelist_entry\" ]] &amp;&amp; continue\n\n        # \u68c0\u67e5IP\u662f\u5426\u5339\u914d\n        if [[ \"$ip\" == \"$whitelist_entry\" ]]; then\n            return 0\n        fi\n\n        # \u68c0\u67e5\u7f51\u6bb5\u5339\u914d\uff08\u7b80\u5316\u7248\u672c\uff09\n        if [[ \"$whitelist_entry\" == *\"/\"* ]]; then\n            network=$(echo \"$whitelist_entry\" | cut -d'/' -f1)\n            if [[ \"$ip\" == \"$network\"* ]]; then\n                return 0\n            fi\n        fi\n    done &lt; \"$WHITELIST\"\n    return 1\n}\n\n# \u5c01\u7981IP\nban_ip() {\n    local ip=\"$1\"\n    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')\n\n    # \u68c0\u67e5\u662f\u5426\u5df2\u7ecf\u5c01\u7981\n    if iptables -L INPUT -n | grep -q \"$ip\"; then\n        return 0\n    fi\n\n    # \u6dfb\u52a0iptables\u89c4\u5219\n    iptables -I INPUT -s \"$ip\" -j DROP\n\n    # \u8bb0\u5f55\u5c01\u7981\n    echo \"[$timestamp] Banned IP: $ip\" &gt;&gt; $BANLIST\n    logger -t ssh-autoban \"Banned IP: $ip due to SSH brute force attack\"\n\n    # \u8bbe\u7f6e\u5b9a\u65f6\u89e3\u5c01\n    echo \"sleep $BAN_TIME &amp;&amp; iptables -D INPUT -s $ip -j DROP &amp;&amp; echo \\\"[$timestamp] Unbanned IP: $ip\\\" &gt;&gt; $BANLIST\" | at now\n}\n\n# \u5206\u6790\u65e5\u5fd7\u5e76\u5c01\u7981\u6076\u610fIP\nanalyze_log() {\n    # \u83b7\u53d6\u6700\u8fd1\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u5931\u8d25\u767b\u5f55\n    since_time=$(date -d \"$TIME_WINDOW seconds ago\" '+%b %d %H:%M:%S')\n\n    # \u63d0\u53d6\u5931\u8d25\u7684SSH\u767b\u5f55\u5c1d\u8bd5\n    grep \"Failed password\" $LOGFILE | \\\n    awk -v since=\"$since_time\" '\n        BEGIN { \n            # \u5c06since_time\u8f6c\u6362\u4e3a\u53ef\u6bd4\u8f83\u7684\u683c\u5f0f\n            cmd = \"date -d \\\"\" since \"\\\" +%s\"\n            cmd | getline since_epoch\n            close(cmd)\n        }\n        {\n            # \u63d0\u53d6\u65f6\u95f4\u6233\u548cIP\n            timestamp = $1 \" \" $2 \" \" $3\n            ip = $11\n\n            # \u8f6c\u6362\u5f53\u524d\u884c\u65f6\u95f4\u6233\u4e3aepoch\n            cmd = \"date -d \\\"\" timestamp \"\\\" +%s 2&gt;/dev/null\"\n            if ((cmd | getline current_epoch) &gt; 0) {\n                close(cmd)\n                if (current_epoch &gt;= since_epoch) {\n                    count[ip]++\n                }\n            }\n        }\n        END {\n            for (ip in count) {\n                if (count[ip] &gt;= '$MAX_ATTEMPTS') {\n                    print ip, count[ip]\n                }\n            }\n        }\n    ' | while read ip attempts; do\n        # \u68c0\u67e5\u767d\u540d\u5355\n        if ! is_whitelisted \"$ip\"; then\n            echo \"IP $ip has $attempts failed attempts, banning...\"\n            ban_ip \"$ip\"\n        else\n            echo \"IP $ip is whitelisted, skipping ban\"\n        fi\n    done\n}\n\n# \u4e3b\u6267\u884c\ncase \"$1\" in\n    start)\n        echo \"Starting SSH auto-ban monitoring...\"\n        analyze_log\n        ;;\n    unban)\n        if [ -z \"$2\" ]; then\n            echo \"Usage: $0 unban &lt;ip_address&gt;\"\n            exit 1\n        fi\n        iptables -D INPUT -s \"$2\" -j DROP 2&gt;/dev/null\n        echo \"IP $2 has been unbanned\"\n        ;;\n    status)\n        echo \"Currently banned IPs:\"\n        iptables -L INPUT -n | grep DROP | awk '{print $4}' | grep -v \"0.0.0.0/0\"\n        ;;\n    *)\n        echo \"Usage: $0 {start|unban &lt;ip&gt;|status}\"\n        ;;\nesac\nEOF\n\nchmod +x /usr/local/bin/ssh-autoban.sh\n\n# \u521b\u5efa\u5b9a\u65f6\u4efb\u52a1\uff0c\u6bcf\u5206\u949f\u68c0\u67e5\u4e00\u6b21\necho \"* * * * * /usr/local/bin/ssh-autoban.sh start &gt;/dev/null 2&gt;&amp;1\" | crontab -\n\n# \u521b\u5efa\u7cfb\u7edf\u670d\u52a1\uff08\u53ef\u9009\uff09\ncat &gt; /etc/systemd/system/ssh-autoban.service &lt;&lt; 'EOF'\n[Unit]\nDescription=SSH Auto-ban Service\nAfter=network.target\n\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/ssh-autoban.sh start\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n# \u521b\u5efa\u5b9a\u65f6\u5668\ncat &gt; /etc/systemd/system/ssh-autoban.timer &lt;&lt; 'EOF'\n[Unit]\nDescription=SSH Auto-ban Timer\nRequires=ssh-autoban.service\n\n[Timer]\nOnCalendar=*:*:0\nPersistent=true\n\n[Install]\nWantedBy=timers.target\nEOF\n\nsystemctl daemon-reload\nsystemctl enable ssh-autoban.timer\nsystemctl start ssh-autoban.timer\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/SSH%E5%AE%89%E5%85%A8/#8-sshchecklist","title":"8. SSH\u5b89\u5168\u7ef4\u62a4checklist","text":"Bash<pre><code># \u521b\u5efaSSH\u5b89\u5168\u7ef4\u62a4\u6e05\u5355\u811a\u672c\ncat &gt; /usr/local/bin/ssh-maintenance.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\necho \"SSH Security Maintenance Checklist\"\necho \"==================================\"\n\necho \"1. \u68c0\u67e5SSH\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5...\"\nsshd -t &amp;&amp; echo \"\u2713 SSH\u914d\u7f6e\u8bed\u6cd5\u6b63\u786e\" || echo \"\u2717 SSH\u914d\u7f6e\u8bed\u6cd5\u9519\u8bef\"\n\necho \"2. \u68c0\u67e5SSH\u670d\u52a1\u72b6\u6001...\"\nsystemctl is-active sshd &gt;/dev/null &amp;&amp; echo \"\u2713 SSH\u670d\u52a1\u8fd0\u884c\u6b63\u5e38\" || echo \"\u2717 SSH\u670d\u52a1\u672a\u8fd0\u884c\"\n\necho \"3. \u68c0\u67e5SSH\u7aef\u53e3\u76d1\u542c...\"\nss -tnlp | grep -q \":$(grep \"^Port\" /etc/ssh/sshd_config | awk '{print $2}')\" &amp;&amp; echo \"\u2713 SSH\u7aef\u53e3\u76d1\u542c\u6b63\u5e38\" || echo \"\u2717 SSH\u7aef\u53e3\u76d1\u542c\u5f02\u5e38\"\n\necho \"4. \u68c0\u67e5\u6700\u8fd124\u5c0f\u65f6\u7684SSH\u653b\u51fb...\"\nattacks=$(grep \"$(date --date='1 day ago' '+%b %d')\" /var/log/secure 2&gt;/dev/null | grep \"Failed password\" | wc -l)\necho \"   \u6700\u8fd124\u5c0f\u65f6\u5931\u8d25\u767b\u5f55\u5c1d\u8bd5: $attacks \u6b21\"\n\necho \"5. \u68c0\u67e5\u5f53\u524d\u6d3b\u8dc3SSH\u8fde\u63a5...\"\nactive=$(ss -tn | grep :$(grep \"^Port\" /etc/ssh/sshd_config | awk '{print $2}') | grep ESTAB | wc -l)\necho \"   \u5f53\u524d\u6d3b\u8dc3\u8fde\u63a5\u6570: $active\"\n\necho \"6. \u68c0\u67e5SSH\u5bc6\u94a5\u6743\u9650...\"\nfind /home -name \".ssh\" -type d -exec ls -ld {} \\; | awk '$1 !~ /^drwx------/ {print \"\u2717 Wrong permission: \" $9}' | head -5\n\necho \"7. \u68c0\u67e5authorized_keys\u6587\u4ef6...\"\nfind /home -name \"authorized_keys\" -exec ls -l {} \\; | awk '$1 !~ /^-rw-------/ {print \"\u2717 Wrong permission: \" $9}' | head -5\n\necho \"8. \u6e05\u7406\u8fc7\u671f\u7684\u4f1a\u8bdd\u8bb0\u5f55...\"\nfind /var/log/sessions -type f -mtime +30 -delete 2&gt;/dev/null\necho \"\u2713 \u6e05\u740630\u5929\u524d\u7684\u4f1a\u8bdd\u8bb0\u5f55\"\n\necho \"9. \u8f6e\u8f6cSSH\u65e5\u5fd7...\"\nlogrotate -f /etc/logrotate.d/ssh 2&gt;/dev/null\necho \"\u2713 SSH\u65e5\u5fd7\u8f6e\u8f6c\u5b8c\u6210\"\n\necho \"10. \u66f4\u65b0IP\u5c01\u7981\u5217\u8868...\"\n/usr/local/bin/ssh-autoban.sh start\necho \"\u2713 IP\u5c01\u7981\u68c0\u67e5\u5b8c\u6210\"\n\necho \"\"\necho \"SSH\u5b89\u5168\u7ef4\u62a4\u5b8c\u6210 - $(date)\"\nEOF\n\nchmod +x /usr/local/bin/ssh-maintenance.sh\n\n# \u8bbe\u7f6e\u6bcf\u5468\u8fd0\u884c\u7ef4\u62a4\u811a\u672c\necho \"0 6 * * 0 /usr/local/bin/ssh-maintenance.sh | mail -s 'SSH Security Maintenance Report' admin@yourdomain.com\" | crontab -\n</code></pre>","tags":["SSH\u5b89\u5168\u914d\u7f6e\u4e0e\u8bbf\u95ee\u63a7\u5236","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/","title":"Docker\u5bb9\u5668\u5b89\u5168\u6700\u4f73\u5b9e\u8df5\u6307\u5357","text":"<p>\u968f\u7740\u5bb9\u5668\u5316\u6280\u672f\u5728\u4f01\u4e1a\u7ea7\u5e94\u7528\u4e2d\u7684\u5e7f\u6cdb\u91c7\u7528\uff0cDocker\u5b89\u5168\u5df2\u6210\u4e3a\u73b0\u4ee3IT\u57fa\u7840\u8bbe\u65bd\u7684\u5173\u952e\u7ec4\u6210\u90e8\u5206\u3002\u672c\u6307\u5357\u5c06\u4ece\u5b9e\u6218\u89d2\u5ea6\u51fa\u53d1\uff0c\u4e3a\u5f00\u53d1\u56e2\u961f\u548c\u8fd0\u7ef4\u4eba\u5458\u63d0\u4f9b\u7cfb\u7edf\u6027\u7684Docker\u5b89\u5168\u9632\u62a4\u7b56\u7565\uff0c\u786e\u4fdd\u5bb9\u5668\u5316\u5e94\u7528\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u7684\u5b89\u5168\u7a33\u5b9a\u8fd0\u884c\u3002</p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#1","title":"1. \u955c\u50cf\u5b89\u5168\u7b56\u7565","text":"","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#11","title":"1.1 \u57fa\u7840\u955c\u50cf\u9009\u62e9\u4e0e\u7ba1\u7406","text":"<p>\u9009\u62e9\u5b98\u65b9\u8ba4\u8bc1\u955c\u50cf - \u4f18\u5148\u4f7f\u7528Docker\u5b98\u65b9\u4ed3\u5e93\u4e2d\u7684<code>Official Images</code>\u6807\u7b7e\u955c\u50cf - \u9009\u62e9\u6d3b\u8dc3\u7ef4\u62a4\u7684\u955c\u50cf\uff08\u6700\u8fd130\u5929\u5185\u6709\u66f4\u65b0\uff09 - \u907f\u514d\u4f7f\u7528\u4e2a\u4eba\u6216\u672a\u77e5\u6765\u6e90\u7684\u955c\u50cf</p> <p>\u63a8\u8350\u7684\u57fa\u7840\u955c\u50cf\u9009\u62e9\u987a\u5e8f\uff1a Docker<pre><code># \u63a8\u8350\u5ea6\uff1a\u9ad8 \u2192 \u4f4e\nFROM alpine:3.18.4        # \u6700\u5c0f\u5316Linux\u53d1\u884c\u7248\uff0c\u5b89\u5168\u6027\u9ad8\nFROM ubuntu:22.04         # \u5b98\u65b9Ubuntu\uff0c\u517c\u5bb9\u6027\u597d\nFROM debian:bookworm-slim # Debian\u7cbe\u7b80\u7248\nFROM scratch              # \u7a7a\u955c\u50cf\uff0c\u4ec5\u9002\u7528\u4e8e\u9759\u6001\u7f16\u8bd1\u7684\u5e94\u7528\n</code></pre></p> <p>\u5efa\u7acb\u79c1\u6709\u955c\u50cf\u4ed3\u5e93 Bash<pre><code># \u90e8\u7f72Harbor\u79c1\u6709\u4ed3\u5e93\u793a\u4f8b\ndocker run -d -p 8080:80 -p 8443:443 \\\n  --name harbor \\\n  -v /opt/harbor/data:/data \\\n  goharbor/harbor-core:latest\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#12","title":"1.2 \u955c\u50cf\u6784\u5efa\u5b89\u5168\u5b9e\u8df5","text":"<p>\u591a\u9636\u6bb5\u6784\u5efa\u6700\u4f73\u5b9e\u8df5 Docker<pre><code># \u6784\u5efa\u9636\u6bb5\uff1a\u5305\u542b\u5b8c\u6574\u5f00\u53d1\u73af\u5883\nFROM node:18-alpine AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production &amp;&amp; npm cache clean --force\nCOPY . .\nRUN npm run build &amp;&amp; \\\n    # \u6e05\u7406\u6784\u5efa\u7f13\u5b58\n    rm -rf node_modules &amp;&amp; \\\n    rm -rf .npm\n\n# \u751f\u4ea7\u9636\u6bb5\uff1a\u6700\u5c0f\u5316\u8fd0\u884c\u73af\u5883\nFROM nginx:1.24-alpine AS production\n# \u521b\u5efa\u975eroot\u7528\u6237\nRUN addgroup -g 1001 appgroup &amp;&amp; \\\n    adduser -D -u 1001 -G appgroup appuser\n\n# \u590d\u5236\u6784\u5efa\u4ea7\u7269\nCOPY --from=builder --chown=appuser:appgroup /app/dist /usr/share/nginx/html\nCOPY --chown=appuser:appgroup nginx.conf /etc/nginx/nginx.conf\n\n# \u8bbe\u7f6e\u5b89\u5168\u6743\u9650\nRUN chmod -R 755 /usr/share/nginx/html &amp;&amp; \\\n    chown -R appuser:appgroup /var/cache/nginx\n\nUSER appuser\nEXPOSE 8080\nCMD [\"nginx\", \"-g\", \"daemon off;\"]\n</code></pre></p> <p>\u5b89\u5168\u7684\u4f9d\u8d56\u7ba1\u7406 Docker<pre><code># \u9501\u5b9a\u786e\u5207\u7248\u672c\uff0c\u907f\u514d\u4f9b\u5e94\u94fe\u653b\u51fb\nFROM python:3.11.6-slim\n\n# \u4f7f\u7528requirements.txt\u9501\u5b9a\u4f9d\u8d56\u7248\u672c\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt==1.2.3 \\\n    &amp;&amp; pip check  # \u68c0\u67e5\u4f9d\u8d56\u51b2\u7a81\n\n# \u9a8c\u8bc1\u5173\u952e\u4f9d\u8d56\u7684\u5b8c\u6574\u6027\nRUN pip show django | grep Version: | grep -q \"4.2.7\" || exit 1\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#13","title":"1.3 \u955c\u50cf\u5c42\u4f18\u5316\u4e0e\u5b89\u5168\u52a0\u56fa","text":"<p>\u51cf\u5c11\u955c\u50cf\u5c42\u548c\u653b\u51fb\u9762 Docker<pre><code>FROM alpine:3.18.4\n\n# \u5408\u5e76RUN\u6307\u4ee4\uff0c\u51cf\u5c11\u955c\u50cf\u5c42\nRUN apk add --no-cache \\\n    curl=8.4.0-r0 \\\n    jq=1.6-r4 \\\n    &amp;&amp; rm -rf /var/cache/apk/* \\\n    &amp;&amp; rm -rf /tmp/* \\\n    # \u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u5305\u7ba1\u7406\u5668\u7f13\u5b58\n    &amp;&amp; find /usr -name \"*.pyc\" -delete \\\n    &amp;&amp; find /usr -name \"__pycache__\" -type d -exec rm -rf {} +\n\n# \u4f7f\u7528.dockerignore\u51cf\u5c11\u6784\u5efa\u4e0a\u4e0b\u6587\n# .dockerignore\u5185\u5bb9\u793a\u4f8b\uff1a\n# node_modules\n# .git\n# *.log\n# .env\n# Dockerfile*\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#2","title":"2. \u8fd0\u884c\u65f6\u5b89\u5168\u914d\u7f6e","text":"","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#21","title":"2.1 \u7528\u6237\u6743\u9650\u548c\u8bbf\u95ee\u63a7\u5236","text":"<p>\u5b9e\u65bd\u6700\u5c0f\u6743\u9650\u539f\u5219 Bash<pre><code># \u521b\u5efa\u4e13\u7528\u7528\u6237\u548c\u7528\u6237\u7ec4\ndocker run -d \\\n  --name secure-app \\\n  --user 1001:1001 \\\n  --cap-drop ALL \\\n  --cap-add NET_BIND_SERVICE \\\n  --no-new-privileges \\\n  --read-only \\\n  --tmpfs /tmp:rw,noexec,nosuid,size=100m \\\n  my-secure-app:latest\n</code></pre></p> <p>\u6743\u9650\u914d\u7f6e\u8be6\u89e3\uff1a - <code>--user 1001:1001</code>: \u6307\u5b9a\u975eroot\u7528\u6237\u8fd0\u884c - <code>--cap-drop ALL</code>: \u79fb\u9664\u6240\u6709Linux capabilities - <code>--cap-add NET_BIND_SERVICE</code>: \u4ec5\u6dfb\u52a0\u7ed1\u5b9a\u7279\u6743\u7aef\u53e3\u7684\u80fd\u529b - <code>--no-new-privileges</code>: \u9632\u6b62\u8fdb\u7a0b\u83b7\u53d6\u65b0\u6743\u9650 - <code>--read-only</code>: \u5c06\u6839\u6587\u4ef6\u7cfb\u7edf\u8bbe\u4e3a\u53ea\u8bfb - <code>--tmpfs</code>: \u4e3a\u4e34\u65f6\u6587\u4ef6\u521b\u5efa\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf</p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#22","title":"2.2 \u7f51\u7edc\u5b89\u5168\u9694\u79bb","text":"<p>\u81ea\u5b9a\u4e49\u7f51\u7edc\u914d\u7f6e Bash<pre><code># \u521b\u5efa\u9694\u79bb\u7684\u81ea\u5b9a\u4e49\u7f51\u7edc\ndocker network create \\\n  --driver bridge \\\n  --subnet=172.20.0.0/16 \\\n  --ip-range=172.20.240.0/20 \\\n  --gateway=172.20.0.1 \\\n  secure-network\n\n# \u5728\u9694\u79bb\u7f51\u7edc\u4e2d\u8fd0\u884c\u5bb9\u5668\ndocker run -d \\\n  --name web-app \\\n  --network secure-network \\\n  --ip 172.20.240.10 \\\n  -p 127.0.0.1:8080:80 \\  # \u53ea\u7ed1\u5b9a\u5230\u672c\u5730\u63a5\u53e3\n  nginx:alpine\n</code></pre></p> <p>\u7f51\u7edc\u7b56\u7565\u914d\u7f6e YAML<pre><code># docker-compose.yml\u7f51\u7edc\u5b89\u5168\u914d\u7f6e\nversion: '3.8'\nservices:\n  web:\n    image: nginx:alpine\n    networks:\n      - frontend\n    ports:\n      - \"127.0.0.1:80:80\"  # \u53ea\u7ed1\u5b9a\u672c\u5730\u63a5\u53e3\n\n  api:\n    image: my-api:latest\n    networks:\n      - frontend\n      - backend\n    # \u4e0d\u66b4\u9732\u7aef\u53e3\u5230\u5bbf\u4e3b\u673a\n\n  database:\n    image: postgres:15-alpine\n    networks:\n      - backend  # \u4ec5\u5728\u540e\u7aef\u7f51\u7edc\uff0c\u65e0\u6cd5\u4ece\u5916\u90e8\u8bbf\u95ee\n    environment:\n      POSTGRES_PASSWORD_FILE: /run/secrets/db_password\n    secrets:\n      - db_password\n\nnetworks:\n  frontend:\n    driver: bridge\n  backend:\n    driver: bridge\n    internal: true  # \u5185\u90e8\u7f51\u7edc\uff0c\u65e0\u5916\u7f51\u8bbf\u95ee\n\nsecrets:\n  db_password:\n    external: true\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#23","title":"2.3 \u8d44\u6e90\u9650\u5236\u548c\u76d1\u63a7","text":"<p>\u7efc\u5408\u8d44\u6e90\u9650\u5236\u914d\u7f6e Bash<pre><code>docker run -d \\\n  --name resource-limited-app \\\n  --memory=512m \\\n  --memory-swap=512m \\\n  --memory-reservation=256m \\\n  --cpus=\"1.5\" \\\n  --cpu-shares=1024 \\\n  --pids-limit=100 \\\n  --ulimit nofile=1024:1024 \\\n  --ulimit nproc=64:64 \\\n  --restart=unless-stopped \\\n  my-app:latest\n</code></pre></p> <p>\u8d44\u6e90\u76d1\u63a7\u811a\u672c Bash<pre><code>#!/bin/bash\n# container-monitor.sh - \u5bb9\u5668\u8d44\u6e90\u76d1\u63a7\u811a\u672c\n\nCONTAINER_NAME=\"my-app\"\nALERT_MEMORY_THRESHOLD=80  # \u5185\u5b58\u4f7f\u7528\u7387\u544a\u8b66\u9608\u503c\nALERT_CPU_THRESHOLD=90     # CPU\u4f7f\u7528\u7387\u544a\u8b66\u9608\u503c\n\nwhile true; do\n    # \u83b7\u53d6\u5bb9\u5668\u7edf\u8ba1\u4fe1\u606f\n    STATS=$(docker stats --no-stream --format \"{{.Container}}\\t{{.CPUPerc}}\\t{{.MemUsage}}\\t{{.MemPerc}}\" $CONTAINER_NAME)\n\n    if [ -n \"$STATS\" ]; then\n        CPU_PERCENT=$(echo $STATS | awk '{print $2}' | sed 's/%//')\n        MEM_PERCENT=$(echo $STATS | awk '{print $4}' | sed 's/%//')\n\n        # \u68c0\u67e5\u5185\u5b58\u4f7f\u7528\u7387\n        if (( $(echo \"$MEM_PERCENT &gt; $ALERT_MEMORY_THRESHOLD\" | bc -l) )); then\n            echo \"$(date): ALERT - Memory usage: ${MEM_PERCENT}%\" &gt;&gt; /var/log/container-alerts.log\n        fi\n\n        # \u68c0\u67e5CPU\u4f7f\u7528\u7387\n        if (( $(echo \"$CPU_PERCENT &gt; $ALERT_CPU_THRESHOLD\" | bc -l) )); then\n            echo \"$(date): ALERT - CPU usage: ${CPU_PERCENT}%\" &gt;&gt; /var/log/container-alerts.log\n        fi\n    fi\n\n    sleep 30\ndone\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#3","title":"3. \u5bc6\u94a5\u548c\u654f\u611f\u4fe1\u606f\u7ba1\u7406","text":"","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#31-docker-secrets","title":"3.1 Docker Secrets\u5b9e\u8df5","text":"<p>\u751f\u4ea7\u73af\u5883\u5bc6\u94a5\u7ba1\u7406 Bash<pre><code># \u521b\u5efa\u6570\u636e\u5e93\u5bc6\u7801\u5bc6\u94a5\necho \"super_secret_password\" | docker secret create db_password -\n\n# \u521b\u5efaTLS\u8bc1\u4e66\u5bc6\u94a5\ndocker secret create ssl_cert /path/to/certificate.pem\ndocker secret create ssl_key /path/to/private.key\n\n# \u5728\u670d\u52a1\u4e2d\u4f7f\u7528\u5bc6\u94a5\ndocker service create \\\n  --name secure-web \\\n  --secret db_password \\\n  --secret ssl_cert \\\n  --secret ssl_key \\\n  --mount type=tmpfs,destination=/run/secrets \\\n  my-secure-web:latest\n</code></pre></p> <p>\u5e94\u7528\u7a0b\u5e8f\u4e2d\u8bfb\u53d6\u5bc6\u94a5\u793a\u4f8b Python<pre><code># Python\u5e94\u7528\u8bfb\u53d6Docker\u5bc6\u94a5\nimport os\n\ndef read_secret(secret_name):\n    \"\"\"\u5b89\u5168\u8bfb\u53d6Docker\u5bc6\u94a5\"\"\"\n    secret_path = f'/run/secrets/{secret_name}'\n    try:\n        with open(secret_path, 'r') as f:\n            return f.read().strip()\n    except FileNotFoundError:\n        # \u964d\u7ea7\u5230\u73af\u5883\u53d8\u91cf\uff08\u5f00\u53d1\u73af\u5883\uff09\n        return os.environ.get(secret_name.upper())\n    except Exception as e:\n        print(f\"Error reading secret {secret_name}: {e}\")\n        return None\n\n# \u4f7f\u7528\u793a\u4f8b\ndb_password = read_secret('db_password')\nif db_password:\n    # \u8fde\u63a5\u6570\u636e\u5e93\n    pass\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#32","title":"3.2 \u73af\u5883\u53d8\u91cf\u5b89\u5168\u5b9e\u8df5","text":"<p>\u5b89\u5168\u7684\u73af\u5883\u53d8\u91cf\u5904\u7406 Bash<pre><code># \u4f7f\u7528env\u6587\u4ef6\u7ba1\u7406\u975e\u654f\u611f\u914d\u7f6e\ncat &gt; app.env &lt;&lt; EOF\nAPP_ENV=production\nLOG_LEVEL=info\nDEBUG=false\nAPI_VERSION=v1\nEOF\n\n# \u654f\u611f\u4fe1\u606f\u901a\u8fc7\u5bc6\u94a5\u6216\u8fd0\u884c\u65f6\u6ce8\u5165\ndocker run -d \\\n  --name secure-app \\\n  --env-file app.env \\\n  --env DB_HOST=postgres.internal \\\n  --mount type=bind,source=/etc/ssl/certs,target=/etc/ssl/certs,readonly \\\n  my-app:latest\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#4","title":"4. \u5b89\u5168\u626b\u63cf\u548c\u6f0f\u6d1e\u7ba1\u7406","text":"","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#41","title":"4.1 \u96c6\u6210\u5316\u5b89\u5168\u626b\u63cf\u6d41\u7a0b","text":"<p>CI/CD\u7ba1\u9053\u4e2d\u7684\u5b89\u5168\u626b\u63cf YAML<pre><code># .github/workflows/security-scan.yml\nname: Container Security Scan\non:\n  push:\n    branches: [main, develop]\n  pull_request:\n    branches: [main]\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Build Docker image\n        run: docker build -t ${{ github.repository }}:${{ github.sha }} .\n\n      - name: Run Trivy vulnerability scanner\n        uses: aquasecurity/trivy-action@master\n        with:\n          image-ref: '${{ github.repository }}:${{ github.sha }}'\n          format: 'sarif'\n          output: 'trivy-results.sarif'\n          severity: 'CRITICAL,HIGH,MEDIUM'\n          exit-code: '1'  # \u53d1\u73b0\u9ad8\u5371\u6f0f\u6d1e\u65f6\u5931\u8d25\n\n      - name: Upload Trivy scan results\n        uses: github/codeql-action/upload-sarif@v2\n        if: always()\n        with:\n          sarif_file: 'trivy-results.sarif'\n\n      - name: Security audit with Snyk\n        run: |\n          npm install -g snyk\n          snyk test --docker ${{ github.repository }}:${{ github.sha }} --severity-threshold=high\n        env:\n          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}\n</code></pre></p> <p>\u672c\u5730\u5b89\u5168\u626b\u63cf\u811a\u672c Bash<pre><code>#!/bin/bash\n# security-scan.sh - \u672c\u5730\u955c\u50cf\u5b89\u5168\u626b\u63cf\u811a\u672c\n\nIMAGE_NAME=$1\nSCAN_REPORT_DIR=\"./security-reports\"\n\nif [ -z \"$IMAGE_NAME\" ]; then\n    echo \"Usage: $0 &lt;image-name&gt;\"\n    exit 1\nfi\n\nmkdir -p $SCAN_REPORT_DIR\n\necho \"\ud83d\udd0d \u5f00\u59cb\u5b89\u5168\u626b\u63cf: $IMAGE_NAME\"\n\n# Trivy\u6f0f\u6d1e\u626b\u63cf\necho \"\ud83d\udccb \u8fd0\u884cTrivy\u6f0f\u6d1e\u626b\u63cf...\"\ntrivy image \\\n    --format json \\\n    --output \"$SCAN_REPORT_DIR/trivy-$(date +%Y%m%d-%H%M%S).json\" \\\n    --severity HIGH,CRITICAL \\\n    $IMAGE_NAME\n\n# \u955c\u50cf\u914d\u7f6e\u626b\u63cf\necho \"\u2699\ufe0f \u68c0\u67e5\u955c\u50cf\u914d\u7f6e...\"\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n    goodwithtech/dockle:latest $IMAGE_NAME \\\n    &gt; \"$SCAN_REPORT_DIR/dockle-$(date +%Y%m%d-%H%M%S).txt\"\n\n# \u751f\u6210\u5b89\u5168\u62a5\u544a\u6458\u8981\necho \"\ud83d\udcca \u751f\u6210\u5b89\u5168\u62a5\u544a\u6458\u8981...\"\ncat &gt; \"$SCAN_REPORT_DIR/security-summary.txt\" &lt;&lt; EOF\n\u955c\u50cf\u5b89\u5168\u626b\u63cf\u62a5\u544a\n================\n\u955c\u50cf\u540d\u79f0: $IMAGE_NAME\n\u626b\u63cf\u65f6\u95f4: $(date)\n\u626b\u63cf\u5de5\u5177: Trivy, Dockle\n\n\u8be6\u7ec6\u62a5\u544a\u8bf7\u67e5\u770b\u540c\u76ee\u5f55\u4e0b\u7684\u5177\u4f53\u626b\u63cf\u7ed3\u679c\u6587\u4ef6\u3002\n\n\u5efa\u8bae\u7684\u5b89\u5168\u6539\u8fdb\u63aa\u65bd:\n1. \u5b9a\u671f\u66f4\u65b0\u57fa\u7840\u955c\u50cf\n2. \u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u5305\u548c\u6587\u4ef6\n3. \u4f7f\u7528\u975eroot\u7528\u6237\u8fd0\u884c\u5e94\u7528\n4. \u542f\u7528\u53ea\u8bfb\u6839\u6587\u4ef6\u7cfb\u7edf\n5. \u9650\u5236\u5bb9\u5668\u6743\u9650\u548c\u8d44\u6e90\u4f7f\u7528\nEOF\n\necho \"\u2705 \u5b89\u5168\u626b\u63cf\u5b8c\u6210\uff0c\u62a5\u544a\u4fdd\u5b58\u5728: $SCAN_REPORT_DIR\"\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#42","title":"4.2 \u8fd0\u884c\u65f6\u5b89\u5168\u76d1\u63a7","text":"<p>Falco\u89c4\u5219\u914d\u7f6e YAML<pre><code># falco-rules.yaml - \u81ea\u5b9a\u4e49\u5b89\u5168\u76d1\u63a7\u89c4\u5219\n- rule: Detect shell in container\n  desc: \u53d1\u73b0\u5bb9\u5668\u4e2d\u6267\u884cshell\u547d\u4ee4\n  condition: &gt;\n    spawned_process and container and\n    (proc.name in (bash, sh, zsh, fish, csh, ksh))\n  output: &gt;\n    Shell spawned in container\n    (user=%user.name container=%container.name shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)\n  priority: WARNING\n  tags: [container, shell, mitre_execution]\n\n- rule: Unexpected file access in container\n  desc: \u68c0\u6d4b\u5bb9\u5668\u4e2d\u5f02\u5e38\u6587\u4ef6\u8bbf\u95ee\n  condition: &gt;\n    open_write and container and\n    (fd.name startswith /etc/ or\n     fd.name startswith /root/ or\n     fd.name startswith /var/log/)\n  output: &gt;\n    Unexpected file write in container\n    (user=%user.name container=%container.name file=%fd.name)\n  priority: WARNING\n  tags: [container, filesystem]\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#5","title":"5. \u5e94\u6025\u54cd\u5e94\u548c\u4e8b\u4ef6\u5904\u7406","text":"","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#51","title":"5.1 \u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u6d41\u7a0b","text":"<p>\u5bb9\u5668\u5b89\u5168\u4e8b\u4ef6\u5904\u7406\u811a\u672c Bash<pre><code>#!/bin/bash\n# incident-response.sh - \u5bb9\u5668\u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u811a\u672c\n\nCONTAINER_ID=$1\nINCIDENT_TYPE=$2\nLOG_DIR=\"/var/log/security-incidents\"\n\nif [ -z \"$CONTAINER_ID\" ] || [ -z \"$INCIDENT_TYPE\" ]; then\n    echo \"Usage: $0 &lt;container-id&gt; &lt;incident-type&gt;\"\n    exit 1\nfi\n\nTIMESTAMP=$(date +%Y%m%d-%H%M%S)\nINCIDENT_DIR=\"$LOG_DIR/incident-$TIMESTAMP-$CONTAINER_ID\"\n\necho \"\ud83d\udea8 \u68c0\u6d4b\u5230\u5b89\u5168\u4e8b\u4ef6: $INCIDENT_TYPE\"\necho \"\ud83d\udcdd \u521b\u5efa\u4e8b\u4ef6\u8bb0\u5f55\u76ee\u5f55: $INCIDENT_DIR\"\nmkdir -p \"$INCIDENT_DIR\"\n\n# 1. \u5feb\u7167\u5bb9\u5668\u72b6\u6001\necho \"\ud83d\udcf8 \u4fdd\u5b58\u5bb9\u5668\u72b6\u6001\u5feb\u7167...\"\ndocker inspect $CONTAINER_ID &gt; \"$INCIDENT_DIR/container-inspect.json\"\ndocker logs $CONTAINER_ID &gt; \"$INCIDENT_DIR/container-logs.txt\" 2&gt;&amp;1\ndocker stats --no-stream $CONTAINER_ID &gt; \"$INCIDENT_DIR/container-stats.txt\"\n\n# 2. \u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\necho \"\ud83c\udf10 \u6536\u96c6\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f...\"\ndocker exec $CONTAINER_ID netstat -tulpn &gt; \"$INCIDENT_DIR/network-connections.txt\" 2&gt;/dev/null || echo \"\u65e0\u6cd5\u83b7\u53d6\u7f51\u7edc\u4fe1\u606f\" &gt; \"$INCIDENT_DIR/network-connections.txt\"\n\n# 3. \u8fdb\u7a0b\u4fe1\u606f\necho \"\u2699\ufe0f \u6536\u96c6\u8fdb\u7a0b\u4fe1\u606f...\"\ndocker exec $CONTAINER_ID ps aux &gt; \"$INCIDENT_DIR/process-list.txt\" 2&gt;/dev/null || echo \"\u65e0\u6cd5\u83b7\u53d6\u8fdb\u7a0b\u4fe1\u606f\" &gt; \"$INCIDENT_DIR/process-list.txt\"\n\n# 4. \u6587\u4ef6\u7cfb\u7edf\u53d8\u66f4\necho \"\ud83d\udcc1 \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\u53d8\u66f4...\"\ndocker diff $CONTAINER_ID &gt; \"$INCIDENT_DIR/filesystem-changes.txt\"\n\n# 5. \u6839\u636e\u4e8b\u4ef6\u7c7b\u578b\u91c7\u53d6\u76f8\u5e94\u63aa\u65bd\ncase $INCIDENT_TYPE in\n    \"malware\")\n        echo \"\ud83d\udee1\ufe0f \u68c0\u6d4b\u5230\u6076\u610f\u8f6f\u4ef6\uff0c\u7acb\u5373\u9694\u79bb\u5bb9\u5668...\"\n        docker pause $CONTAINER_ID\n        docker network disconnect bridge $CONTAINER_ID 2&gt;/dev/null\n        ;;\n    \"privilege_escalation\")\n        echo \"\u26a0\ufe0f \u68c0\u6d4b\u5230\u6743\u9650\u63d0\u5347\uff0c\u505c\u6b62\u5bb9\u5668...\"\n        docker stop $CONTAINER_ID\n        ;;\n    \"data_exfiltration\")\n        echo \"\ud83d\udd12 \u68c0\u6d4b\u5230\u6570\u636e\u5916\u6cc4\uff0c\u65ad\u5f00\u7f51\u7edc\u8fde\u63a5...\"\n        docker network disconnect bridge $CONTAINER_ID 2&gt;/dev/null\n        ;;\n    *)\n        echo \"\u2753 \u672a\u77e5\u4e8b\u4ef6\u7c7b\u578b\uff0c\u6267\u884c\u901a\u7528\u9694\u79bb\u63aa\u65bd...\"\n        docker pause $CONTAINER_ID\n        ;;\nesac\n\n# 6. \u751f\u6210\u4e8b\u4ef6\u62a5\u544a\ncat &gt; \"$INCIDENT_DIR/incident-report.txt\" &lt;&lt; EOF\n\u5bb9\u5668\u5b89\u5168\u4e8b\u4ef6\u62a5\u544a\n===============\n\u4e8b\u4ef6ID: incident-$TIMESTAMP-$CONTAINER_ID\n\u4e8b\u4ef6\u7c7b\u578b: $INCIDENT_TYPE\n\u53d1\u751f\u65f6\u95f4: $(date)\n\u53d7\u5f71\u54cd\u5bb9\u5668: $CONTAINER_ID\n\u54cd\u5e94\u63aa\u65bd: \u5df2\u6839\u636e\u4e8b\u4ef6\u7c7b\u578b\u91c7\u53d6\u76f8\u5e94\u9694\u79bb\u63aa\u65bd\n\n\u8be6\u7ec6\u4fe1\u606f\u8bf7\u67e5\u770b\u540c\u76ee\u5f55\u4e0b\u7684\u5176\u4ed6\u6587\u4ef6\uff1a\n- container-inspect.json: \u5bb9\u5668\u8be6\u7ec6\u914d\u7f6e\n- container-logs.txt: \u5bb9\u5668\u65e5\u5fd7\n- network-connections.txt: \u7f51\u7edc\u8fde\u63a5\u4fe1\u606f\n- process-list.txt: \u8fdb\u7a0b\u5217\u8868\n- filesystem-changes.txt: \u6587\u4ef6\u7cfb\u7edf\u53d8\u66f4\n\n\u5efa\u8bae\u540e\u7eed\u884c\u52a8:\n1. \u6df1\u5165\u5206\u6790\u5bb9\u5668\u955c\u50cf\u548c\u914d\u7f6e\n2. \u68c0\u67e5\u5bbf\u4e3b\u673a\u662f\u5426\u53d7\u5230\u5f71\u54cd\n3. \u66f4\u65b0\u5b89\u5168\u7b56\u7565\u548c\u76d1\u63a7\u89c4\u5219\n4. \u901a\u77e5\u76f8\u5173\u56e2\u961f\u548c\u7ba1\u7406\u5c42\nEOF\n\necho \"\u2705 \u4e8b\u4ef6\u54cd\u5e94\u5b8c\u6210\uff0c\u8be6\u7ec6\u4fe1\u606f\u4fdd\u5b58\u5728: $INCIDENT_DIR\"\necho \"\ud83d\udce7 \u5efa\u8bae\u901a\u77e5\u5b89\u5168\u56e2\u961f\u8fdb\u884c\u8fdb\u4e00\u6b65\u5206\u6790\"\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/#52","title":"5.2 \u5bb9\u5668\u53d6\u8bc1\u548c\u6062\u590d","text":"<p>\u5bb9\u5668\u53d6\u8bc1\u5de5\u5177 Bash<pre><code>#!/bin/bash\n# container-forensics.sh - \u5bb9\u5668\u53d6\u8bc1\u5206\u6790\u5de5\u5177\n\nCONTAINER_ID=$1\nFORENSICS_DIR=\"/var/forensics/$(date +%Y%m%d-%H%M%S)-$CONTAINER_ID\"\n\nmkdir -p \"$FORENSICS_DIR\"\n\necho \"\ud83d\udd0d \u5f00\u59cb\u5bb9\u5668\u53d6\u8bc1\u5206\u6790: $CONTAINER_ID\"\n\n# \u521b\u5efa\u5bb9\u5668\u955c\u50cf\u5feb\u7167\necho \"\ud83d\udcf8 \u521b\u5efa\u5bb9\u5668\u955c\u50cf\u5feb\u7167...\"\ndocker commit $CONTAINER_ID forensics-snapshot:$CONTAINER_ID-$(date +%s)\n\n# \u5bfc\u51fa\u5bb9\u5668\u6587\u4ef6\u7cfb\u7edf\necho \"\ud83d\udcbe \u5bfc\u51fa\u5bb9\u5668\u6587\u4ef6\u7cfb\u7edf...\"\ndocker export $CONTAINER_ID | tar -xC \"$FORENSICS_DIR/filesystem/\"\n\n# \u5206\u6790\u5bb9\u5668\u5143\u6570\u636e\necho \"\ud83d\udccb \u5206\u6790\u5bb9\u5668\u5143\u6570\u636e...\"\ndocker inspect $CONTAINER_ID | jq . &gt; \"$FORENSICS_DIR/metadata.json\"\n\n# \u63d0\u53d6\u5173\u952e\u65e5\u5fd7\u548c\u914d\u7f6e\u6587\u4ef6\necho \"\ud83d\udcc4 \u63d0\u53d6\u5173\u952e\u6587\u4ef6...\"\nCRITICAL_PATHS=(\"/etc/passwd\" \"/etc/shadow\" \"/var/log\" \"/root/.bash_history\" \"/home/*/.bash_history\")\nfor path in \"${CRITICAL_PATHS[@]}\"; do\n    if [ -f \"$FORENSICS_DIR/filesystem$path\" ]; then\n        cp -r \"$FORENSICS_DIR/filesystem$path\" \"$FORENSICS_DIR/critical-files/\" 2&gt;/dev/null\n    fi\ndone\n\necho \"\u2705 \u53d6\u8bc1\u5206\u6790\u5b8c\u6210\uff0c\u6570\u636e\u4fdd\u5b58\u5728: $FORENSICS_DIR\"\n</code></pre></p>","tags":["\u5bb9\u5668\u5b89\u5168","Docker","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4\u5b89\u5168","\u7cfb\u7edf\u5b89\u5168"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/","title":"\u7cfb\u7edf\u57fa\u7840\u5b89\u5168\u52a0\u56fa","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_2","title":"\ud83d\udccb \u52a0\u56fa\u68c0\u67e5\u6e05\u5355","text":"<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u8bf7\u786e\u8ba4\u60a8\u7684\u52a0\u56fa\u76ee\u6807\u548c\u5f53\u524d\u7cfb\u7edf\u72b6\u6001\uff1a</p> <ul> <li> \u786e\u8ba4\u7cfb\u7edf\u7248\u672c\u548c\u67b6\u6784</li> <li> \u5907\u4efd\u5173\u952e\u914d\u7f6e\u6587\u4ef6</li> <li> \u51c6\u5907\u5e94\u6025\u6062\u590d\u65b9\u6848</li> <li> \u901a\u77e5\u76f8\u5173\u4eba\u5458\u7ef4\u62a4\u7a97\u53e3</li> </ul>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#1","title":"1. \u7cfb\u7edf\u66f4\u65b0\u548c\u8865\u4e01\u7ba1\u7406 \ud83d\udd04","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#11","title":"1.1 \u4fdd\u6301\u7cfb\u7edf\u66f4\u65b0","text":"CentOS/RHEL 8+CentOS/RHEL 7Ubuntu/Debian Bash<pre><code># \u67e5\u770b\u7cfb\u7edf\u7248\u672c\ncat /etc/redhat-release\n\n# \u67e5\u770b\u53ef\u66f4\u65b0\u7684\u8f6f\u4ef6\u5305\ndnf list updates\n\n# \u66f4\u65b0\u6240\u6709\u8f6f\u4ef6\u5305\ndnf update -y\n\n# \u53ea\u66f4\u65b0\u5b89\u5168\u8865\u4e01\ndnf --security update\n\n# \u67e5\u770b\u66f4\u65b0\u5386\u53f2\ndnf history list\n</code></pre> Bash<pre><code># \u67e5\u770b\u53ef\u66f4\u65b0\u7684\u8f6f\u4ef6\u5305\nyum list updates\n\n# \u66f4\u65b0\u6240\u6709\u8f6f\u4ef6\u5305\nyum update -y\n\n# \u53ea\u66f4\u65b0\u5b89\u5168\u8865\u4e01\nyum --security update\n\n# \u5b89\u88c5yum-security\u63d2\u4ef6\uff08\u5982\u679c\u9700\u8981\uff09\nyum install yum-plugin-security -y\n</code></pre> Bash<pre><code># \u66f4\u65b0\u8f6f\u4ef6\u5305\u5217\u8868\napt update\n\n# \u67e5\u770b\u53ef\u5347\u7ea7\u7684\u5305\napt list --upgradable\n\n# \u5347\u7ea7\u6240\u6709\u8f6f\u4ef6\u5305\napt upgrade -y\n\n# \u5b8c\u6574\u5347\u7ea7\uff08\u5305\u62ec\u5185\u6838\uff09\napt full-upgrade -y\n\n# \u6e05\u7406\u4e0d\u9700\u8981\u7684\u5305\napt autoremove -y\napt autoclean\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#12","title":"1.2 \u914d\u7f6e\u81ea\u52a8\u66f4\u65b0","text":"CentOS/RHEL 8+CentOS/RHEL 7Ubuntu/Debian Bash<pre><code># \u5b89\u88c5\u5e76\u914d\u7f6ednf-automatic\ndnf install dnf-automatic -y\n\n# \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\nvim /etc/dnf/automatic.conf\n# \u5173\u952e\u914d\u7f6e\uff1a\n# apply_updates = yes\n# upgrade_type = security\n# email_to = admin@yourdomain.com\n# email_from = system@yourdomain.com\n\n# \u542f\u7528\u670d\u52a1\nsystemctl enable --now dnf-automatic.timer\nsystemctl status dnf-automatic.timer\n</code></pre> Bash<pre><code>yum install yum-cron -y\nsystemctl enable yum-cron\nsystemctl start yum-cron\n\n# \u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\nvim /etc/yum/yum-cron.conf\n# \u8bbe\u7f6e\u4ee5\u4e0b\u53c2\u6570\uff1a\n# apply_updates = yes\n# update_cmd = security\n# email_to = admin@yourdomain.com\n# email_from = root@localhost\n</code></pre> Bash<pre><code>apt install unattended-upgrades apt-listchanges -y\ndpkg-reconfigure -plow unattended-upgrades\n\n# \u8be6\u7ec6\u914d\u7f6e\ncat &gt; /etc/apt/apt.conf.d/50unattended-upgrades &lt;&lt; EOF\nUnattended-Upgrade::Allowed-Origins {\n    \"\\${distro_id}:\\${distro_codename}-security\";\n    \"\\${distro_id}ESMApps:\\${distro_codename}-apps-security\";\n    \"\\${distro_id}ESM:\\${distro_codename}-infra-security\";\n};\n\n// \u81ea\u52a8\u91cd\u542f\u914d\u7f6e\nUnattended-Upgrade::Automatic-Reboot \"false\";\nUnattended-Upgrade::Automatic-Reboot-WithUsers \"false\";\nUnattended-Upgrade::Automatic-Reboot-Time \"02:00\";\n\n// \u90ae\u4ef6\u901a\u77e5\nUnattended-Upgrade::Mail \"admin@yourdomain.com\";\nUnattended-Upgrade::MailReport \"on-change\";\n\n// \u65e5\u5fd7\u548c\u6e05\u7406\nUnattended-Upgrade::AutoFixInterruptedDpkg \"true\";\nUnattended-Upgrade::MinimalSteps \"true\";\nUnattended-Upgrade::Remove-Unused-Dependencies \"true\";\nUnattended-Upgrade::Remove-New-Unused-Dependencies \"true\";\nEOF\n\n# \u914d\u7f6e\u5b9a\u65f6\u4efb\u52a1\u9891\u7387\nvim /etc/apt/apt.conf.d/20auto-upgrades\n# APT::Periodic::Update-Package-Lists \"1\";\n# APT::Periodic::Unattended-Upgrade \"1\";\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#13","title":"1.3 \u5185\u6838\u5b89\u5168\u914d\u7f6e","text":"Bash<pre><code># \u67e5\u770b\u5f53\u524d\u5185\u6838\u7248\u672c\nuname -r\n\n# \u914d\u7f6e\u5185\u6838\u5b89\u5168\u53c2\u6570\ncat &gt;&gt; /etc/sysctl.d/99-security.conf &lt;&lt; EOF\n# \u6838\u5fc3\u8f6c\u50a8\u9650\u5236\nfs.suid_dumpable = 0\nkernel.core_uses_pid = 1\n\n# \u5185\u5b58\u4fdd\u62a4\nkernel.exec-shield = 1\nkernel.randomize_va_space = 2\n\n# \u8fdb\u7a0b\u9650\u5236\nkernel.pid_max = 65536\n\n# dmesg\u9650\u5236\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\n\n# \u6027\u80fd\u4e8b\u4ef6\u9650\u5236\nkernel.perf_event_paranoid = 3\n\n# \u7528\u6237\u547d\u540d\u7a7a\u95f4\u9650\u5236 (\u5982\u679c\u4e0d\u4f7f\u7528\u5bb9\u5668)\n# user.max_user_namespaces = 0\nEOF\n\n# \u5e94\u7528\u914d\u7f6e\nsysctl -p /etc/sysctl.d/99-security.conf\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#2","title":"2. \u7528\u6237\u548c\u6743\u9650\u7ba1\u7406 \ud83d\udc65","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#21","title":"2.1 \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u7528\u6237\u8d26\u6237","text":"Bash<pre><code># \u67e5\u770b\u7cfb\u7edf\u6240\u6709\u7528\u6237\ngetent passwd\n\n# \u67e5\u770b\u53ef\u767b\u5f55\u7684\u7528\u6237\ngetent passwd | grep -E \"/bin/bash|/bin/sh|/bin/zsh\"\n\n# \u67e5\u770b\u6700\u8fd1\u767b\u5f55\u7528\u6237\nlastlog | grep -v \"Never\"\n\n# \u7981\u7528\u7cfb\u7edf\u670d\u52a1\u8d26\u6237\u7684shell\nfor user in games ftp news uucp operator gopher; do\n    if id \"$user\" &gt;/dev/null 2&gt;&amp;1; then\n        usermod -s /sbin/nologin \"$user\"\n        echo \"\u5df2\u7981\u7528\u7528\u6237: $user\"\n    fi\ndone\n\n# \u9501\u5b9a\u957f\u671f\u672a\u4f7f\u7528\u7684\u8d26\u6237\nlastlog -b 90 | awk 'NR&gt;1 &amp;&amp; $1 != \"root\" {print $1}' | while read user; do\n    if id \"$user\" &gt;/dev/null 2&gt;&amp;1; then\n        usermod -L \"$user\"\n        echo \"\u5df2\u9501\u5b9a\u957f\u671f\u672a\u4f7f\u7528\u7684\u8d26\u6237: $user\"\n    fi\ndone\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#22","title":"2.2 \u5f3a\u5316\u5bc6\u7801\u7b56\u7565","text":"Bash<pre><code># \u5b89\u88c5\u5bc6\u7801\u8d28\u91cf\u68c0\u67e5\u5de5\u5177\nif command -v yum &gt;/dev/null 2&gt;&amp;1; then\n    yum install libpwquality cracklib-dicts -y\nelif command -v apt &gt;/dev/null 2&gt;&amp;1; then\n    apt install libpam-pwquality cracklib-runtime -y\nfi\n\n# \u914d\u7f6e\u5bc6\u7801\u590d\u6742\u5ea6\ncat &gt; /etc/security/pwquality.conf &lt;&lt; EOF\n# \u5bc6\u7801\u6700\u5c0f\u957f\u5ea6\nminlen = 14\n\n# \u81f3\u5c11\u5305\u542b\u7684\u5b57\u7b26\u7c7b\u578b\u6570\u91cf\nminclass = 4\n\n# \u6700\u5927\u91cd\u590d\u5b57\u7b26\u6570\nmaxrepeat = 2\n\n# \u6700\u5927\u8fde\u7eed\u5b57\u7b26\u6570\nmaxsequence = 3\n\n# \u6570\u5b57\u5b57\u7b26\u8981\u6c42\uff08\u8d1f\u6570\u8868\u793a\u81f3\u5c11\u5305\u542b\uff09\ndcredit = -1\n\n# \u5927\u5199\u5b57\u6bcd\u8981\u6c42\nucredit = -1\n\n# \u5c0f\u5199\u5b57\u6bcd\u8981\u6c42\nlcredit = -1\n\n# \u7279\u6b8a\u5b57\u7b26\u8981\u6c42\nocredit = -1\n\n# \u7981\u6b62\u5305\u542b\u7528\u6237\u540d\nusercheck = 1\n\n# \u7981\u6b62\u4f7f\u7528\u5b57\u5178\u8bcd\u6c47\ndictcheck = 1\n\n# \u4e0e\u65e7\u5bc6\u7801\u7684\u6700\u5c0f\u5dee\u5f02\ndifok = 5\nEOF\n\n# \u914d\u7f6e\u767b\u5f55\u53c2\u6570\nvim /etc/login.defs\n# \u786e\u4fdd\u4ee5\u4e0b\u53c2\u6570\u8bbe\u7f6e\u6b63\u786e\uff1a\nsed -i 's/^PASS_MAX_DAYS.*/PASS_MAX_DAYS   90/' /etc/login.defs\nsed -i 's/^PASS_MIN_DAYS.*/PASS_MIN_DAYS   7/' /etc/login.defs\nsed -i 's/^PASS_MIN_LEN.*/PASS_MIN_LEN    14/' /etc/login.defs\nsed -i 's/^PASS_WARN_AGE.*/PASS_WARN_AGE   14/' /etc/login.defs\n\n# \u914d\u7f6e\u8d26\u6237\u9501\u5b9a\u7b56\u7565\nif [ -f /etc/pam.d/system-auth ]; then\n    # RHEL/CentOS\n    PAM_FILE=\"/etc/pam.d/system-auth\"\nelse\n    # Ubuntu/Debian\n    PAM_FILE=\"/etc/pam.d/common-auth\"\nfi\n\n# \u5907\u4efd\u539f\u6587\u4ef6\ncp $PAM_FILE ${PAM_FILE}.backup\n\n# \u6dfb\u52a0\u8d26\u6237\u9501\u5b9a\u914d\u7f6e\uff085\u6b21\u5931\u8d25\u540e\u9501\u5b9a10\u5206\u949f\uff09\necho \"auth required pam_faillock.so preauth deny=5 unlock_time=600\" &gt;&gt; $PAM_FILE\necho \"auth sufficient pam_faillock.so authfail deny=5 unlock_time=600\" &gt;&gt; $PAM_FILE\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#23-sudo","title":"2.3 \u914d\u7f6esudo\u6743\u9650\u548c\u5ba1\u8ba1","text":"Bash<pre><code># \u5907\u4efdsudoers\u6587\u4ef6\ncp /etc/sudoers /etc/sudoers.backup.$(date +%Y%m%d)\n\n# \u914d\u7f6esudo\u5b89\u5168\u9009\u9879\ncat &gt;&gt; /etc/sudoers &lt;&lt; 'EOF'\n# \u65e5\u5fd7\u914d\u7f6e\nDefaults logfile=/var/log/sudo.log\nDefaults log_year, log_host, log_input, log_output\nDefaults iolog_dir=/var/log/sudo-io\nDefaults log_input, log_output\n\n# \u5b89\u5168\u9009\u9879\nDefaults requiretty\nDefaults env_reset\nDefaults secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nDefaults timestamp_timeout=15\nDefaults passwd_timeout=5\nDefaults passwd_tries=3\n\n# \u7981\u6b62\u5371\u9669\u547d\u4ee4\nDefaults passwd_tries=3\nCmnd_Alias DANGEROUS = /bin/su, /usr/bin/passwd root, /bin/chmod 777 *, /bin/chown root *\nALL ALL = !DANGEROUS\nEOF\n\n# \u521b\u5efasudo\u65e5\u5fd7\u8f6e\u8f6c\u914d\u7f6e\ncat &gt; /etc/logrotate.d/sudo &lt;&lt; EOF\n/var/log/sudo.log {\n    weekly\n    rotate 52\n    compress\n    delaycompress\n    missingok\n    notifempty\n    create 0640 root root\n}\n\n/var/log/sudo-io/*/*.log {\n    weekly\n    rotate 52\n    compress\n    delaycompress\n    missingok\n    notifempty\n}\nEOF\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#24","title":"2.4 \u914d\u7f6e\u7528\u6237\u4f1a\u8bdd\u9650\u5236","text":"Bash<pre><code># \u914d\u7f6e\u7528\u6237\u8d44\u6e90\u9650\u5236\ncat &gt;&gt; /etc/security/limits.conf &lt;&lt; EOF\n# \u8fdb\u7a0b\u6570\u9650\u5236\n* soft nproc 4096\n* hard nproc 8192\n\n# \u6587\u4ef6\u53e5\u67c4\u9650\u5236\n* soft nofile 65536\n* hard nofile 65536\n\n# \u5185\u5b58\u4f7f\u7528\u9650\u5236\uff08\u4ee5KB\u4e3a\u5355\u4f4d\uff09\n* soft as 4194304\n* hard as 8388608\n\n# CPU\u65f6\u95f4\u9650\u5236\uff08\u5206\u949f\uff09\n* soft cpu 30\n* hard cpu 60\n\n# \u9632\u6b62fork\u70b8\u5f39\n* hard maxlogins 3\nEOF\n\n# \u914d\u7f6e\u4f1a\u8bdd\u8d85\u65f6\necho \"TMOUT=900\" &gt;&gt; /etc/profile\necho \"readonly TMOUT\" &gt;&gt; /etc/profile\necho \"export TMOUT\" &gt;&gt; /etc/profile\n\n# \u914d\u7f6e\u767b\u5f55\u5931\u8d25\u5ef6\u8fdf\necho \"FAIL_DELAY 3\" &gt;&gt; /etc/login.defs\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#3","title":"3. \u6587\u4ef6\u7cfb\u7edf\u5b89\u5168 \ud83d\udcc1","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#31","title":"3.1 \u8bbe\u7f6e\u5173\u952e\u6587\u4ef6\u6743\u9650","text":"Bash<pre><code>#!/bin/bash\n# \u7cfb\u7edf\u6587\u4ef6\u6743\u9650\u52a0\u56fa\u811a\u672c\n\necho \"\u5f00\u59cb\u6587\u4ef6\u6743\u9650\u52a0\u56fa...\"\n\n# \u5173\u952e\u7cfb\u7edf\u6587\u4ef6\u6743\u9650\u8bbe\u7f6e\ndeclare -A file_permissions=(\n    [\"/etc/passwd\"]=\"644\"\n    [\"/etc/group\"]=\"644\"\n    [\"/etc/shadow\"]=\"000\"\n    [\"/etc/gshadow\"]=\"000\"\n    [\"/etc/ssh/sshd_config\"]=\"600\"\n    [\"/etc/crontab\"]=\"600\"\n    [\"/etc/sudoers\"]=\"440\"\n    [\"/boot/grub2/grub.cfg\"]=\"600\"\n    [\"/boot/grub/grub.cfg\"]=\"600\"\n)\n\nfor file in \"${!file_permissions[@]}\"; do\n    if [ -f \"$file\" ]; then\n        chmod \"${file_permissions[$file]}\" \"$file\"\n        echo \"\u5df2\u8bbe\u7f6e $file \u6743\u9650\u4e3a ${file_permissions[$file]}\"\n    fi\ndone\n\n# \u67e5\u627e\u5e76\u4fee\u590d\u6743\u9650\u8fc7\u4e8e\u5bbd\u677e\u7684\u6587\u4ef6\necho \"\u67e5\u627e\u6743\u9650\u8fc7\u4e8e\u5bbd\u677e\u7684\u6587\u4ef6...\"\nfind /etc -type f -perm -002 -exec chmod o-w {} \\; 2&gt;/dev/null\nfind /etc -type f -perm -020 -exec chmod g-w {} \\; 2&gt;/dev/null\n\n# \u67e5\u627eSUID\u548cSGID\u6587\u4ef6\necho \"\u626b\u63cfSUID/SGID\u6587\u4ef6...\"\nfind / -type f \\( -perm -4000 -o -perm -2000 \\) -exec ls -la {} \\; 2&gt;/dev/null &gt; /tmp/suid_sgid_files.txt\n\n# \u79fb\u9664\u4e0d\u5fc5\u8981\u7684SUID\u4f4d\nunnecessary_suid_files=\"/usr/bin/chage /usr/bin/gpasswd /usr/bin/wall /usr/bin/chfn /usr/bin/chsh /usr/bin/newgrp /usr/bin/write\"\nfor file in $unnecessary_suid_files; do\n    if [ -f \"$file\" ]; then\n        chmod u-s \"$file\"\n        echo \"\u5df2\u79fb\u9664 $file \u7684SUID\u4f4d\"\n    fi\ndone\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#32","title":"3.2 \u78c1\u76d8\u6302\u8f7d\u5b89\u5168\u9009\u9879","text":"Bash<pre><code># \u68c0\u67e5\u5f53\u524d\u6302\u8f7d\u9009\u9879\nmount | column -t\n\n# \u521b\u5efa\u5b89\u5168\u7684fstab\u5907\u4efd\ncp /etc/fstab /etc/fstab.backup.$(date +%Y%m%d)\n\n# \u4e3a\u4e34\u65f6\u76ee\u5f55\u6dfb\u52a0\u5b89\u5168\u6302\u8f7d\u9009\u9879\ncat &gt;&gt; /etc/fstab &lt;&lt; EOF\n# \u5b89\u5168\u6302\u8f7d\u9009\u9879\ntmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0\ntmpfs /var/tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=1G 0 0\ntmpfs /dev/shm tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=1G 0 0\nEOF\n\n# \u7acb\u5373\u5e94\u7528\u6302\u8f7d\nmount -o remount,nodev,nosuid,noexec /tmp\nmount -o remount,nodev,nosuid,noexec /var/tmp\nmount -o remount,nodev,nosuid,noexec /dev/shm\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#33","title":"3.3 \u6587\u4ef6\u5b8c\u6574\u6027\u76d1\u63a7","text":"Bash<pre><code># \u5b89\u88c5AIDE\nif command -v yum &gt;/dev/null 2&gt;&amp;1; then\n    yum install aide -y\nelif command -v apt &gt;/dev/null 2&gt;&amp;1; then\n    apt install aide aide-common -y\nfi\n\n# \u914d\u7f6eAIDE\ncat &gt; /etc/aide.conf &lt;&lt; EOF\n# AIDE\u914d\u7f6e\u6587\u4ef6\ndatabase=file:/var/lib/aide/aide.db\ndatabase_out=file:/var/lib/aide/aide.db.new\ngzip_dbout=yes\n\n# \u5b9a\u4e49\u68c0\u67e5\u89c4\u5219\nBinlib = p+i+n+u+g+s+b+m+c+md5+sha1\nConfFiles = p+i+n+u+g+s+b+m+c+md5+sha1\nLogs = p+i+n+u+g+S\nDevices = p+i+n+u+g+s+b+c+md5+sha1\n\n# \u76d1\u63a7\u76ee\u5f55\n/boot Binlib\n/bin Binlib\n/sbin Binlib\n/usr/bin Binlib\n/usr/sbin Binlib\n/usr/libexec Binlib\n/usr/local/bin Binlib\n/usr/local/sbin Binlib\n\n# \u914d\u7f6e\u6587\u4ef6\n/etc ConfFiles\n!/etc/mtab\n\n# \u65e5\u5fd7\u6587\u4ef6\n/var/log Logs\n!/var/log/.*\nEOF\n\n# \u521d\u59cb\u5316AIDE\u6570\u636e\u5e93\naide --init\nmv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n\n# \u521b\u5efa\u6bcf\u65e5\u68c0\u67e5\u811a\u672c\ncat &gt; /etc/cron.daily/aide-check &lt;&lt; 'EOF'\n#!/bin/bash\nLOGFILE=\"/var/log/aide-check.log\"\nDATE=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"[$DATE] \u5f00\u59cbAIDE\u6587\u4ef6\u5b8c\u6574\u6027\u68c0\u67e5\" &gt;&gt; $LOGFILE\n\nif /usr/bin/aide --check &gt;&gt; $LOGFILE 2&gt;&amp;1; then\n    echo \"[$DATE] AIDE\u68c0\u67e5\u5b8c\u6210\uff0c\u672a\u53d1\u73b0\u53d8\u5316\" &gt;&gt; $LOGFILE\nelse\n    echo \"[$DATE] AIDE\u68c0\u67e5\u53d1\u73b0\u6587\u4ef6\u53d8\u5316\uff0c\u8bf7\u67e5\u770b\u8be6\u7ec6\u65e5\u5fd7\" &gt;&gt; $LOGFILE\n    # \u53d1\u9001\u90ae\u4ef6\u901a\u77e5\uff08\u5982\u679c\u914d\u7f6e\u4e86\u90ae\u4ef6\u7cfb\u7edf\uff09\n    if command -v mail &gt;/dev/null 2&gt;&amp;1; then\n        tail -50 $LOGFILE | mail -s \"AIDE Alert - $(hostname)\" admin@yourdomain.com\n    fi\nfi\n\necho \"[$DATE] AIDE\u68c0\u67e5\u7ed3\u675f\" &gt;&gt; $LOGFILE\necho \"----------------------------------------\" &gt;&gt; $LOGFILE\nEOF\n\nchmod +x /etc/cron.daily/aide-check\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#4","title":"4. \u670d\u52a1\u548c\u8fdb\u7a0b\u5b89\u5168 \u2699\ufe0f","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#41","title":"4.1 \u670d\u52a1\u7ba1\u7406\u548c\u6700\u5c0f\u5316","text":"Bash<pre><code>#!/bin/bash\n# \u670d\u52a1\u5b89\u5168\u914d\u7f6e\u811a\u672c\n\necho \"\u5f53\u524d\u8fd0\u884c\u7684\u670d\u52a1\uff1a\"\nsystemctl list-units --type=service --state=running\n\n# \u5b9a\u4e49\u901a\u5e38\u53ef\u4ee5\u7981\u7528\u7684\u670d\u52a1\nunnecessary_services=(\n    \"bluetooth\"\n    \"cups\"\n    \"avahi-daemon\"\n    \"postfix\"\n    \"sendmail\"\n    \"rpcbind\"\n    \"nfs\"\n    \"smb\"\n    \"nmb\"\n    \"telnet\"\n    \"rsh\"\n    \"rlogin\"\n)\n\necho \"\u6b63\u5728\u7981\u7528\u4e0d\u5fc5\u8981\u7684\u670d\u52a1...\"\nfor service in \"${unnecessary_services[@]}\"; do\n    if systemctl is-enabled \"$service\" &gt;/dev/null 2&gt;&amp;1; then\n        systemctl disable \"$service\"\n        systemctl stop \"$service\"\n        echo \"\u5df2\u7981\u7528\u670d\u52a1: $service\"\n    fi\ndone\n\n# \u68c0\u67e5\u76d1\u542c\u7aef\u53e3\necho \"\u5f53\u524d\u76d1\u542c\u7684\u7aef\u53e3\uff1a\"\nss -tulnp | grep LISTEN\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#42","title":"4.2 \u8fdb\u7a0b\u8d44\u6e90\u9650\u5236","text":"Bash<pre><code># \u914d\u7f6esystemd\u670d\u52a1\u8d44\u6e90\u9650\u5236\nmkdir -p /etc/systemd/system.conf.d\ncat &gt; /etc/systemd/system.conf.d/security.conf &lt;&lt; EOF\n[Manager]\n# \u9ed8\u8ba4\u670d\u52a1\u9650\u5236\nDefaultLimitNOFILE=65536\nDefaultLimitNPROC=4096\nDefaultLimitCORE=0\nDefaultLimitAS=4294967296\n\n# \u8d85\u65f6\u8bbe\u7f6e\nDefaultTimeoutStopSec=30s\nDefaultTimeoutStartSec=30s\nEOF\n\nsystemctl daemon-reload\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#5","title":"5. \u7f51\u7edc\u5b89\u5168\u57fa\u7840\u914d\u7f6e \ud83c\udf10","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#51","title":"5.1 \u7f51\u7edc\u53c2\u6570\u5b89\u5168\u4f18\u5316","text":"Bash<pre><code># \u521b\u5efa\u7f51\u7edc\u5b89\u5168\u914d\u7f6e\ncat &gt; /etc/sysctl.d/10-network-security.conf &lt;&lt; EOF\n# TCP/IP\u5b89\u5168\u914d\u7f6e\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_syn_retries = 2\nnet.ipv4.tcp_synack_retries = 2\nnet.ipv4.tcp_max_syn_backlog = 4096\n\n# IP\u8f6c\u53d1\u63a7\u5236\nnet.ipv4.ip_forward = 0\nnet.ipv6.conf.all.forwarding = 0\n\n# \u6e90\u8def\u7531\u4fdd\u62a4\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\n# ICMP\u91cd\u5b9a\u5411\u4fdd\u62a4\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv6.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv6.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n# IP\u6b3a\u9a97\u4fdd\u62a4\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\n# \u8bb0\u5f55\u53ef\u7591\u5305\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\n# ICMP\u63a7\u5236\nnet.ipv4.icmp_echo_ignore_all = 0\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\n# IPv6\u5b89\u5168\uff08\u5982\u679c\u4e0d\u4f7f\u7528IPv6\u53ef\u4ee5\u7981\u7528\uff09\nnet.ipv6.conf.all.disable_ipv6 = 0\nnet.ipv6.conf.default.disable_ipv6 = 0\nnet.ipv6.conf.all.accept_ra = 0\nnet.ipv6.conf.default.accept_ra = 0\nEOF\n\n# \u5e94\u7528\u914d\u7f6e\nsysctl -p /etc/sysctl.d/10-network-security.conf\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#6","title":"6. \u7cfb\u7edf\u76d1\u63a7\u548c\u5ba1\u8ba1 \ud83d\udcca","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#61","title":"6.1 \u5ba1\u8ba1\u7cfb\u7edf\u914d\u7f6e","text":"Bash<pre><code># \u5b89\u88c5\u5e76\u914d\u7f6eauditd\nif command -v yum &gt;/dev/null 2&gt;&amp;1; then\n    yum install audit audit-libs -y\nelif command -v apt &gt;/dev/null 2&gt;&amp;1; then\n    apt install auditd audispd-plugins -y\nfi\n\n# \u542f\u7528\u5ba1\u8ba1\u670d\u52a1\nsystemctl enable auditd\nsystemctl start auditd\n\n# \u914d\u7f6e\u8be6\u7ec6\u7684\u5ba1\u8ba1\u89c4\u5219\ncat &gt; /etc/audit/rules.d/security.rules &lt;&lt; EOF\n# \u5220\u9664\u6240\u6709\u73b0\u6709\u89c4\u5219\n-D\n\n# \u8bbe\u7f6e\u7f13\u51b2\u533a\u5927\u5c0f\n-b 8192\n\n# \u5931\u8d25\u5904\u7406\n-f 1\n\n# \u76d1\u63a7\u8eab\u4efd\u76f8\u5173\u6587\u4ef6\n-w /etc/passwd -p wa -k identity\n-w /etc/group -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n\n# \u76d1\u63a7\u6743\u9650\u76f8\u5173\u6587\u4ef6\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d/ -p wa -k scope\n\n# \u76d1\u63a7\u767b\u5f55\u76f8\u5173\n-w /var/log/lastlog -p wa -k logins\n-w /var/log/faillog -p wa -k logins\n-w /var/log/wtmp -p wa -k logins\n-w /var/log/btmp -p wa -k logins\n\n# \u76d1\u63a7\u7f51\u7edc\u914d\u7f6e\n-a always,exit -F arch=b64 -S sethostname -S setdomainname -k network\n-a always,exit -F arch=b32 -S sethostname -S setdomainname -k network\n-w /etc/hosts -p wa -k network\n-w /etc/network/ -p wa -k network\n\n# \u76d1\u63a7\u65f6\u95f4\u66f4\u6539\n-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change\n-a always,exit -F arch=b32 -S adjtimex -S settimeofday -k time-change\n-w /etc/localtime -p wa -k time-change\n\n# \u76d1\u63a7MAC\u7b56\u7565\n-w /etc/selinux/ -p wa -k MAC-policy\n\n# \u76d1\u63a7\u6587\u4ef6\u6743\u9650\u4fee\u6539\n-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -k perm_mod\n-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -k perm_mod\n-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -k perm_mod\n-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -k perm_mod\n\n# \u76d1\u63a7\u6587\u4ef6\u8bbf\u95ee\n-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -k file_access\n-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -k file_access\n\n# \u76d1\u63a7\u6302\u8f7d\u64cd\u4f5c\n-a always,exit -F arch=b64 -S mount -k mounts\n-a always,exit -F arch=b32 -S mount -k mounts\n\n# \u76d1\u63a7\u6587\u4ef6\u5220\u9664\n-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -k delete\n-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -k delete\n\n# \u76d1\u63a7\u5185\u6838\u6a21\u5757\n-w /sbin/insmod -p x -k modules\n-w /sbin/rmmod -p x -k modules\n-w /sbin/modprobe -p x -k modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n\n# \u9501\u5b9a\u89c4\u5219\u914d\u7f6e\n-e 2\nEOF\n\n# \u91cd\u65b0\u52a0\u8f7d\u5ba1\u8ba1\u89c4\u5219\naugenrules --load\nsystemctl restart auditd\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#62","title":"6.2 \u7cfb\u7edf\u76d1\u63a7\u811a\u672c","text":"Bash<pre><code># \u521b\u5efa\u7efc\u5408\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/system-security-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u914d\u7f6e\nLOG_FILE=\"/var/log/security-monitor.log\"\nALERT_EMAIL=\"admin@yourdomain.com\"\nCPU_THRESHOLD=80\nMEMORY_THRESHOLD=80\nDISK_THRESHOLD=90\n\n# \u989c\u8272\u8f93\u51fa\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m' # No Color\n\n# \u65e5\u5fd7\u51fd\u6570\nlog_message() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a $LOG_FILE\n}\n\n# \u68c0\u67e5CPU\u4f7f\u7528\u7387\ncheck_cpu() {\n    CPU_USAGE=$(top -bn1 | grep \"Cpu(s)\" | awk '{print $2}' | sed 's/%us,//')\n    CPU_USAGE=${CPU_USAGE%.*}\n\n    if [ $CPU_USAGE -gt $CPU_THRESHOLD ]; then\n        log_message \"${RED}\u26a0\ufe0f  CPU\u4f7f\u7528\u7387\u8fc7\u9ad8: ${CPU_USAGE}%${NC}\"\n        return 1\n    else\n        log_message \"${GREEN}\u2705 CPU\u4f7f\u7528\u7387\u6b63\u5e38: ${CPU_USAGE}%${NC}\"\n        return 0\n    fi\n}\n\n# \u68c0\u67e5\u53ef\u7591\u8fdb\u7a0b\ncheck_suspicious_processes() {\n    log_message \"\ud83d\udd0d \u68c0\u67e5\u53ef\u7591\u8fdb\u7a0b...\"\n\n    # \u68c0\u67e5\u9ad8CPU\u4f7f\u7528\u7387\u8fdb\u7a0b\n    HIGH_CPU_PROCS=$(ps aux --sort=-%cpu | head -6 | tail -5)\n    log_message \"CPU\u4f7f\u7528\u7387\u6700\u9ad8\u7684\u8fdb\u7a0b:\"\n    echo \"$HIGH_CPU_PROCS\" &gt;&gt; $LOG_FILE\n\n    # \u68c0\u67e5\u53ef\u7591\u7f51\u7edc\u8fde\u63a5\n    SUSPICIOUS_CONNECTIONS=$(netstat -tuln | grep -E ':22[0-9][0-9]|:3[0-9][0-9][0-9][0-9]|:4[4-9][0-9][0-9][0-9]')\n    if [ ! -z \"$SUSPICIOUS_CONNECTIONS\" ]; then\n        log_message \"${YELLOW}\u26a0\ufe0f  \u53d1\u73b0\u53ef\u7591\u7aef\u53e3\u76d1\u542c:${NC}\"\n        echo \"$SUSPICIOUS_CONNECTIONS\" &gt;&gt; $LOG_FILE\n    fi\n}\n\n# \u68c0\u67e5\u7cfb\u7edf\u5b8c\u6574\u6027\ncheck_system_integrity() {\n    log_message \"\ud83d\udd10 \u68c0\u67e5\u7cfb\u7edf\u5b8c\u6574\u6027...\"\n\n    # \u68c0\u67e5\u5173\u952e\u6587\u4ef6\u6743\u9650\n    CRITICAL_FILES=(\"/etc/passwd\" \"/etc/shadow\" \"/etc/sudoers\" \"/etc/ssh/sshd_config\")\n    for file in \"${CRITICAL_FILES[@]}\"; do\n        if [ -f \"$file\" ]; then\n            PERMS=$(stat -c \"%a\" \"$file\")\n            case \"$file\" in\n                \"/etc/shadow\")\n                    if [ \"$PERMS\" != \"000\" ] &amp;&amp; [ \"$PERMS\" != \"640\" ]; then\n                        log_message \"${RED}\u26a0\ufe0f  $file \u6743\u9650\u5f02\u5e38: $PERMS${NC}\"\n                    fi\n                    ;;\n                \"/etc/sudoers\")\n                    if [ \"$PERMS\" != \"440\" ]; then\n                        log_message \"${RED}\u26a0\ufe0f  $file \u6743\u9650\u5f02\u5e38: $PERMS${NC}\"\n                    fi\n                    ;;\n                *)\n                    if [ \"$PERMS\" != \"644\" ]; then\n                        log_message \"${YELLOW}\u26a0\ufe0f  $file \u6743\u9650\u53ef\u80fd\u5f02\u5e38: $PERMS${NC}\"\n                    fi\n                    ;;\n            esac\n        fi\n    done\n}\n\n# \u4e3b\u68c0\u67e5\u51fd\u6570\nmain() {\n    log_message \"==================== \u5f00\u59cb\u5b89\u5168\u76d1\u63a7 ====================\"\n\n    ALERTS=0\n\n    # \u6267\u884c\u5404\u9879\u68c0\u67e5\n    check_cpu || ((ALERTS++))\n    check_memory || ((ALERTS++))\n    check_disk || ((ALERTS++))\n    check_login_failures || ((ALERTS++))\n    check_suspicious_processes\n    check_system_integrity\n\n    # \u6c47\u603b\u7ed3\u679c\n    if [ $ALERTS -gt 0 ]; then\n        log_message \"${RED}\ud83d\udea8 \u53d1\u73b0 $ALERTS \u4e2a\u5b89\u5168\u544a\u8b66${NC}\"\n\n        # \u53d1\u9001\u90ae\u4ef6\u544a\u8b66\uff08\u5982\u679c\u914d\u7f6e\u4e86\u90ae\u4ef6\u7cfb\u7edf\uff09\n        if command -v mail &gt;/dev/null 2&gt;&amp;1 &amp;&amp; [ ! -z \"$ALERT_EMAIL\" ]; then\n            tail -50 $LOG_FILE | mail -s \"Security Alert - $(hostname)\" $ALERT_EMAIL\n        fi\n    else\n        log_message \"${GREEN}\u2705 \u7cfb\u7edf\u5b89\u5168\u72b6\u6001\u826f\u597d${NC}\"\n    fi\n\n    log_message \"==================== \u76d1\u63a7\u5b8c\u6210 ====================\"\n    echo \"\" &gt;&gt; $LOG_FILE\n}\n\n# \u6267\u884c\u4e3b\u51fd\u6570\nmain\nEOF\n\nchmod +x /usr/local/bin/system-security-monitor.sh\n\n# \u6dfb\u52a0\u5230cron\u4efb\u52a1\uff08\u6bcf\u5c0f\u65f6\u6267\u884c\u4e00\u6b21\uff09\n(crontab -l 2&gt;/dev/null; echo \"0 * * * * /usr/local/bin/system-security-monitor.sh\") | crontab -\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#63","title":"6.3 \u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u811a\u672c","text":"Bash<pre><code># \u521b\u5efa\u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u811a\u672c\ncat &gt; /usr/local/bin/security-incident-response.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u5b89\u5168\u4e8b\u4ef6\u54cd\u5e94\u811a\u672c\nINCIDENT_LOG=\"/var/log/security-incidents.log\"\nBACKUP_DIR=\"/var/backups/security-$(date +%Y%m%d_%H%M%S)\"\n\n# \u521b\u5efa\u4e8b\u4ef6\u54cd\u5e94\u529f\u80fd\nincident_response() {\n    local incident_type=\"$1\"\n    local description=\"$2\"\n\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] INCIDENT: $incident_type - $description\" | tee -a $INCIDENT_LOG\n\n    # \u521b\u5efa\u5907\u4efd\u76ee\u5f55\n    mkdir -p $BACKUP_DIR\n\n    case \"$incident_type\" in\n        \"BRUTE_FORCE\")\n            # \u5e94\u5bf9\u66b4\u529b\u7834\u89e3\n            echo \"\u68c0\u6d4b\u5230\u66b4\u529b\u7834\u89e3\u653b\u51fb\uff0c\u6267\u884c\u9632\u62a4\u63aa\u65bd...\"\n\n            # \u5bfc\u51fa\u5f53\u524d\u8fde\u63a5\u4fe1\u606f\n            netstat -tuln &gt; $BACKUP_DIR/netstat.log\n            ss -tuln &gt; $BACKUP_DIR/ss.log\n\n            # \u5bfc\u51fa\u6700\u8fd1\u7684\u767b\u5f55\u5c1d\u8bd5\n            tail -1000 /var/log/secure &gt; $BACKUP_DIR/recent_auth.log 2&gt;/dev/null || true\n            tail -1000 /var/log/auth.log &gt; $BACKUP_DIR/recent_auth.log 2&gt;/dev/null || true\n\n            # \u5206\u6790\u653b\u51fb\u6765\u6e90IP\n            grep \"Failed password\" /var/log/secure /var/log/auth.log 2&gt;/dev/null | \\\n                awk '{print $(NF-3)}' | sort | uniq -c | sort -nr &gt; $BACKUP_DIR/attack_ips.log\n            ;;\n\n        \"MALWARE\")\n            # \u5e94\u5bf9\u6076\u610f\u8f6f\u4ef6\n            echo \"\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b\uff0c\u6267\u884c\u9694\u79bb\u63aa\u65bd...\"\n\n            # \u5bfc\u51fa\u8fdb\u7a0b\u4fe1\u606f\n            ps auxf &gt; $BACKUP_DIR/processes.log\n            lsof &gt; $BACKUP_DIR/open_files.log 2&gt;/dev/null\n\n            # \u5bfc\u51fa\u7f51\u7edc\u8fde\u63a5\n            netstat -anp &gt; $BACKUP_DIR/network_connections.log\n            ;;\n\n        \"FILE_INTEGRITY\")\n            # \u5e94\u5bf9\u6587\u4ef6\u5b8c\u6574\u6027\u95ee\u9898\n            echo \"\u68c0\u6d4b\u5230\u6587\u4ef6\u5b8c\u6574\u6027\u5f02\u5e38...\"\n\n            # \u8fd0\u884cAIDE\u68c0\u67e5\n            aide --check &gt; $BACKUP_DIR/aide_check.log 2&gt;&amp;1 || true\n\n            # \u5907\u4efd\u5173\u952e\u914d\u7f6e\u6587\u4ef6\n            tar -czf $BACKUP_DIR/critical_configs.tar.gz /etc/passwd /etc/shadow /etc/group /etc/sudoers /etc/ssh/ 2&gt;/dev/null\n            ;;\n    esac\n\n    echo \"\u4e8b\u4ef6\u54cd\u5e94\u5b8c\u6210\uff0c\u5907\u4efd\u6587\u4ef6\u4fdd\u5b58\u5728: $BACKUP_DIR\"\n}\n\n# \u5feb\u901f\u7cfb\u7edf\u9694\u79bb\u51fd\u6570\nemergency_isolation() {\n    echo \"\u26a0\ufe0f  \u6267\u884c\u7d27\u6025\u9694\u79bb\u7a0b\u5e8f...\"\n\n    # \u65ad\u5f00\u7f51\u7edc\u8fde\u63a5\uff08\u4ec5\u4fdd\u7559\u672c\u5730\u56de\u73af\uff09\n    iptables -P INPUT DROP\n    iptables -P FORWARD DROP\n    iptables -P OUTPUT DROP\n    iptables -A INPUT -i lo -j ACCEPT\n    iptables -A OUTPUT -o lo -j ACCEPT\n\n    # \u8bb0\u5f55\u9694\u79bb\u64cd\u4f5c\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] EMERGENCY: System isolated\" | tee -a $INCIDENT_LOG\n\n    echo \"\u2705 \u7cfb\u7edf\u5df2\u9694\u79bb\uff0c\u4ec5\u5141\u8bb8\u672c\u5730\u8fde\u63a5\"\n    echo \"\u6062\u590d\u7f51\u7edc\u8fde\u63a5\u547d\u4ee4: iptables -F &amp;&amp; iptables -P INPUT ACCEPT &amp;&amp; iptables -P FORWARD ACCEPT &amp;&amp; iptables -P OUTPUT ACCEPT\"\n}\n\n# \u6839\u636e\u53c2\u6570\u6267\u884c\u76f8\u5e94\u64cd\u4f5c\ncase \"$1\" in\n    \"brute_force\")\n        incident_response \"BRUTE_FORCE\" \"Detected brute force attack\"\n        ;;\n    \"malware\")\n        incident_response \"MALWARE\" \"Detected suspicious process\"\n        ;;\n    \"file_integrity\")\n        incident_response \"FILE_INTEGRITY\" \"File integrity violation detected\"\n        ;;\n    \"isolate\")\n        emergency_isolation\n        ;;\n    *)\n        echo \"\u7528\u6cd5: $0 {brute_force|malware|file_integrity|isolate}\"\n        echo \"\u793a\u4f8b: $0 brute_force\"\n        exit 1\n        ;;\nesac\nEOF\n\nchmod +x /usr/local/bin/security-incident-response.sh\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#7","title":"7. \u81ea\u52a8\u5316\u5b89\u5168\u52a0\u56fa\u811a\u672c \ud83e\udd16","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#71","title":"7.1 \u4e00\u952e\u52a0\u56fa\u811a\u672c","text":"Bash<pre><code># \u521b\u5efa\u4e00\u952e\u52a0\u56fa\u811a\u672c\ncat &gt; /usr/local/bin/auto-hardening.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u7cfb\u7edf\u81ea\u52a8\u5316\u5b89\u5168\u52a0\u56fa\u811a\u672c\n# \u7248\u672c: 2.0\n# \u9002\u7528: CentOS/RHEL 7-8, Ubuntu 18.04-22.04\n\nset -euo pipefail\n\n# \u989c\u8272\u5b9a\u4e49\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# \u65e5\u5fd7\u6587\u4ef6\nLOG_FILE=\"/var/log/system-hardening.log\"\nBACKUP_DIR=\"/var/backups/pre-hardening-$(date +%Y%m%d_%H%M%S)\"\n\n# \u65e5\u5fd7\u51fd\u6570\nlog() {\n    echo -e \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a $LOG_FILE\n}\n\n# \u9519\u8bef\u5904\u7406\nerror_exit() {\n    log \"${RED}\u9519\u8bef: $1${NC}\"\n    exit 1\n}\n\n# \u68c0\u67e5\u662f\u5426\u4e3aroot\u7528\u6237\ncheck_root() {\n    if [[ $EUID -ne 0 ]]; then\n        error_exit \"\u6b64\u811a\u672c\u9700\u8981root\u6743\u9650\u8fd0\u884c\"\n    fi\n}\n\n# \u7cfb\u7edf\u68c0\u6d4b\ndetect_system() {\n    if [ -f /etc/redhat-release ]; then\n        OS=\"redhat\"\n        if grep -q \"release 7\" /etc/redhat-release; then\n            VERSION=\"7\"\n        elif grep -q \"release 8\" /etc/redhat-release; then\n            VERSION=\"8\"\n        fi\n    elif [ -f /etc/lsb-release ]; then\n        OS=\"ubuntu\"\n        VERSION=$(lsb_release -rs)\n    elif [ -f /etc/debian_version ]; then\n        OS=\"debian\"\n        VERSION=$(cat /etc/debian_version)\n    else\n        error_exit \"\u4e0d\u652f\u6301\u7684\u64cd\u4f5c\u7cfb\u7edf\"\n    fi\n\n    log \"${GREEN}\u68c0\u6d4b\u5230\u7cfb\u7edf: $OS $VERSION${NC}\"\n}\n\n# \u521b\u5efa\u5907\u4efd\ncreate_backup() {\n    log \"${BLUE}\u521b\u5efa\u7cfb\u7edf\u914d\u7f6e\u5907\u4efd...${NC}\"\n    mkdir -p $BACKUP_DIR\n\n    # \u5907\u4efd\u5173\u952e\u914d\u7f6e\u6587\u4ef6\n    cp /etc/passwd $BACKUP_DIR/ 2&gt;/dev/null || true\n    cp /etc/shadow $BACKUP_DIR/ 2&gt;/dev/null || true\n    cp /etc/group $BACKUP_DIR/ 2&gt;/dev/null || true\n    cp /etc/sudoers $BACKUP_DIR/ 2&gt;/dev/null || true\n    cp -r /etc/ssh/ $BACKUP_DIR/ssh_backup/ 2&gt;/dev/null || true\n    cp /etc/login.defs $BACKUP_DIR/ 2&gt;/dev/null || true\n    cp /etc/security/limits.conf $BACKUP_DIR/ 2&gt;/dev/null || true\n\n    log \"${GREEN}\u5907\u4efd\u5b8c\u6210: $BACKUP_DIR${NC}\"\n}\n\n# \u66f4\u65b0\u7cfb\u7edf\nupdate_system() {\n    log \"${BLUE}\u66f4\u65b0\u7cfb\u7edf\u8f6f\u4ef6\u5305...${NC}\"\n\n    if [[ \"$OS\" == \"redhat\" ]]; then\n        if [[ \"$VERSION\" == \"8\" ]]; then\n            dnf update -y\n        else\n            yum update -y\n        fi\n    elif [[ \"$OS\" == \"ubuntu\" || \"$OS\" == \"debian\" ]]; then\n        apt update &amp;&amp; apt upgrade -y\n    fi\n\n    log \"${GREEN}\u7cfb\u7edf\u66f4\u65b0\u5b8c\u6210${NC}\"\n}\n\n# \u914d\u7f6e\u5bc6\u7801\u7b56\u7565\nconfigure_password_policy() {\n    log \"${BLUE}\u914d\u7f6e\u5bc6\u7801\u7b56\u7565...${NC}\"\n\n    # \u5b89\u88c5\u5bc6\u7801\u8d28\u91cf\u68c0\u67e5\u5de5\u5177\n    if [[ \"$OS\" == \"redhat\" ]]; then\n        if [[ \"$VERSION\" == \"8\" ]]; then\n            dnf install -y libpwquality\n        else\n            yum install -y libpwquality cracklib-dicts\n        fi\n    elif [[ \"$OS\" == \"ubuntu\" || \"$OS\" == \"debian\" ]]; then\n        apt install -y libpam-pwquality cracklib-runtime\n    fi\n\n    # \u914d\u7f6e\u5bc6\u7801\u590d\u6742\u5ea6\n    cat &gt; /etc/security/pwquality.conf &lt;&lt; 'EOL'\nminlen = 14\nminclass = 4\nmaxrepeat = 2\nmaxsequence = 3\ndcredit = -1\nucredit = -1\nlcredit = -1\nocredit = -1\nusercheck = 1\ndictcheck = 1\ndifok = 5\nEOL\n\n    # \u4fee\u6539\u767b\u5f55\u914d\u7f6e\n    sed -i 's/^PASS_MAX_DAYS.*/PASS_MAX_DAYS   90/' /etc/login.defs\n    sed -i 's/^PASS_MIN_DAYS.*/PASS_MIN_DAYS   7/' /etc/login.defs\n    sed -i 's/^PASS_WARN_AGE.*/PASS_WARN_AGE   14/' /etc/login.defs\n\n    log \"${GREEN}\u5bc6\u7801\u7b56\u7565\u914d\u7f6e\u5b8c\u6210${NC}\"\n}\n\n# \u914d\u7f6eSSH\u5b89\u5168\nconfigure_ssh() {\n    log \"${BLUE}\u914d\u7f6eSSH\u5b89\u5168\u8bbe\u7f6e...${NC}\"\n\n    # \u5907\u4efdSSH\u914d\u7f6e\n    cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup.$(date +%Y%m%d)\n\n    # \u5e94\u7528SSH\u5b89\u5168\u914d\u7f6e\n    cat &gt; /etc/ssh/sshd_config &lt;&lt; 'EOL'\n# SSH\u5b89\u5168\u914d\u7f6e\nPort 22\nProtocol 2\n\n# \u8ba4\u8bc1\u8bbe\u7f6e\nPermitRootLogin no\nPasswordAuthentication no\nPubkeyAuthentication yes\nAuthorizedKeysFile .ssh/authorized_keys\nPermitEmptyPasswords no\nChallengeResponseAuthentication no\nUsePAM yes\n\n# \u8fde\u63a5\u8bbe\u7f6e\nX11Forwarding no\nPrintMotd no\nPrintLastLog yes\nTCPKeepAlive yes\nCompression delayed\nClientAliveInterval 300\nClientAliveCountMax 2\nMaxAuthTries 3\nMaxSessions 2\n\n# \u9650\u5236\u7528\u6237\u548c\u7ec4\nAllowUsers *\n#AllowGroups ssh-users\n\n# \u5176\u4ed6\u5b89\u5168\u8bbe\u7f6e\nPermitUserEnvironment no\nPermitTunnel no\nBanner /etc/issue.net\nEOL\n\n    # \u91cd\u542fSSH\u670d\u52a1\n    systemctl reload sshd\n\n    log \"${GREEN}SSH\u5b89\u5168\u914d\u7f6e\u5b8c\u6210${NC}\"\n}\n\n# \u914d\u7f6e\u9632\u706b\u5899\u57fa\u7840\u89c4\u5219\nconfigure_basic_firewall() {\n    log \"${BLUE}\u914d\u7f6e\u57fa\u7840\u9632\u706b\u5899\u89c4\u5219...${NC}\"\n\n    if [[ \"$OS\" == \"redhat\" ]]; then\n        systemctl enable firewalld\n        systemctl start firewalld\n\n        # \u57fa\u7840\u89c4\u5219\n        firewall-cmd --permanent --remove-service=ssh\n        firewall-cmd --permanent --add-port=22/tcp\n        firewall-cmd --permanent --add-service=http\n        firewall-cmd --permanent --add-service=https\n        firewall-cmd --reload\n\n    elif [[ \"$OS\" == \"ubuntu\" || \"$OS\" == \"debian\" ]]; then\n        apt install -y ufw\n\n        # \u91cd\u7f6e\u89c4\u5219\n        ufw --force reset\n\n        # \u9ed8\u8ba4\u7b56\u7565\n        ufw default deny incoming\n        ufw default allow outgoing\n\n        # \u57fa\u7840\u89c4\u5219\n        ufw allow 22/tcp\n        ufw allow 80/tcp\n        ufw allow 443/tcp\n\n        # \u542f\u7528\u9632\u706b\u5899\n        ufw --force enable\n    fi\n\n    log \"${GREEN}\u57fa\u7840\u9632\u706b\u5899\u914d\u7f6e\u5b8c\u6210${NC}\"\n}\n\n# \u5b89\u88c5\u5b89\u5168\u5de5\u5177\ninstall_security_tools() {\n    log \"${BLUE}\u5b89\u88c5\u5b89\u5168\u76d1\u63a7\u5de5\u5177...${NC}\"\n\n    if [[ \"$OS\" == \"redhat\" ]]; then\n        if [[ \"$VERSION\" == \"8\" ]]; then\n            dnf install -y aide audit rkhunter logwatch\n        else\n            yum install -y aide audit rkhunter logwatch epel-release\n        fi\n    elif [[ \"$OS\" == \"ubuntu\" || \"$OS\" == \"debian\" ]]; then\n        apt install -y aide aide-common auditd rkhunter logwatch\n    fi\n\n    # \u542f\u7528\u5ba1\u8ba1\u670d\u52a1\n    systemctl enable auditd\n    systemctl start auditd\n\n    log \"${GREEN}\u5b89\u5168\u5de5\u5177\u5b89\u88c5\u5b8c\u6210${NC}\"\n}\n\n# \u5e94\u7528\u7f51\u7edc\u5b89\u5168\u53c2\u6570\napply_network_security() {\n    log \"${BLUE}\u5e94\u7528\u7f51\u7edc\u5b89\u5168\u53c2\u6570...${NC}\"\n\n    cat &gt; /etc/sysctl.d/99-network-security.conf &lt;&lt; 'EOL'\n# \u7f51\u7edc\u5b89\u5168\u53c2\u6570\nnet.ipv4.ip_forward = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\nnet.ipv4.tcp_syncookies = 1\nkernel.randomize_va_space = 2\nEOL\n\n    sysctl -p /etc/sysctl.d/99-network-security.conf\n\n    log \"${GREEN}\u7f51\u7edc\u5b89\u5168\u53c2\u6570\u5e94\u7528\u5b8c\u6210${NC}\"\n}\n\n# \u4e3b\u51fd\u6570\nmain() {\n    log \"${GREEN}==================== \u5f00\u59cb\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa ====================${NC}\"\n\n    check_root\n    detect_system\n    create_backup\n\n    # \u8be2\u95ee\u7528\u6237\u786e\u8ba4\n    echo -e \"${YELLOW}\u5373\u5c06\u5f00\u59cb\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa\uff0c\u662f\u5426\u7ee7\u7eed? [y/N]${NC}\"\n    read -r response\n    if [[ ! \"$response\" =~ ^[Yy]$ ]]; then\n        log \"\u7528\u6237\u53d6\u6d88\u64cd\u4f5c\"\n        exit 0\n    fi\n\n    # \u6267\u884c\u52a0\u56fa\u6b65\u9aa4\n    update_system\n    configure_password_policy\n    configure_ssh\n    configure_basic_firewall\n    install_security_tools\n    apply_network_security\n\n    log \"${GREEN}==================== \u7cfb\u7edf\u52a0\u56fa\u5b8c\u6210 ====================${NC}\"\n    log \"${YELLOW}\u91cd\u8981\u63d0\u793a:${NC}\"\n    log \"1. SSH\u914d\u7f6e\u5df2\u4fee\u6539\uff0c\u786e\u4fdd\u6709SSH\u5bc6\u94a5\u8bbf\u95ee\u6743\u9650\"\n    log \"2. \u9632\u706b\u5899\u5df2\u542f\u7528\uff0c\u8bf7\u6839\u636e\u9700\u8981\u8c03\u6574\u89c4\u5219\"\n    log \"3. \u5efa\u8bae\u91cd\u542f\u7cfb\u7edf\u4ee5\u786e\u4fdd\u6240\u6709\u8bbe\u7f6e\u751f\u6548\"\n    log \"4. \u5907\u4efd\u6587\u4ef6\u4f4d\u7f6e: $BACKUP_DIR\"\n\n    echo -e \"\\n${GREEN}\u52a0\u56fa\u5b8c\u6210! \u5efa\u8bae\u73b0\u5728\u91cd\u542f\u7cfb\u7edf\u3002${NC}\"\n}\n\n# \u6267\u884c\u4e3b\u51fd\u6570\nmain \"$@\"\nEOF\n\nchmod +x /usr/local/bin/auto-hardening.sh\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#8","title":"8. \u5b89\u5168\u68c0\u67e5\u548c\u9a8c\u8bc1 \u2705","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#81","title":"8.1 \u5b89\u5168\u5408\u89c4\u68c0\u67e5\u811a\u672c","text":"Bash<pre><code># \u521b\u5efa\u5b89\u5168\u5408\u89c4\u68c0\u67e5\u811a\u672c\ncat &gt; /usr/local/bin/security-compliance-check.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u5b89\u5168\u5408\u89c4\u68c0\u67e5\u811a\u672c\nCOMPLIANCE_LOG=\"/var/log/compliance-check.log\"\nSCORE=0\nTOTAL_CHECKS=0\n\n# \u989c\u8272\u5b9a\u4e49\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'\n\n# \u68c0\u67e5\u51fd\u6570\u6a21\u677f\ncheck_item() {\n    local check_name=\"$1\"\n    local check_command=\"$2\"\n    local expected_result=\"$3\"\n    local weight=\"${4:-1}\"\n\n    ((TOTAL_CHECKS += weight))\n\n    echo -e \"\\n${BLUE}\u68c0\u67e5\u9879\u76ee: $check_name${NC}\"\n\n    if eval \"$check_command\"; then\n        echo -e \"${GREEN}\u2705 \u901a\u8fc7${NC}\"\n        ((SCORE += weight))\n        echo \"[$(date '+%Y-%m-%d %H:%M:%S')] PASS: $check_name\" &gt;&gt; $COMPLIANCE_LOG\n        return 0\n    else\n        echo -e \"${RED}\u274c \u5931\u8d25${NC}\"\n        echo \"[$(date '+%Y-%m-%d %H:%M:%S')] FAIL: $check_name\" &gt;&gt; $COMPLIANCE_LOG\n        return 1\n    fi\n}\n\necho -e \"${GREEN}==================== \u5b89\u5168\u5408\u89c4\u6027\u68c0\u67e5 ====================${NC}\"\necho \"[$(date '+%Y-%m-%d %H:%M:%S')] \u5f00\u59cb\u5b89\u5168\u5408\u89c4\u68c0\u67e5\" &gt; $COMPLIANCE_LOG\n\n# 1. \u7cfb\u7edf\u66f4\u65b0\u68c0\u67e5\ncheck_item \"\u7cfb\u7edf\u662f\u5426\u4e3a\u6700\u65b0\u7248\u672c\" \\\n    '[ $(yum list updates 2&gt;/dev/null | wc -l || apt list --upgradable 2&gt;/dev/null | wc -l) -le 5 ]' \\\n    \"updates &lt;= 5\" 2\n\n# 2. SSH\u5b89\u5168\u68c0\u67e5\ncheck_item \"SSH\u7981\u7528root\u767b\u5f55\" \\\n    'grep -q \"^PermitRootLogin no\" /etc/ssh/sshd_config' \\\n    \"PermitRootLogin no\" 3\n\ncheck_item \"SSH\u7981\u7528\u5bc6\u7801\u8ba4\u8bc1\" \\\n    'grep -q \"^PasswordAuthentication no\" /etc/ssh/sshd_config' \\\n    \"PasswordAuthentication no\" 3\n\n# 3. \u9632\u706b\u5899\u72b6\u6001\u68c0\u67e5\ncheck_item \"\u9632\u706b\u5899\u670d\u52a1\u5df2\u542f\u7528\" \\\n    'systemctl is-active --quiet firewalld || systemctl is-active --quiet ufw' \\\n    \"firewall active\" 2\n\n# 4. \u5ba1\u8ba1\u670d\u52a1\u68c0\u67e5\ncheck_item \"\u5ba1\u8ba1\u670d\u52a1\u5df2\u542f\u7528\" \\\n    'systemctl is-active --quiet auditd' \\\n    \"auditd active\" 2\n\n# 5. \u5bc6\u7801\u7b56\u7565\u68c0\u67e5\ncheck_item \"\u5bc6\u7801\u6700\u5c0f\u957f\u5ea6\u8bbe\u7f6e\" \\\n    'grep -q \"minlen.*=.*1[4-9]\" /etc/security/pwquality.conf' \\\n    \"minlen &gt;= 14\" 2\n\n# 6. \u6587\u4ef6\u6743\u9650\u68c0\u67e5\ncheck_item \"/etc/shadow\u6743\u9650\u68c0\u67e5\" \\\n    '[ $(stat -c \"%a\" /etc/shadow) = \"000\" ] || [ $(stat -c \"%a\" /etc/shadow) = \"640\" ]' \\\n    \"shadow perms correct\" 3\n\ncheck_item \"/etc/sudoers\u6743\u9650\u68c0\u67e5\" \\\n    '[ $(stat -c \"%a\" /etc/sudoers) = \"440\" ]' \\\n    \"sudoers perms 440\" 2\n\n# 7. \u7f51\u7edc\u5b89\u5168\u68c0\u67e5\ncheck_item \"IP\u8f6c\u53d1\u5df2\u7981\u7528\" \\\n    'sysctl net.ipv4.ip_forward | grep -q \"= 0\"' \\\n    \"ip_forward = 0\" 2\n\ncheck_item \"TCP SYN Cookies\u5df2\u542f\u7528\" \\\n    'sysctl net.ipv4.tcp_syncookies | grep -q \"= 1\"' \\\n    \"syncookies = 1\" 1\n\n# 8. \u670d\u52a1\u5b89\u5168\u68c0\u67e5\ncheck_item \"\u4e0d\u5fc5\u8981\u670d\u52a1\u5df2\u7981\u7528\" \\\n    '! (systemctl is-enabled bluetooth 2&gt;/dev/null &amp;&amp; systemctl is-enabled cups 2&gt;/dev/null)' \\\n    \"unnecessary services disabled\" 1\n\n# 9. \u65e5\u5fd7\u914d\u7f6e\u68c0\u67e5\ncheck_item \"rsyslog\u670d\u52a1\u8fd0\u884c\" \\\n    'systemctl is-active --quiet rsyslog' \\\n    \"rsyslog active\" 1\n\n# 10. AIDE\u5b8c\u6574\u6027\u68c0\u67e5\u5de5\u5177\ncheck_item \"AIDE\u5df2\u5b89\u88c5\u914d\u7f6e\" \\\n    'command -v aide &gt;/dev/null &amp;&amp; [ -f /var/lib/aide/aide.db ]' \\\n    \"aide configured\" 2\n\n# \u8ba1\u7b97\u6700\u7ec8\u5f97\u5206\nPERCENTAGE=$((SCORE * 100 / TOTAL_CHECKS))\n\necho -e \"\\n${BLUE}==================== \u68c0\u67e5\u7ed3\u679c\u6c47\u603b ====================${NC}\"\necho -e \"\u603b\u68c0\u67e5\u9879: $TOTAL_CHECKS\"\necho -e \"\u901a\u8fc7\u9879: $SCORE\"\n\nif [ $PERCENTAGE -ge 90 ]; then\n    echo -e \"\u5408\u89c4\u5f97\u5206: ${GREEN}$PERCENTAGE%${NC} - \u4f18\u79c0\"\n    LEVEL=\"\u4f18\u79c0\"\nelif [ $PERCENTAGE -ge 80 ]; then\n    echo -e \"\u5408\u89c4\u5f97\u5206: ${GREEN}$PERCENTAGE%${NC} - \u826f\u597d\"\n    LEVEL=\"\u826f\u597d\"\nelif [ $PERCENTAGE -ge 70 ]; then\n    echo -e \"\u5408\u89c4\u5f97\u5206: ${YELLOW}$PERCENTAGE%${NC} - \u4e00\u822c\"\n    LEVEL=\"\u4e00\u822c\"\nelse\n    echo -e \"\u5408\u89c4\u5f97\u5206: ${RED}$PERCENTAGE%${NC} - \u9700\u8981\u6539\u8fdb\"\n    LEVEL=\"\u9700\u8981\u6539\u8fdb\"\nfi\n\n# \u8bb0\u5f55\u6700\u7ec8\u7ed3\u679c\necho \"[$(date '+%Y-%m-%d %H:%M:%S')] \u5408\u89c4\u68c0\u67e5\u5b8c\u6210 - \u5f97\u5206: $PERCENTAGE% ($LEVEL)\" &gt;&gt; $COMPLIANCE_LOG\n\necho -e \"\\n\u8be6\u7ec6\u65e5\u5fd7\u5df2\u4fdd\u5b58\u5230: $COMPLIANCE_LOG\"\nEOF\n\nchmod +x /usr/local/bin/security-compliance-check.sh\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#9","title":"9. \u5b9a\u671f\u7ef4\u62a4\u548c\u66f4\u65b0\u5efa\u8bae \ud83d\udcc5","text":"","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#91","title":"9.1 \u5b9a\u671f\u4efb\u52a1\u6e05\u5355","text":"\u9891\u7387 \u4efb\u52a1 \u547d\u4ee4/\u811a\u672c \u6bcf\u65e5 \u5b89\u5168\u76d1\u63a7\u68c0\u67e5 <code>/usr/local/bin/system-security-monitor.sh</code> \u6bcf\u5468 \u7cfb\u7edf\u65e5\u5fd7\u5ba1\u67e5 <code>grep -i \"error\\|fail\\|warn\" /var/log/messages</code> \u6bcf\u6708 \u5b89\u5168\u5408\u89c4\u68c0\u67e5 <code>/usr/local/bin/security-compliance-check.sh</code> \u6bcf\u6708 AIDE\u5b8c\u6574\u6027\u68c0\u67e5 <code>aide --check</code> \u6bcf\u5b63\u5ea6 \u5168\u9762\u5b89\u5168\u8bc4\u4f30 \u4eba\u5de5\u5ba1\u67e5 + \u6e17\u900f\u6d4b\u8bd5","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#92","title":"9.2 \u5b89\u5168\u6307\u6807\u76d1\u63a7","text":"Bash<pre><code># \u521b\u5efa\u5b89\u5168\u6307\u6807\u6536\u96c6\u811a\u672c\ncat &gt; /usr/local/bin/security-metrics.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nMETRICS_FILE=\"/var/log/security-metrics.csv\"\nDATE=$(date '+%Y-%m-%d %H:%M:%S')\n\n# \u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u521b\u5efaCSV\u5934\u90e8\nif [ ! -f \"$METRICS_FILE\" ]; then\n    echo \"timestamp,failed_logins,active_sessions,open_ports,cpu_usage,memory_usage,disk_usage\" &gt; $METRICS_FILE\nfi\n\n# \u6536\u96c6\u6307\u6807\nFAILED_LOGINS=$(grep \"Failed password\" /var/log/secure /var/log/auth.log 2&gt;/dev/null | grep \"$(date '+%b %d')\" | wc -l)\nACTIVE_SESSIONS=$(who | wc -l)\nOPEN_PORTS=$(ss -tuln | grep LISTEN | wc -l)\nCPU_USAGE=$(top -bn1 | grep \"Cpu(s)\" | awk '{print $2}' | sed 's/%us,//')\nMEMORY_USAGE=$(free | grep Mem | awk '{printf(\"%.1f\", $3/$2 * 100.0)}')\nDISK_USAGE=$(df / | awk 'NR==2 {print $(NF-1)}' | sed 's/%//')\n\n# \u5199\u5165CSV\necho \"$DATE,$FAILED_LOGINS,$ACTIVE_SESSIONS,$OPEN_PORTS,$CPU_USAGE,$MEMORY_USAGE,$DISK_USAGE\" &gt;&gt; $METRICS_FILE\nEOF\n\nchmod +x /usr/local/bin/security-metrics.sh\n\n# \u6dfb\u52a0\u5230cron\uff08\u6bcf\u5c0f\u65f6\u6536\u96c6\u4e00\u6b21\uff09\n(crontab -l 2&gt;/dev/null; echo \"0 * * * * /usr/local/bin/security-metrics.sh\") | crontab -\n</code></pre>","tags":["\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/","title":"\u7f51\u7edc\u5b89\u5168","text":"","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#1","title":"1. \u7f51\u7edc\u5b89\u5168\u9632\u62a4","text":"","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#11-ddos","title":"1.1 DDoS\u9632\u62a4\u914d\u7f6e","text":"Bash<pre><code># \u521b\u5efaDDoS\u9632\u62a4\u811a\u672c\ncat &gt; /usr/local/bin/ddos-protection.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u542f\u7528SYN cookies\necho 1 &gt; /proc/sys/net/ipv4/tcp_syncookies\n\n# \u8c03\u6574\u7f51\u7edc\u53c2\u6570\u9632\u62a4DDoS\ncat &gt;&gt; /etc/sysctl.conf &lt;&lt; 'SYSCTL_EOF'\n# DDoS Protection\nnet.ipv4.tcp_syncookies = 1\nnet.ipv4.tcp_max_syn_backlog = 2048\nnet.ipv4.tcp_synack_retries = 3\nnet.ipv4.netfilter.ip_conntrack_max = 65536\nnet.netfilter.nf_conntrack_max = 65536\n\n# \u9632\u6b62TIME-WAIT\u5957\u63a5\u5b57\u8fc7\u591a\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.tcp_fin_timeout = 15\n\n# \u9650\u5236\u6838\u5fc3\u8f6c\u50a8\nkernel.core_pattern = /dev/null\n\n# \u9632\u6b62IP\u6b3a\u9a97\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\n# \u5ffd\u7565ICMP\u91cd\u5b9a\u5411\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n# \u5ffd\u7565\u6e90\u8def\u7531\u5305\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\n\n# \u8bb0\u5f55\u53ef\u7591\u6570\u636e\u5305\nnet.ipv4.conf.all.log_martians = 1\nSYSCTL_EOF\n\n# \u5e94\u7528\u914d\u7f6e\nsysctl -p\n\n# iptables DDoS\u9632\u62a4\u89c4\u5219\niptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\niptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN -j DROP\niptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j DROP\niptables -A INPUT -p tcp --tcp-flags FIN,RST FIN,RST -j DROP\niptables -A INPUT -p tcp --tcp-flags ACK,FIN FIN -j DROP\niptables -A INPUT -p tcp --tcp-flags ACK,PSH PSH -j DROP\niptables -A INPUT -p tcp --tcp-flags ACK,URG URG -j DROP\n\n# \u9650\u5236\u5e76\u53d1\u8fde\u63a5\u6570\niptables -A INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 20 --connlimit-mask 24 -j REJECT\niptables -A INPUT -p tcp --syn --dport 443 -m connlimit --connlimit-above 20 --connlimit-mask 24 -j REJECT\n\n# SYN flood\u9632\u62a4\niptables -A INPUT -p tcp --syn -m limit --limit 1/s --limit-burst 3 -j RETURN\niptables -A INPUT -p tcp --syn -j DROP\n\necho \"DDoS protection configured\"\nEOF\n\nchmod +x /usr/local/bin/ddos-protection.sh\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#12","title":"1.2 \u7f51\u7edc\u5165\u4fb5\u68c0\u6d4b\u4e0e\u9632\u62a4","text":"Bash<pre><code># \u5b89\u88c5\u5e76\u914d\u7f6ePSAD (Port Scan Attack Detector)\nyum install psad -y \u00a0# CentOS/RHEL (\u9700\u8981EPEL\u6e90)\napt install psad -y \u00a0# Ubuntu/Debian\n\n# \u914d\u7f6ePSAD\ncat &gt; /etc/psad/psad.conf &lt;&lt; 'EOF'\nEMAIL_ADDRESSES \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 admin@yourdomain.com;\nHOSTNAME \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0$(hostname);\nENABLE_AUTO_IDS \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Y;\nENABLE_AUTO_IDS_EMAILS \u00a0 \u00a0 \u00a0Y;\nAUTO_IDS_DANGER_LEVEL \u00a0 \u00a0 \u00a0 3;\nAUTO_BLOCK_TIMEOUT \u00a0 \u00a0 \u00a0 \u00a0 \u00a03600;\nENABLE_PERSISTENCE \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Y;\nSCAN_TIMEOUT \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 3600;\nEOF\n\n# \u542f\u52a8PSAD\nsystemctl enable psad\nsystemctl start psad\n\n# \u521b\u5efa\u7f51\u7edc\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/network-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/network-monitor.log\"\nDATE=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"[$DATE] Network Security Monitor Report\" &gt;&gt; $LOG_FILE\n\n# \u68c0\u67e5\u5f02\u5e38\u7f51\u7edc\u8fde\u63a5\necho \"=== Suspicious Network Connections ===\" &gt;&gt; $LOG_FILE\nnetstat -ntu | awk '$5 ~ /^[0-9]/ {print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -10 &gt;&gt; $LOG_FILE\n\n# \u68c0\u67e5\u5927\u91cf\u8fde\u63a5\u7684IP\necho \"=== High Connection Count IPs ===\" &gt;&gt; $LOG_FILE\nss -tn | awk 'NR&gt;1 {print $4}' | cut -d: -f1 | sort | uniq -c | sort -nr | awk '$1 &gt; 10' &gt;&gt; $LOG_FILE\n\n# \u68c0\u67e5\u7f51\u7edc\u63a5\u53e3\u6d41\u91cf\necho \"=== Network Interface Statistics ===\" &gt;&gt; $LOG_FILE\ncat /proc/net/dev | grep -E \"(eth|ens|enp)\" &gt;&gt; $LOG_FILE\n\n# \u68c0\u67e5\u9632\u706b\u5899\u65e5\u5fd7\u4e2d\u7684\u653b\u51fb\necho \"=== Firewall Blocked Attacks ===\" &gt;&gt; $LOG_FILE\ngrep \"$(date +%b)\" /var/log/messages | grep -E \"(iptables|firewall)\" | tail -20 &gt;&gt; $LOG_FILE\n\necho \"[$DATE] Network monitor check completed\" &gt;&gt; $LOG_FILE\necho \"-------------------------------------------\" &gt;&gt; $LOG_FILE\nEOF\n\nchmod +x /usr/local/bin/network-monitor.sh\n\n# \u6bcf\u5c0f\u65f6\u8fd0\u884c\u4e00\u6b21\necho \"0 * * * * /usr/local/bin/network-monitor.sh\" | crontab -\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#13-fail2ban","title":"1.3 \u914d\u7f6efail2ban","text":"Bash<pre><code># \u5b89\u88c5fail2ban\nyum install epel-release -y\nyum install fail2ban -y \u00a0# CentOS/RHEL\napt install fail2ban -y \u00a0# Ubuntu/Debian\n\n# \u521b\u5efa\u81ea\u5b9a\u4e49fail2ban\u914d\u7f6e\ncat &gt; /etc/fail2ban/jail.local &lt;&lt; 'EOF'\n[DEFAULT]\n# \u7981\u7528\u65f6\u95f4\uff08\u79d2\uff09\nbantime = 3600\n# \u67e5\u627e\u65f6\u95f4\u7a97\u53e3\uff08\u79d2\uff09\nfindtime = 600\n# \u6700\u5927\u91cd\u8bd5\u6b21\u6570\nmaxretry = 3\n# \u5ffd\u7565\u7684IP\u5217\u8868\nignoreip = 127.0.0.1/8 192.168.1.0/24\n\n# Email\u914d\u7f6e\ndestemail = admin@yourdomain.com\nsender = fail2ban@yourdomain.com\naction = %(action_mwl)s\n\n[sshd]\nenabled = true\nport = 2222\nlogpath = /var/log/secure\nbackend = systemd\n\n[apache-auth]\nenabled = true\nport = http,https\nlogpath = /var/log/httpd/error_log\n\n[apache-badbots]\nenabled = true\nport = http,https\nlogpath = /var/log/httpd/access_log\nbantime = 86400\nmaxretry = 1\n\n[apache-noscript]\nenabled = true\nport = http,https\nlogpath = /var/log/httpd/access_log\nmaxretry = 6\n\n[apache-overflows]\nenabled = true\nport = http,https\nlogpath = /var/log/httpd/error_log\nmaxretry = 2\n\n[apache-nohome]\nenabled = true\nport = http,https\nlogpath = /var/log/httpd/access_log\nmaxretry = 2\n\n[nginx-http-auth]\nenabled = true\nport = http,https\nlogpath = /var/log/nginx/error.log\n\n[nginx-limit-req]\nenabled = true\nport = http,https\nlogpath = /var/log/nginx/error.log\nmaxretry = 10\n\n[postfix-sasl]\nenabled = true\nport = smtp,ssmtp\nlogpath = /var/log/mail.log\nmaxretry = 3\nEOF\n\n# \u81ea\u5b9a\u4e49fail2ban\u8fc7\u6ee4\u5668\ncat &gt; /etc/fail2ban/filter.d/custom-ssh.conf &lt;&lt; 'EOF'\n[Definition]\nfailregex = ^%(__prefix_line)s(?:error: PAM: )?[aA]uthentication (?:failure|error|failed) for .* from &lt;HOST&gt;( via \\S+)?\\s*$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)s(?:error: )?Received disconnect from &lt;HOST&gt;: 3: .*: Auth fail$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)sUser .* from &lt;HOST&gt; not allowed because not listed in AllowUsers$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)sUser .* from &lt;HOST&gt; not allowed because listed in DenyUsers$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)sUser .* from &lt;HOST&gt; not allowed because not in any group$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)srefused connect from \\S+ \\(&lt;HOST&gt;\\)$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)sReceived disconnect from &lt;HOST&gt;: 11: Bye Bye$\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ^%(__prefix_line)sConnection closed by &lt;HOST&gt;$\nEOF\n\n# \u542f\u52a8fail2ban\nsystemctl enable fail2ban\nsystemctl start fail2ban\n\n# fail2ban\u7ba1\u7406\u811a\u672c\ncat &gt; /usr/local/bin/fail2ban-manager.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\ncase \"$1\" in\n\u00a0 \u00a0 status)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Fail2ban\u670d\u52a1\u72b6\u6001:\"\n\u00a0 \u00a0 \u00a0 \u00a0 systemctl status fail2ban\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"\u5f53\u524d\u76d1\u72f1\u72b6\u6001:\"\n\u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client status\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 list-banned)\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -z \"$2\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 list-banned &lt;jail_name&gt;\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client status\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 exit 1\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"\u76d1\u72f1 $2 \u4e2d\u88ab\u7981\u6b62\u7684IP:\"\n\u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client status \"$2\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 unban)\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -z \"$2\" ] || [ -z \"$3\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 unban &lt;jail_name&gt; &lt;ip_address&gt;\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 exit 1\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client set \"$2\" unbanip \"$3\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"IP $3 \u5df2\u4ece\u76d1\u72f1 $2 \u4e2d\u89e3\u5c01\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 ban)\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -z \"$2\" ] || [ -z \"$3\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 ban &lt;jail_name&gt; &lt;ip_address&gt;\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 exit 1\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client set \"$2\" banip \"$3\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"IP $3 \u5df2\u88ab\u6dfb\u52a0\u5230\u76d1\u72f1 $2\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 reload)\n\u00a0 \u00a0 \u00a0 \u00a0 fail2ban-client reload\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Fail2ban\u914d\u7f6e\u5df2\u91cd\u8f7d\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 log)\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -z \"$2\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 tail -50 /var/log/fail2ban.log\n\u00a0 \u00a0 \u00a0 \u00a0 else\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 tail -\"$2\" /var/log/fail2ban.log\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \n\u00a0 \u00a0 *)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 {status|list-banned|unban|ban|reload|log}\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0status \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0- \u663e\u793a\u670d\u52a1\u548c\u76d1\u72f1\u72b6\u6001\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0list-banned &lt;jail&gt; \u00a0- \u5217\u51fa\u6307\u5b9a\u76d1\u72f1\u7684\u88ab\u7981IP\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0unban &lt;jail&gt; &lt;ip&gt; \u00a0 - \u89e3\u5c01\u6307\u5b9aIP\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0ban &lt;jail&gt; &lt;ip&gt; \u00a0 \u00a0 - \u5c01\u7981\u6307\u5b9aIP\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0reload \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0- \u91cd\u8f7d\u914d\u7f6e\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0log [lines] \u00a0 \u00a0 \u00a0 \u00a0 - \u663e\u793a\u65e5\u5fd7\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\nesac\nEOF\n\nchmod +x /usr/local/bin/fail2ban-manager.sh\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#2","title":"2. \u7f51\u7edc\u6d41\u91cf\u5206\u6790\u548c\u76d1\u63a7","text":"","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#21-ntopng","title":"2.1 \u5b89\u88c5\u548c\u914d\u7f6entopng","text":"Bash<pre><code># \u5b89\u88c5ntopng\nyum install epel-release -y\nyum install ntopng -y \u00a0# CentOS/RHEL\napt install ntopng -y \u00a0# Ubuntu/Debian\n\n# \u914d\u7f6entopng\ncat &gt; /etc/ntopng/ntopng.conf &lt;&lt; 'EOF'\n-P=/var/lib/ntopng/ntopng.pid\n-d=/var/lib/ntopng\n-w=3000\n-i=eth0\n-P=/etc/ntopng/ntopng.users\n-m=192.168.1.0/24\n--local-networks=\"192.168.1.0/24\"\n--interface-name=\"eth0:Local Network\"\nEOF\n\n# \u521b\u5efa\u7528\u6237\u8ba4\u8bc1\u6587\u4ef6\necho \"admin:$(echo -n 'your_password' | md5sum | cut -d' ' -f1)\" &gt; /etc/ntopng/ntopng.users\n\nsystemctl enable ntopng\nsystemctl start ntopng\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#22","title":"2.2 \u7f51\u7edc\u6d41\u91cf\u76d1\u63a7\u811a\u672c","text":"Bash<pre><code># \u521b\u5efa\u7f51\u7edc\u6d41\u91cf\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/traffic-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nINTERFACE=\"eth0\"\nLOG_DIR=\"/var/log/traffic\"\nALERT_THRESHOLD_MB=1000\nEMAIL=\"admin@yourdomain.com\"\n\n# \u521b\u5efa\u65e5\u5fd7\u76ee\u5f55\nmkdir -p $LOG_DIR\n\n# \u83b7\u53d6\u5f53\u524d\u6d41\u91cf\u7edf\u8ba1\nRX_BYTES=$(cat /sys/class/net/$INTERFACE/statistics/rx_bytes)\nTX_BYTES=$(cat /sys/class/net/$INTERFACE/statistics/tx_bytes)\n\n# \u8f6c\u6362\u4e3aMB\nRX_MB=$((RX_BYTES / 1024 / 1024))\nTX_MB=$((TX_BYTES / 1024 / 1024))\nTOTAL_MB=$((RX_MB + TX_MB))\n\n# \u8bb0\u5f55\u5230\u65e5\u5fd7\nTIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\necho \"$TIMESTAMP,RX:${RX_MB}MB,TX:${TX_MB}MB,TOTAL:${TOTAL_MB}MB\" &gt;&gt; $LOG_DIR/traffic-$(date +%Y%m%d).log\n\n# \u68c0\u67e5\u662f\u5426\u8d85\u8fc7\u9608\u503c\nif [ -f $LOG_DIR/last_check.tmp ]; then\n\u00a0 \u00a0 LAST_TOTAL=$(cat $LOG_DIR/last_check.tmp)\n\u00a0 \u00a0 DIFF_MB=$((TOTAL_MB - LAST_TOTAL))\n\u00a0 \u00a0 \n\u00a0 \u00a0 if [ $DIFF_MB -gt $ALERT_THRESHOLD_MB ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 ALERT_MSG=\"\u9ad8\u6d41\u91cf\u8b66\u544a: \u5728\u8fc7\u53bb5\u5206\u949f\u5185\u68c0\u6d4b\u5230 ${DIFF_MB}MB \u6d41\u91cf\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"$TIMESTAMP: $ALERT_MSG\" &gt;&gt; $LOG_DIR/alerts.log\n\u00a0 \u00a0 \u00a0 \u00a0 logger -t traffic-monitor \"$ALERT_MSG\"\n\u00a0 \u00a0 \u00a0 \u00a0 # echo \"$ALERT_MSG\" | mail -s \"\u6d41\u91cf\u8b66\u544a - $(hostname)\" $EMAIL\n\u00a0 \u00a0 fi\nfi\n\n# \u4fdd\u5b58\u5f53\u524d\u603b\u6d41\u91cf\necho $TOTAL_MB &gt; $LOG_DIR/last_check.tmp\n\n# \u751f\u6210\u6d41\u91cf\u62a5\u544a\uff08\u6bcf\u5c0f\u65f6\uff09\nif [ $(date +%M) -eq 0 ]; then\n\u00a0 \u00a0 HOUR=$(date +%H)\n\u00a0 \u00a0 TODAY=$(date +%Y%m%d)\n\u00a0 \u00a0 \n\u00a0 \u00a0 # \u7edf\u8ba1\u5f53\u524d\u5c0f\u65f6\u7684\u6d41\u91cf\n\u00a0 \u00a0 grep \"$(date '+%Y-%m-%d %H')\" $LOG_DIR/traffic-$TODAY.log | \\\n\u00a0 \u00a0 awk -F, '{\n\u00a0 \u00a0 \u00a0 \u00a0 split($2, rx, \":\");\n\u00a0 \u00a0 \u00a0 \u00a0 split($3, tx, \":\");\n\u00a0 \u00a0 \u00a0 \u00a0 rx_total += substr(rx[2], 1, length(rx[2])-2);\n\u00a0 \u00a0 \u00a0 \u00a0 tx_total += substr(tx[2], 1, length(tx[2])-2);\n\u00a0 \u00a0 } END {\n\u00a0 \u00a0 \u00a0 \u00a0 printf \"%s,%d,%d\\n\", \"'$HOUR'\", rx_total/NR, tx_total/NR\n\u00a0 \u00a0 }' &gt;&gt; $LOG_DIR/hourly-$TODAY.log\nfi\n\n# \u68c0\u67e5\u5f02\u5e38\u8fde\u63a5\nCONNECTIONS=$(ss -tn | wc -l)\nif [ $CONNECTIONS -gt 1000 ]; then\n\u00a0 \u00a0 echo \"$TIMESTAMP: \u5f02\u5e38\u8fde\u63a5\u6570\u91cf: $CONNECTIONS\" &gt;&gt; $LOG_DIR/alerts.log\n\u00a0 \u00a0 logger -t traffic-monitor \"\u5f02\u5e38\u8fde\u63a5\u6570\u91cf: $CONNECTIONS\"\nfi\nEOF\n\nchmod +x /usr/local/bin/traffic-monitor.sh\n\n# \u6bcf5\u5206\u949f\u8fd0\u884c\u4e00\u6b21\necho \"*/5 * * * * /usr/local/bin/traffic-monitor.sh\" | crontab -\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#3","title":"3. \u7aef\u53e3\u626b\u63cf\u9632\u62a4","text":"","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#31","title":"3.1 \u914d\u7f6e\u7aef\u53e3\u626b\u63cf\u68c0\u6d4b","text":"Bash<pre><code># \u521b\u5efa\u7aef\u53e3\u626b\u63cf\u68c0\u6d4b\u811a\u672c\ncat &gt; /usr/local/bin/portscan-detector.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/portscan.log\"\nTEMP_FILE=\"/tmp/portscan_ips.tmp\"\nBLOCK_TIME=3600\nSCAN_THRESHOLD=20\n\n# \u5206\u6790iptables\u65e5\u5fd7\u4e2d\u7684\u7aef\u53e3\u626b\u63cf\u884c\u4e3a\ngrep \"$(date +%b)\" /var/log/messages | \\\ngrep \"iptables-denied\" | \\\nawk '{\n\u00a0 \u00a0 # \u63d0\u53d6IP\u5730\u5740\n\u00a0 \u00a0 match($0, /SRC=([0-9.]+)/, src);\n\u00a0 \u00a0 match($0, /DPT=([0-9]+)/, dpt);\n\u00a0 \u00a0 if (src[1] != \"\" &amp;&amp; dpt[1] != \"\") {\n\u00a0 \u00a0 \u00a0 \u00a0 print src[1], dpt[1];\n\u00a0 \u00a0 }\n}' | sort | uniq -c | sort -nr | \\\nwhile read count ip port; do\n\u00a0 \u00a0 if [ \"$count\" -gt \"$SCAN_THRESHOLD\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Port scan detected from $ip (port $port, count: $count)\" &gt;&gt; $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u68c0\u67e5IP\u662f\u5426\u5df2\u88ab\u5c01\u7981\n\u00a0 \u00a0 \u00a0 \u00a0 if ! iptables -L INPUT -n | grep -q \"$ip\"; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # \u5c01\u7981IP\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 iptables -I INPUT -s \"$ip\" -j DROP\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Blocked IP: $ip\" &gt;&gt; $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 logger -t portscan-detector \"Blocked IP $ip for port scanning\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 # \u8bbe\u7f6e\u5b9a\u65f6\u89e3\u5c01\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"iptables -D INPUT -s $ip -j DROP\" | at now + $BLOCK_TIME minutes\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 fi\ndone\nEOF\n\nchmod +x /usr/local/bin/portscan-detector.sh\n\n# \u6bcf10\u5206\u949f\u8fd0\u884c\u4e00\u6b21\necho \"*/10 * * * * /usr/local/bin/portscan-detector.sh\" | crontab -\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#32","title":"3.2 \u871c\u7f50\u7aef\u53e3\u8bbe\u7f6e","text":"Bash<pre><code># \u521b\u5efa\u871c\u7f50\u670d\u52a1\u811a\u672c\ncat &gt; /usr/local/bin/honeypot-service.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nHONEYPOT_PORTS=\"21 23 25 135 139 445 1433 3389\"\nLOG_FILE=\"/var/log/honeypot.log\"\n\n# \u4e3a\u6bcf\u4e2a\u871c\u7f50\u7aef\u53e3\u521b\u5efaiptables\u89c4\u5219\nfor port in $HONEYPOT_PORTS; do\n\u00a0 \u00a0 # \u8bb0\u5f55\u8bbf\u95ee\u8fd9\u4e9b\u7aef\u53e3\u7684IP\n\u00a0 \u00a0 iptables -A INPUT -p tcp --dport $port -j LOG --log-prefix \"honeypot-$port: \" --log-level 4\n\u00a0 \u00a0 iptables -A INPUT -p tcp --dport $port -j DROP\ndone\n\n# \u76d1\u63a7\u871c\u7f50\u65e5\u5fd7\ntail -f /var/log/messages | grep \"honeypot-\" | while read line; do\n\u00a0 \u00a0 IP=$(echo \"$line\" | grep -oE 'SRC=[0-9.]+' | cut -d'=' -f2)\n\u00a0 \u00a0 PORT=$(echo \"$line\" | grep -oE 'honeypot-[0-9]+' | cut -d'-' -f2)\n\u00a0 \u00a0 TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n\u00a0 \u00a0 \n\u00a0 \u00a0 echo \"[$TIMESTAMP] Honeypot triggered: IP=$IP, PORT=$PORT\" &gt;&gt; $LOG_FILE\n\u00a0 \u00a0 \n\u00a0 \u00a0 # \u81ea\u52a8\u5c01\u7981\u89e6\u53d1\u871c\u7f50\u7684IP\n\u00a0 \u00a0 if ! iptables -L INPUT -n | grep -q \"$IP\"; then\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -I INPUT -s \"$IP\" -j DROP\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Auto-blocked IP: $IP\" &gt;&gt; $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 logger -t honeypot \"Auto-blocked IP $IP for accessing honeypot port $PORT\"\n\u00a0 \u00a0 fi\ndone &amp;\nEOF\n\nchmod +x /usr/local/bin/honeypot-service.sh\n\n# \u521b\u5efasystemd\u670d\u52a1\ncat &gt; /etc/systemd/system/honeypot.service &lt;&lt; 'EOF'\n[Unit]\nDescription=Honeypot Service\nAfter=network.target\n\n[Service]\nType=forking\nExecStart=/usr/local/bin/honeypot-service.sh\nRestart=always\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsystemctl daemon-reload\nsystemctl enable honeypot\nsystemctl start honeypot\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#4","title":"4. \u7f51\u7edc\u5b89\u5168\u81ea\u52a8\u5316\u7ba1\u7406","text":"","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#41","title":"4.1 \u521b\u5efa\u7f51\u7edc\u5b89\u5168\u72b6\u6001\u68c0\u67e5\u811a\u672c","text":"Bash<pre><code>cat &gt; /usr/local/bin/network-security-check.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m'\n\nREPORT_FILE=\"/var/log/network-security-report.log\"\nDATE=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"Network Security Check Report - $DATE\" &gt; $REPORT_FILE\necho \"=============================================\" &gt;&gt; $REPORT_FILE\n\n# \u68c0\u67e5\u9632\u706b\u5899\u72b6\u6001\necho -e \"${YELLOW}1. \u68c0\u67e5\u9632\u706b\u5899\u72b6\u6001${NC}\"\nif systemctl is-active iptables &gt;/dev/null 2&gt;&amp;1 || systemctl is-active firewalld &gt;/dev/null 2&gt;&amp;1; then\n\u00a0 \u00a0 echo -e \"${GREEN}[PASS]${NC} \u9632\u706b\u5899\u670d\u52a1\u6b63\u5728\u8fd0\u884c\" | tee -a $REPORT_FILE\nelse\n\u00a0 \u00a0 echo -e \"${RED}[FAIL]${NC} \u9632\u706b\u5899\u670d\u52a1\u672a\u8fd0\u884c\" | tee -a $REPORT_FILE\nfi\n\n# \u68c0\u67e5\u5f00\u653e\u7aef\u53e3\necho -e \"${YELLOW}2. \u68c0\u67e5\u5f00\u653e\u7aef\u53e3${NC}\"\necho \"\u5f53\u524d\u76d1\u542c\u7684\u7aef\u53e3:\" &gt;&gt; $REPORT_FILE\nss -tlnp &gt;&gt; $REPORT_FILE\n\nOPEN_PORTS=$(ss -tln | grep LISTEN | wc -l)\nif [ $OPEN_PORTS -lt 10 ]; then\n\u00a0 \u00a0 echo -e \"${GREEN}[PASS]${NC} \u5f00\u653e\u7aef\u53e3\u6570\u91cf\u9002\u4e2d: $OPEN_PORTS\" | tee -a $REPORT_FILE\nelse\n\u00a0 \u00a0 echo -e \"${YELLOW}[WARN]${NC} \u5f00\u653e\u7aef\u53e3\u6570\u91cf\u8f83\u591a: $OPEN_PORTS\" | tee -a $REPORT_FILE\nfi\n\n# \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5\necho -e \"${YELLOW}3. \u68c0\u67e5\u7f51\u7edc\u8fde\u63a5${NC}\"\nESTABLISHED_CONN=$(ss -tn | grep ESTAB | wc -l)\necho \"\u5f53\u524d\u5efa\u7acb\u7684\u8fde\u63a5\u6570: $ESTABLISHED_CONN\" | tee -a $REPORT_FILE\n\nif [ $ESTABLISHED_CONN -gt 1000 ]; then\n\u00a0 \u00a0 echo -e \"${RED}[WARN]${NC} \u8fde\u63a5\u6570\u91cf\u5f02\u5e38: $ESTABLISHED_CONN\" | tee -a $REPORT_FILE\nfi\n\n# \u68c0\u67e5\u6700\u8fd1\u7684\u653b\u51fb\necho -e \"${YELLOW}4. \u68c0\u67e5\u6700\u8fd1\u7684\u653b\u51fb\u5c1d\u8bd5${NC}\"\nRECENT_ATTACKS=$(grep \"$(date +%b)\" /var/log/secure 2&gt;/dev/null | grep -i \"failed\\|invalid\\|illegal\" | wc -l)\necho \"\u6700\u8fd1\u7684\u653b\u51fb\u5c1d\u8bd5: $RECENT_ATTACKS\" | tee -a $REPORT_FILE\n\n# \u68c0\u67e5fail2ban\u72b6\u6001\necho -e \"${YELLOW}5. \u68c0\u67e5Fail2ban\u72b6\u6001${NC}\"\nif systemctl is-active fail2ban &gt;/dev/null 2&gt;&amp;1; then\n\u00a0 \u00a0 echo -e \"${GREEN}[PASS]${NC} Fail2ban\u6b63\u5728\u8fd0\u884c\" | tee -a $REPORT_FILE\n\u00a0 \u00a0 BANNED_IPS=$(fail2ban-client status | grep -o \"Jail list:.*\" | wc -w)\n\u00a0 \u00a0 echo \"Fail2ban\u76d1\u72f1\u6570\u91cf: $((BANNED_IPS - 2))\" | tee -a $REPORT_FILE\nelse\n\u00a0 \u00a0 echo -e \"${RED}[FAIL]${NC} Fail2ban\u672a\u8fd0\u884c\" | tee -a $REPORT_FILE\nfi\n\n# \u68c0\u67e5\u7cfb\u7edf\u8d1f\u8f7d\necho -e \"${YELLOW}6. \u68c0\u67e5\u7cfb\u7edf\u8d1f\u8f7d${NC}\"\nLOAD=$(uptime | awk -F'load average:' '{print $2}' | cut -d, -f1 | xargs)\nLOAD_INT=${LOAD%.*}\nif [ \"$LOAD_INT\" -lt 2 ]; then\n\u00a0 \u00a0 echo -e \"${GREEN}[PASS]${NC} \u7cfb\u7edf\u8d1f\u8f7d\u6b63\u5e38: $LOAD\" | tee -a $REPORT_FILE\nelse\n\u00a0 \u00a0 echo -e \"${RED}[WARN]${NC} \u7cfb\u7edf\u8d1f\u8f7d\u8f83\u9ad8: $LOAD\" | tee -a $REPORT_FILE\nfi\n\n# \u68c0\u67e5\u78c1\u76d8\u4f7f\u7528\u7387\necho -e \"${YELLOW}7. \u68c0\u67e5\u78c1\u76d8\u4f7f\u7528\u7387${NC}\"\nDISK_USAGE=$(df -h / | awk 'NR==2 {print $5}' | sed 's/%//')\nif [ \"$DISK_USAGE\" -lt 80 ]; then\n\u00a0 \u00a0 echo -e \"${GREEN}[PASS]${NC} \u78c1\u76d8\u4f7f\u7528\u7387\u6b63\u5e38: ${DISK_USAGE}%\" | tee -a $REPORT_FILE\nelse\n\u00a0 \u00a0 echo -e \"${RED}[WARN]${NC} \u78c1\u76d8\u4f7f\u7528\u7387\u8f83\u9ad8: ${DISK_USAGE}%\" | tee -a $REPORT_FILE\nfi\n\n# \u7f51\u7edc\u914d\u7f6e\u68c0\u67e5\necho -e \"${YELLOW}8. \u68c0\u67e5\u7f51\u7edc\u5b89\u5168\u914d\u7f6e${NC}\"\necho \"\u7f51\u7edc\u5b89\u5168\u53c2\u6570:\" &gt;&gt; $REPORT_FILE\nsysctl net.ipv4.tcp_syncookies net.ipv4.icmp_echo_ignore_all net.ipv4.conf.all.rp_filter &gt;&gt; $REPORT_FILE\n\necho \"\" &gt;&gt; $REPORT_FILE\necho \"\u68c0\u67e5\u5b8c\u6210\u65f6\u95f4: $(date)\" &gt;&gt; $REPORT_FILE\nEOF\n\nchmod +x /usr/local/bin/network-security-check.sh\n\n# \u6bcf\u5929\u8fd0\u884c\u5b89\u5168\u68c0\u67e5\necho \"0 8 * * * /usr/local/bin/network-security-check.sh\" | crontab -\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/#42","title":"4.2 \u521b\u5efa\u7f51\u7edc\u5b89\u5168\u5e94\u6025\u54cd\u5e94\u811a\u672c","text":"Bash<pre><code>cat &gt; /usr/local/bin/network-emergency.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/network-emergency.log\"\nTIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n\ncase \"$1\" in\n\u00a0 \u00a0 lockdown)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Emergency lockdown initiated\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u53ea\u5141\u8bb8\u672c\u5730SSH\u8fde\u63a5\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -F INPUT\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -P INPUT DROP\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -A INPUT -i lo -j ACCEPT\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -A INPUT -s 192.168.0.0/16 -p tcp --dport 22 -j ACCEPT\n\u00a0 \u00a0 \u00a0 \u00a0 iptables -A INPUT -s 10.0.0.0/8 -p tcp --dport 22 -j ACCEPT\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u505c\u6b62\u975e\u5173\u952e\u670d\u52a1\n\u00a0 \u00a0 \u00a0 \u00a0 systemctl stop httpd nginx apache2 2&gt;/dev/null\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Emergency lockdown completed\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 normal)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Restoring normal operations\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u6062\u590d\u6b63\u5e38\u9632\u706b\u5899\u89c4\u5219\n\u00a0 \u00a0 \u00a0 \u00a0 /usr/local/bin/setup-iptables.sh\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u91cd\u542f\u670d\u52a1\n\u00a0 \u00a0 \u00a0 \u00a0 systemctl start httpd nginx apache2 2&gt;/dev/null\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Normal operations restored\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 block-country)\n\u00a0 \u00a0 \u00a0 \u00a0 if [ -z \"$2\" ]; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 block-country &lt;country_code&gt;\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Example: $0 block-country CN\"\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 exit 1\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 COUNTRY=\"$2\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"[$TIMESTAMP] Blocking traffic from country: $COUNTRY\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 # \u9700\u8981\u5b89\u88c5xtables-addons\n\u00a0 \u00a0 \u00a0 \u00a0 # iptables -A INPUT -m geoip --src-cc $COUNTRY -j DROP\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Country blocking configured for: $COUNTRY\" | tee -a $LOG_FILE\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 status)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Current network security status:\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"================================\"\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Firewall rules count: $(iptables -L INPUT | wc -l)\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Active connections: $(ss -tn | grep ESTAB | wc -l)\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Blocked IPs: $(iptables -L INPUT -n | grep DROP | wc -l)\"\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 if systemctl is-active fail2ban &gt;/dev/null 2&gt;&amp;1; then\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Fail2ban status: Active\"\n\u00a0 \u00a0 \u00a0 \u00a0 else\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \"Fail2ban status: Inactive\"\n\u00a0 \u00a0 \u00a0 \u00a0 fi\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\n\u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 *)\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Network Emergency Response Script\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Usage: $0 {lockdown|normal|block-country|status}\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \"Commands:\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0lockdown \u00a0 \u00a0 \u00a0 \u00a0- Emergency lockdown mode\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0normal \u00a0 \u00a0 \u00a0 \u00a0 \u00a0- Restore normal operations\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0block-country \u00a0 - Block traffic from specific country\"\n\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0status \u00a0 \u00a0 \u00a0 \u00a0 \u00a0- Show current security status\"\n\u00a0 \u00a0 \u00a0 \u00a0 ;;\nesac\nEOF\n\nchmod +x /usr/local/bin/network-emergency.sh\n</code></pre>","tags":["\u7f51\u7edc\u5b89\u5168","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/","title":"\u9632\u706b\u5899\u5b89\u5168","text":"","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#1-iptables","title":"1. iptables\u9632\u706b\u5899\u914d\u7f6e","text":"","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#11-iptables","title":"1.1 iptables\u57fa\u7840\u64cd\u4f5c","text":"Bash<pre><code># \u67e5\u770b\u5f53\u524d\u9632\u706b\u5899\u89c4\u5219\niptables -L -n -v\n\n# \u67e5\u770bNAT\u8868\u89c4\u5219\niptables -t nat -L -n -v\n\n# \u6e05\u7a7a\u6240\u6709\u89c4\u5219\niptables -F\niptables -t nat -F\niptables -X\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565\niptables -P INPUT DROP\niptables -P FORWARD DROP\niptables -P OUTPUT ACCEPT\n\n# \u4fdd\u5b58\u89c4\u5219\nservice iptables save  # CentOS 6\niptables-save &gt; /etc/iptables/rules.v4  # Ubuntu/Debian\n\n# \u6062\u590d\u89c4\u5219\niptables-restore &lt; /etc/iptables/rules.v4\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#12","title":"1.2 \u57fa\u7840\u9632\u706b\u5899\u89c4\u5219\u914d\u7f6e","text":"Bash<pre><code># \u521b\u5efa\u57fa\u7840\u9632\u706b\u5899\u914d\u7f6e\u811a\u672c\ncat &gt; /usr/local/bin/setup-iptables.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u6e05\u7a7a\u73b0\u6709\u89c4\u5219\niptables -F\niptables -X\niptables -t nat -F\niptables -t nat -X\niptables -t mangle -F\niptables -t mangle -X\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565\niptables -P INPUT DROP\niptables -P FORWARD DROP\niptables -P OUTPUT ACCEPT\n\n# \u5141\u8bb8\u56de\u73af\u63a5\u53e3\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u5141\u8bb8\u5df2\u5efa\u7acb\u548c\u76f8\u5173\u7684\u8fde\u63a5\niptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\n\n# \u5141\u8bb8SSH\u8fde\u63a5\uff08\u4fee\u6539\u4e3a\u4f60\u7684SSH\u7aef\u53e3\uff09\nSSH_PORT=2222\niptables -A INPUT -p tcp --dport $SSH_PORT -m conntrack --ctstate NEW,ESTABLISHED -j ACCEPT\n\n# \u5141\u8bb8HTTP\u548cHTTPS\niptables -A INPUT -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -p tcp --dport 443 -j ACCEPT\n\n# \u5141\u8bb8DNS\u67e5\u8be2\u54cd\u5e94\niptables -A INPUT -p udp --sport 53 -m conntrack --ctstate ESTABLISHED -j ACCEPT\niptables -A INPUT -p tcp --sport 53 -m conntrack --ctstate ESTABLISHED -j ACCEPT\n\n# \u5141\u8bb8NTP\u540c\u6b65\niptables -A INPUT -p udp --sport 123 -m conntrack --ctstate ESTABLISHED -j ACCEPT\n\n# \u9632\u6b62\u5e38\u89c1\u653b\u51fb\n# \u9632\u6b62\u7aef\u53e3\u626b\u63cf\niptables -A INPUT -m conntrack --ctstate INVALID -j DROP\niptables -A INPUT -p tcp --tcp-flags ALL NONE -j DROP\niptables -A INPUT -p tcp --tcp-flags ALL ALL -j DROP\niptables -A INPUT -p tcp --tcp-flags ALL FIN,URG,PSH -j DROP\niptables -A INPUT -p tcp --tcp-flags ALL SYN,RST,ACK,FIN,URG -j DROP\niptables -A INPUT -p tcp --tcp-flags SYN,RST SYN,RST -j DROP\niptables -A INPUT -p tcp --tcp-flags SYN,FIN SYN,FIN -j DROP\n\n# \u9650\u5236\u8fde\u63a5\u901f\u7387\uff08\u9632\u6b62\u66b4\u529b\u7834\u89e3\uff09\niptables -A INPUT -p tcp --dport $SSH_PORT -m conntrack --ctstate NEW -m recent --set\niptables -A INPUT -p tcp --dport $SSH_PORT -m conntrack --ctstate NEW -m recent --update --seconds 60 --hitcount 4 -j DROP\n\n# \u9632\u6b62ping\u6d2a\u6c34\u653b\u51fb\niptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s --limit-burst 2 -j ACCEPT\niptables -A INPUT -p icmp --icmp-type echo-request -j DROP\n\n# \u8bb0\u5f55\u5e76\u4e22\u5f03\u5176\u4ed6\u8fde\u63a5\niptables -A INPUT -j LOG --log-prefix \"iptables-denied: \"\niptables -A INPUT -j DROP\n\necho \"iptables rules configured successfully\"\nEOF\n\nchmod +x /usr/local/bin/setup-iptables.sh\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#13-iptables","title":"1.3 \u9ad8\u7ea7iptables\u89c4\u5219","text":"Bash<pre><code># \u521b\u5efa\u9ad8\u7ea7\u9632\u706b\u5899\u89c4\u5219\u811a\u672c\ncat &gt; /usr/local/bin/advanced-iptables.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u521b\u5efa\u81ea\u5b9a\u4e49\u94fe\niptables -N LOGDROP\niptables -A LOGDROP -j LOG --log-prefix \"iptables-drop: \" --log-level 4\niptables -A LOGDROP -j DROP\n\n# \u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb\niptables -N SYN_FLOOD\niptables -A SYN_FLOOD -p tcp --syn -m limit --limit 1/s --limit-burst 3 -j RETURN\niptables -A SYN_FLOOD -j LOGDROP\niptables -A INPUT -p tcp --syn -j SYN_FLOOD\n\n# \u5730\u7406\u4f4d\u7f6e\u5c01\u9501\uff08\u9700\u8981xtables-addons\uff09\n# \u5c01\u9501\u7279\u5b9a\u56fd\u5bb6\u7684IP\uff08\u4f8b\u5982\uff1aCN\u4e3a\u4e2d\u56fd\u4ee3\u7801\uff09\n# iptables -A INPUT -m geoip --src-cc CN -j LOGDROP\n\n# \u57fa\u4e8e\u65f6\u95f4\u7684\u8bbf\u95ee\u63a7\u5236\n# \u53ea\u5728\u5de5\u4f5c\u65f6\u95f4\u5141\u8bb8SSH\u8fde\u63a5\niptables -A INPUT -p tcp --dport 2222 -m time --timestart 08:00 --timestop 18:00 --weekdays Mon,Tue,Wed,Thu,Fri -j ACCEPT\n\n# IP\u5730\u5740\u767d\u540d\u5355/\u9ed1\u540d\u5355\u7ba1\u7406\n# \u521b\u5efaIP\u96c6\u5408\uff08\u9700\u8981ipset\uff09\nipset create whitelist hash:ip\nipset create blacklist hash:ip\n\n# \u6dfb\u52a0\u767d\u540d\u5355IP\nipset add whitelist 192.168.1.100\nipset add whitelist 10.0.0.50\n\n# \u6dfb\u52a0\u9ed1\u540d\u5355IP\nipset add blacklist 1.2.3.4\nipset add blacklist 5.6.7.8\n\n# \u5e94\u7528IP\u96c6\u5408\u89c4\u5219\niptables -A INPUT -m set --match-set whitelist src -j ACCEPT\niptables -A INPUT -m set --match-set blacklist src -j LOGDROP\n\n# \u7aef\u53e3\u6572\u95e8\uff08Port Knocking\uff09\u914d\u7f6e\niptables -N KNOCKING\niptables -N GATE1\niptables -N GATE2\niptables -N PASSED\n\n# \u7b2c\u4e00\u4e2a\u6572\u95e8\u7aef\u53e3\niptables -A KNOCKING -p tcp --dport 7000 -m recent --name KNOCK1 --set -j DROP\niptables -A KNOCKING -p tcp --dport 8000 -m recent --name KNOCK1 --rcheck -m recent --name KNOCK2 --set -j DROP\niptables -A KNOCKING -p tcp --dport 9000 -m recent --name KNOCK2 --rcheck -m recent --name KNOCK3 --set -j DROP\niptables -A KNOCKING -p tcp --dport 2222 -m recent --name KNOCK3 --rcheck -j ACCEPT\n\n# \u5e94\u7528\u7aef\u53e3\u6572\u95e8\niptables -A INPUT -p tcp --dport 2222 -j KNOCKING\n\necho \"Advanced iptables rules configured\"\nEOF\n\nchmod +x /usr/local/bin/advanced-iptables.sh\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#2-firewalld","title":"2. firewalld\u914d\u7f6e","text":"","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#21-firewalld","title":"2.1 firewalld\u57fa\u7840\u64cd\u4f5c","text":"Bash<pre><code># \u542f\u52a8\u548c\u542f\u7528firewalld\nsystemctl start firewalld\nsystemctl enable firewalld\n\n# \u67e5\u770b\u72b6\u6001\nfirewall-cmd --state\nfirewall-cmd --list-all\n\n# \u67e5\u770b\u6240\u6709zone\nfirewall-cmd --get-zones\nfirewall-cmd --get-default-zone\n\n# \u67e5\u770b\u6d3b\u8dc3zone\nfirewall-cmd --get-active-zones\n\n# \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\nfirewall-cmd --reload\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#22","title":"2.2 \u57fa\u672c\u670d\u52a1\u548c\u7aef\u53e3\u7ba1\u7406","text":"Bash<pre><code># \u6c38\u4e45\u6dfb\u52a0\u670d\u52a1\nfirewall-cmd --permanent --add-service=ssh\nfirewall-cmd --permanent --add-service=http\nfirewall-cmd --permanent --add-service=https\n\n# \u6c38\u4e45\u6dfb\u52a0\u7aef\u53e3\nfirewall-cmd --permanent --add-port=2222/tcp\nfirewall-cmd --permanent --add-port=3306/tcp\n\n# \u5220\u9664\u670d\u52a1\u6216\u7aef\u53e3\nfirewall-cmd --permanent --remove-service=ssh\nfirewall-cmd --permanent --remove-port=2222/tcp\n\n# \u7aef\u53e3\u8303\u56f4\nfirewall-cmd --permanent --add-port=4000-4100/tcp\n\n# \u5e94\u7528\u914d\u7f6e\nfirewall-cmd --reload\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#23-firewalld","title":"2.3 \u521b\u5efa\u81ea\u5b9a\u4e49firewalld\u914d\u7f6e","text":"Bash<pre><code># \u521b\u5efa\u81ea\u5b9a\u4e49zone\nfirewall-cmd --permanent --new-zone=dmz-servers\nfirewall-cmd --permanent --zone=dmz-servers --add-service=ssh\nfirewall-cmd --permanent --zone=dmz-servers --add-service=http\nfirewall-cmd --permanent --zone=dmz-servers --add-service=https\n\n# \u5c06\u63a5\u53e3\u7ed1\u5b9a\u5230zone\nfirewall-cmd --permanent --zone=dmz-servers --add-interface=eth0\n\n# \u5bcc\u89c4\u5219\uff08Rich Rules\uff09\n# \u53ea\u5141\u8bb8\u7279\u5b9aIP\u8bbf\u95eeSSH\nfirewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" source address=\"192.168.1.100\" service name=\"ssh\" accept'\n\n# \u9650\u5236\u8fde\u63a5\u6570\nfirewall-cmd --permanent --add-rich-rule='rule service name=\"ssh\" accept limit value=\"3/m\"'\n\n# \u57fa\u4e8e\u65f6\u95f4\u7684\u89c4\u5219\nfirewall-cmd --permanent --add-rich-rule='rule service name=\"ssh\" accept audit limit value=\"1/m\"'\n\n# \u7aef\u53e3\u8f6c\u53d1\nfirewall-cmd --permanent --add-forward-port=port=80:proto=tcp:toport=8080:toaddr=192.168.1.100\n\n# \u521b\u5efafirewalld\u914d\u7f6e\u7ba1\u7406\u811a\u672c\ncat &gt; /usr/local/bin/firewalld-setup.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u57fa\u7840\u914d\u7f6e\nfirewall-cmd --set-default-zone=public\n\n# \u79fb\u9664\u4e0d\u9700\u8981\u7684\u670d\u52a1\nfirewall-cmd --permanent --remove-service=dhcpv6-client 2&gt;/dev/null\nfirewall-cmd --permanent --remove-service=cockpit 2&gt;/dev/null\n\n# \u6dfb\u52a0\u5fc5\u8981\u7684\u670d\u52a1\nfirewall-cmd --permanent --add-service=ssh\nfirewall-cmd --permanent --add-service=http\nfirewall-cmd --permanent --add-service=https\n\n# \u81ea\u5b9a\u4e49SSH\u7aef\u53e3\nfirewall-cmd --permanent --add-port=2222/tcp\nfirewall-cmd --permanent --remove-service=ssh\n\n# \u9650\u5236SSH\u8bbf\u95ee\nfirewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" source address=\"192.168.1.0/24\" port protocol=\"tcp\" port=\"2222\" accept'\nfirewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" port protocol=\"tcp\" port=\"2222\" limit value=\"3/m\" accept'\n\n# \u9632\u6b62\u66b4\u529b\u7834\u89e3\nfirewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" source address=\"0.0.0.0/0\" service name=\"ssh\" log prefix=\"ssh-attempt\" level=\"info\" limit value=\"3/m\" drop'\n\n# \u5e94\u7528\u914d\u7f6e\nfirewall-cmd --reload\n\necho \"Firewalld configuration completed\"\nEOF\n\nchmod +x /usr/local/bin/firewalld-setup.sh\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#3","title":"3. \u9632\u706b\u5899\u65e5\u5fd7\u5206\u6790\u548c\u76d1\u63a7","text":"","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#31-rsyslog","title":"3.1 rsyslog\u914d\u7f6e","text":"<p>\u9632\u706b\u5899\u65e5\u5fd7\u901a\u5e38\u7531\u5185\u6838\u8bb0\u5f55\uff0c\u5e76\u901a\u8fc7 <code>rsyslog</code> \u6216 <code>journald</code> \u6536\u96c6\u3002\u4e3a\u4e86\u65b9\u4fbf\u5206\u6790\uff0c\u53ef\u4ee5\u914d\u7f6e <code>rsyslog</code> \u5c06\u9632\u706b\u5899\u65e5\u5fd7\u5355\u72ec\u4fdd\u5b58\u3002</p> Bash<pre><code># \u521b\u5efa\u4e00\u4e2a\u65b0\u7684rsyslog\u914d\u7f6e\u6587\u4ef6\ncat &gt; /etc/rsyslog.d/firewall.conf &lt;&lt; 'EOF'\n# \u5c06\u6240\u6709\u5e26\u6709 \"iptables-denied\" \u524d\u7f00\u7684\u5185\u6838\u6d88\u606f\u8bb0\u5f55\u5230 /var/log/firewall.log\n:msg, contains, \"iptables-denied\" -/var/log/firewall.log\n&amp; stop\nEOF\n\n# \u91cd\u542frsyslog\u670d\u52a1\u4ee5\u5e94\u7528\u914d\u7f6e\nsystemctl restart rsyslog\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#32","title":"3.2 \u9632\u706b\u5899\u65e5\u5fd7\u76d1\u63a7\u811a\u672c","text":"<p>\u7f16\u5199\u4e00\u4e2a\u811a\u672c\u6765\u5b9e\u65f6\u76d1\u63a7\u548c\u5206\u6790\u9632\u706b\u5899\u65e5\u5fd7\uff0c\u4ee5\u4fbf\u53ca\u65f6\u53d1\u73b0\u6f5c\u5728\u7684\u653b\u51fb\u3002</p> Bash<pre><code># \u521b\u5efa\u9632\u706b\u5899\u65e5\u5fd7\u76d1\u63a7\u811a\u672c\ncat &gt; /usr/local/bin/firewall-monitor.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/firewall.log\"\nREPORT_FILE=\"/var/log/firewall-report.log\"\nEMAIL=\"admin@yourdomain.com\"\nTHRESHOLD=100  # \u9608\u503c\uff1a\u5728\u7ed9\u5b9a\u65f6\u95f4\u5185\u8d85\u8fc7\u6b64\u6570\u91cf\u7684\u8fde\u63a5\u5c06\u88ab\u89c6\u4e3a\u5f02\u5e38\n\n# \u68c0\u67e5\u65e5\u5fd7\u6587\u4ef6\u662f\u5426\u5b58\u5728\nif [ ! -f \"$LOG_FILE\" ]; then\n    echo \"[$DATE] Log file not found: $LOG_FILE\" &gt;&gt; $REPORT_FILE\n    exit 1\nfi\n\nDATE=$(date '+%Y-%m-%d %H:%M:%S')\n\necho \"[$DATE] Firewall Activity Report\" &gt; $REPORT_FILE\necho \"=============================================\" &gt;&gt; $REPORT_FILE\n\n# \u7edf\u8ba1\u8fc7\u53bb1\u5c0f\u65f6\u5185\u88ab\u62d2\u7edd\u7684\u8fde\u63a5\necho \"=== Top 10 Blocked IPs (Last Hour) ===\" &gt;&gt; $REPORT_FILE\n# \u4f7f\u7528 sed \u8fc7\u6ee4\u6389\u7a7a\u884c\u548c\u975eIP\u5730\u5740\u7684\u884c\uff0c\u5e76\u4f7f\u7528 awk \u63d0\u53d6 IP \u5730\u5740\ngrep \"iptables-denied\" $LOG_FILE | tail -n 1000 | awk '{\n    for (i=1;i&lt;=NF;i++) {\n        if ($i ~ /^SRC=/) {\n            split($i, a, \"=\");\n            print a[2]\n        }\n    }\n}' | sort | uniq -c | sort -nr | head -10 &gt;&gt; $REPORT_FILE\n\n# \u68c0\u67e5\u5f02\u5e38\u8fde\u63a5\u6570\u91cf\nBLOCKED_COUNT=$(grep \"iptables-denied\" $LOG_FILE | wc -l)\nif [ \"$BLOCKED_COUNT\" -gt \"$THRESHOLD\" ]; then\n    ALERT_MSG=\"[WARNING] High volume of blocked connections: $BLOCKED_COUNT in last hour.\"\n    echo \"$ALERT_MSG\" &gt;&gt; $REPORT_FILE\n    logger -t firewall-monitor \"$ALERT_MSG\"\n    # echo \"$ALERT_MSG\" | mail -s \"Firewall Alert - $(hostname)\" $EMAIL\nfi\n\necho \"\" &gt;&gt; $REPORT_FILE\necho \"Report generated successfully.\" &gt;&gt; $REPORT_FILE\nEOF\n\nchmod +x /usr/local/bin/firewall-monitor.sh\n\n# \u5c06\u811a\u672c\u8bbe\u7f6e\u4e3a\u6bcf\u5c0f\u65f6\u8fd0\u884c\u4e00\u6b21\necho \"0 * * * * /usr/local/bin/firewall-monitor.sh\" | crontab -\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#4-ipset","title":"4. IPSET\u9ad8\u6548\u5c01\u7981","text":"<p><code>ipset</code> \u662f\u4e00\u4e2a\u6bd4 <code>iptables</code> \u66f4\u9ad8\u6548\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u7ba1\u7406\u5927\u91cf\u7684 IP \u5730\u5740\u6216\u7f51\u7edc\u96c6\u5408\u3002\u5bf9\u4e8e\u9700\u8981\u9891\u7e41\u6dfb\u52a0\u3001\u5220\u9664\u9ed1\u540d\u5355 IP \u7684\u573a\u666f\uff0c\u4f7f\u7528 <code>ipset</code> \u53ef\u4ee5\u663e\u8457\u63d0\u5347\u6027\u80fd\u3002</p>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#41-ipset","title":"4.1 IPSET\u57fa\u7840\u64cd\u4f5c","text":"Bash<pre><code># \u5b89\u88c5ipset\nyum install ipset -y      # CentOS/RHEL\napt install ipset -y      # Ubuntu/Debian\n\n# \u521b\u5efa\u4e00\u4e2a\u540d\u4e3a blacklist \u7684 hash:ip \u7c7b\u578b\u96c6\u5408\uff0c\u8d85\u65f6\u65f6\u95f4\u4e3a 1\u5c0f\u65f6 (3600\u79d2)\nipset create blacklist hash:ip timeout 3600\n\n# \u5c06\u4e00\u4e2aIP\u5730\u5740\u6dfb\u52a0\u5230\u96c6\u5408\u4e2d\nipset add blacklist 1.2.3.4\n\n# \u5c06\u4e00\u4e2a\u7f51\u7edc\u6dfb\u52a0\u5230\u96c6\u5408\u4e2d\nipset add blacklist 5.6.7.0/24\n\n# \u4ece\u96c6\u5408\u4e2d\u5220\u9664IP\nipset del blacklist 1.2.3.4\n\n# \u67e5\u770b\u96c6\u5408\u4e2d\u7684\u6240\u6709\u6210\u5458\nipset list blacklist\n\n# \u5c06iptables\u89c4\u5219\u4e0eipset\u96c6\u5408\u5173\u8054\n# \u5c06\u6240\u6709\u6e90IP\u5728 blacklist \u96c6\u5408\u4e2d\u7684\u6570\u636e\u5305\u90fd\u4e22\u5f03\niptables -A INPUT -m set --match-set blacklist src -j DROP\n\n# \u4fdd\u5b58ipset\u89c4\u5219\nipset save &gt; /etc/ipset.rules\n\n# \u6062\u590dipset\u89c4\u5219\nipset restore &lt; /etc/ipset.rules\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#42","title":"4.2 \u81ea\u52a8\u9ed1\u540d\u5355\u811a\u672c","text":"<p>\u8fd9\u4e2a\u811a\u672c\u5c06\u7ed3\u5408\u65e5\u5fd7\u5206\u6790\u548c <code>ipset</code>\uff0c\u81ea\u52a8\u5c06\u9891\u7e41\u8bbf\u95ee\u7684\u6076\u610f IP \u5730\u5740\u6dfb\u52a0\u5230\u9ed1\u540d\u5355\u3002</p> Bash<pre><code># \u521b\u5efa\u81ea\u52a8\u5c01\u7981\u811a\u672c\ncat &gt; /usr/local/bin/auto-blocker.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\nLOG_FILE=\"/var/log/firewall.log\"\n# \u9608\u503c\uff1a\u4e00\u4e2aIP\u5728\u77ed\u65f6\u95f4\u5185\u88ab\u62d2\u7edd\u7684\u8fde\u63a5\u6570\nBLOCK_THRESHOLD=50\n# \u5c01\u7981\u65f6\u95f4\uff08\u79d2\uff09\nBLOCK_TIME=3600\n\n# \u786e\u4fddipset\u96c6\u5408\u5b58\u5728\nif ! ipset list blacklist &gt;/dev/null 2&gt;&amp;1; then\n    ipset create blacklist hash:ip timeout $BLOCK_TIME\n    iptables -A INPUT -m set --match-set blacklist src -j DROP\nfi\n\n# \u68c0\u67e5\u65e5\u5fd7\uff0c\u5c06\u8fbe\u5230\u9608\u503c\u7684IP\u6dfb\u52a0\u5230ipset\u9ed1\u540d\u5355\ngrep \"iptables-denied\" $LOG_FILE | tail -n 1000 | awk '{\n    for (i=1;i&lt;=NF;i++) {\n        if ($i ~ /^SRC=/) {\n            split($i, a, \"=\");\n            print a[2]\n        }\n    }\n}' | sort | uniq -c | sort -nr | while read count ip; do\n    if [ \"$count\" -gt \"$BLOCK_THRESHOLD\" ]; then\n        if ! ipset test blacklist $ip &gt;/dev/null 2&gt;&amp;1; then\n            ipset add blacklist $ip timeout $BLOCK_TIME\n            TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')\n            echo \"[$TIMESTAMP] Auto-blocked suspicious IP: $ip (count: $count)\" &gt;&gt; /var/log/auto-blocker.log\n            logger -t auto-blocker \"Auto-blocked IP $ip\"\n        fi\n    fi\ndone\nEOF\n\nchmod +x /usr/local/bin/auto-blocker.sh\n\n# \u5c06\u811a\u672c\u8bbe\u7f6e\u4e3a\u6bcf15\u5206\u949f\u8fd0\u884c\u4e00\u6b21\necho \"*/15 * * * * /usr/local/bin/auto-blocker.sh\" | crontab -\n</code></pre> <p>\u6211\u660e\u767d\u4e86\u3002\u4f5c\u4e3a\u5bf9\u4e4b\u524d\u6587\u6863\u7684\u8865\u5145\uff0c\u6211\u5c06\u4e3a\u4f60\u6574\u7406\u4e00\u4efd\u5173\u4e8e UFW \u9632\u706b\u5899 \u7684\u8be6\u7ec6\u5185\u5bb9\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u7b2c\u4e94\u90e8\u5206\u6dfb\u52a0\u5230\u6587\u6863\u4e2d\uff0c\u4e0e <code>iptables</code> \u548c <code>firewalld</code> \u90e8\u5206\u5f62\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u9632\u706b\u5899\u7ba1\u7406\u6307\u5357\u3002</p>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#5-ufw","title":"5. UFW \u9632\u706b\u5899\u914d\u7f6e","text":"<p>UFW (Uncomplicated Firewall) \u662f Debian \u548c Ubuntu \u7cfb\u7edf\u9ed8\u8ba4\u4e14\u63a8\u8350\u7684\u9632\u706b\u5899\u7ba1\u7406\u5de5\u5177\u3002\u5b83\u65e8\u5728\u7b80\u5316\u590d\u6742\u7684 <code>iptables</code> \u89c4\u5219\u914d\u7f6e\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u76f4\u89c2\u6613\u7528\u7684\u547d\u4ee4\u884c\u63a5\u53e3\u3002</p>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#51-ufw","title":"5.1 UFW \u57fa\u7840\u64cd\u4f5c","text":"Bash<pre><code># \u5b89\u88c5 UFW (\u5982\u679c\u672a\u5b89\u88c5)\nsudo apt update\nsudo apt install ufw -y\n\n# \u542f\u7528 UFW (\u8bf7\u5728\u914d\u7f6e\u597d SSH \u89c4\u5219\u540e\u518d\u6267\u884c)\nsudo ufw enable\n\n# \u7981\u7528 UFW\nsudo ufw disable\n\n# \u67e5\u770b UFW \u72b6\u6001\u53ca\u89c4\u5219\nsudo ufw status verbose\nsudo ufw status numbered \u00a0# \u4ee5\u6570\u5b57\u5f62\u5f0f\u663e\u793a\u89c4\u5219\uff0c\u65b9\u4fbf\u5220\u9664\n\n# \u91cd\u7f6e\u6240\u6709\u89c4\u5219\u4e3a\u9ed8\u8ba4\u72b6\u6001\nsudo ufw reset\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#52","title":"5.2 \u9ed8\u8ba4\u7b56\u7565\u4e0e\u57fa\u672c\u89c4\u5219","text":"<p>\u4e3a\u4e86\u4fdd\u8bc1\u5b89\u5168\u6027\uff0c\u6700\u4f73\u5b9e\u8df5\u662f\u62d2\u7edd\u6240\u6709\u4f20\u5165\u8fde\u63a5\uff0c\u5e76\u5141\u8bb8\u6240\u6709\u4f20\u51fa\u8fde\u63a5\u3002</p> Bash<pre><code># \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565\uff1a\u62d2\u7edd\u6240\u6709\u4f20\u5165\uff0c\u5141\u8bb8\u6240\u6709\u4f20\u51fa\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\n\n# \u5141\u8bb8\u5e38\u7528\u7684\u670d\u52a1\u548c\u7aef\u53e3\n# \u5141\u8bb8 SSH \u8fde\u63a5 (\u8bf7\u6839\u636e\u4f60\u7684\u5b9e\u9645\u7aef\u53e3\u53f7\u8fdb\u884c\u4fee\u6539\uff0c\u4f8b\u5982 2222)\nsudo ufw allow 2222/tcp\n\n# \u5141\u8bb8 HTTP \u548c HTTPS\nsudo ufw allow http\nsudo ufw allow https\n# \u6216\u8005\u76f4\u63a5\u4f7f\u7528\u7aef\u53e3\u53f7\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\n\n# \u5141\u8bb8\u81ea\u5b9a\u4e49\u7aef\u53e3 (\u4f8b\u5982\u6570\u636e\u5e93\u7aef\u53e3 3306)\nsudo ufw allow 3306/tcp\n\n# \u5141\u8bb8\u7279\u5b9a IP \u5730\u5740\u6216\u7f51\u7edc\u8bbf\u95ee\n# \u5141\u8bb8\u6765\u81ea 192.168.1.100 \u7684\u6240\u6709\u8fde\u63a5\nsudo ufw allow from 192.168.1.100\n\n# \u5141\u8bb8\u6765\u81ea 192.168.1.0/24 \u7f51\u6bb5\u7684 SSH \u8fde\u63a5\nsudo ufw allow from 192.168.1.0/24 to any port 2222\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#53-ufw","title":"5.3 \u9ad8\u7ea7 UFW \u89c4\u5219","text":"<p>UFW \u4e5f\u652f\u6301\u66f4\u590d\u6742\u7684\u89c4\u5219\uff0c\u4f8b\u5982\u901f\u7387\u9650\u5236\uff0c\u53ef\u4ee5\u6709\u6548\u9632\u6b62\u66b4\u529b\u7834\u89e3\u653b\u51fb\u3002</p> Bash<pre><code># \u9650\u5236 SSH \u8fde\u63a5\u901f\u7387\uff0c\u9632\u6b62\u66b4\u529b\u7834\u89e3\n# \u5141\u8bb8\u6bcf 30 \u79d2\u5185\u6700\u591a 6 \u6b21\u65b0\u8fde\u63a5\u5c1d\u8bd5\nsudo ufw limit 2222/tcp\n\n# \u62d2\u7edd\u7279\u5b9a IP \u5730\u5740\u6216\u7f51\u7edc\n# \u62d2\u7edd\u6765\u81ea 1.2.3.4 \u7684\u6240\u6709\u8fde\u63a5\nsudo ufw deny from 1.2.3.4\n\n# \u62d2\u7edd\u6765\u81ea 172.16.0.0/12 \u7f51\u6bb5\u7684\u6240\u6709\u8fde\u63a5\nsudo ufw deny from 172.16.0.0/12\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"06-%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/%E9%98%B2%E7%81%AB%E5%A2%99%E9%98%B2%E6%8A%A4/#54-ufw","title":"5.4 \u811a\u672c\u5316 UFW \u914d\u7f6e","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u90e8\u7f72\uff0c\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u811a\u672c\u6765\u81ea\u52a8\u5316\u914d\u7f6e UFW\u3002</p> Bash<pre><code># \u521b\u5efa UFW \u914d\u7f6e\u811a\u672c\ncat &gt; /usr/local/bin/setup-ufw.sh &lt;&lt; 'EOF'\n#!/bin/bash\n\n# \u7981\u7528\u5e76\u91cd\u7f6e UFW\uff0c\u4ee5\u6e05\u9664\u65e7\u89c4\u5219\nsudo ufw disable\nsudo ufw reset -f\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565\uff1a\u62d2\u7edd\u6240\u6709\u4f20\u5165\uff0c\u5141\u8bb8\u6240\u6709\u4f20\u51fa\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\n\n# \u5b9a\u4e49\u81ea\u5b9a\u4e49 SSH \u7aef\u53e3\nSSH_PORT=2222\n\n# \u5141\u8bb8 SSH \u8fde\u63a5\necho \"Allowing SSH access on port $SSH_PORT...\"\nsudo ufw allow $SSH_PORT/tcp\n\n# \u5141\u8bb8 HTTP/HTTPS \u670d\u52a1\necho \"Allowing HTTP and HTTPS...\"\nsudo ufw allow http\nsudo ufw allow https\n\n# \u9650\u5236 SSH \u8fde\u63a5\u901f\u7387\u4ee5\u9632\u6b62\u66b4\u529b\u7834\u89e3\necho \"Applying rate limits for SSH...\"\nsudo ufw limit $SSH_PORT/tcp\n\n# \u5141\u8bb8\u672c\u5730\u56de\u73af\u63a5\u53e3 (lo)\necho \"Allowing loopback interface...\"\nsudo ufw allow in on lo\n\n# \u542f\u7528 UFW\necho \"Enabling UFW...\"\nsudo ufw enable\n\necho \"UFW configuration completed. Current status:\"\nsudo ufw status verbose\nEOF\n\nchmod +x /usr/local/bin/setup-ufw.sh\n\n# \u8fd0\u884c\u811a\u672c\nsudo /usr/local/bin/setup-ufw.sh\n</code></pre>","tags":["\u9632\u706b\u5899\u9632\u62a4","\u5b89\u5168\u9632\u62a4","\u8fd0\u7ef4","\u77e5\u8bc6\u5e93","\u7cfb\u7edf\u73af\u5883"]},{"location":"07-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/","title":"07-\u6545\u969c\u5904\u7406","text":""},{"location":"07-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/","title":"\u5e38\u89c1\u95ee\u9898","text":""},{"location":"07-%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/%E5%BA%94%E6%80%A5%E6%B5%81%E7%A8%8B/","title":"\u5e94\u6025\u6d41\u7a0b","text":""},{"location":"08-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/","title":"08-\u6700\u4f73\u5b9e\u8df5","text":""},{"location":"08-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/","title":"\u6027\u80fd\u4f18\u5316","text":""}]}